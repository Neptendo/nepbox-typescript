<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>BeepBox</title>
	<meta name="description" content="BeepBox is an online tool for sketching and sharing chiptune melodies." />
	<meta name="keywords" content="chiptune, music, melody, composition, tool, square wave, NES, NSF, BeepBox, beepbox" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="format-detection" content="telephone=no" />
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
	<style type="text/css">
		body {
			margin: auto;
			background: #000;
			font-family: 'Roboto', sans-serif;
			font-size: large;
			line-height: 1.3;
			color: #fff;
		}
		h1 {
			font-size: 30px;
			text-align: center;
		}
		.centerDiv {
			margin: 0px auto;
		}
		a {
			color: #98f;
		}
		#beepboxEditorContainer {
			min-height: 645px;
		}
		
		/* wide screen */
		@media (min-width: 701px) {
			body {
				width: 700px;
			}
			.column-container {
				display: flex;
				justify-content: space-between;
			}
			/* .instructions-column {
				width: 375px;
			}
			.twitter-column {
				width: 300px;
			} */
		}
		
		/* narrow screen */
		@media (max-width: 700px) {
			body {
				width: 100vw;
			}
			.column-container {
				display: flex;
				flex-direction: column;
				align-items: center;
			}
		}
	</style>
</head>

<body>
	<div id="beepboxEditorContainer" style="width: 700px; height: 645px;"></div>
	
	<h1>
		BeepBox Offline
	</h1>
	<p id="introduction">
		BeepBox is an online (and offline!) tool for sketching and sharing chiptune melodies. 
	</p>
	<p>
		All song data is packaged into the URL at the top of your browser. 
		When you make changes to the song, the URL is updated to reflect your changes. 
		When you are satisfied with your song, just copy and paste the URL to save and share your song! 
	</p>
	
	<div class="column-container">
		<div class="instructions-column">
			<h1>
				Instructions
			</h1>
			<p>
				You can add or remove notes by clicking on the gray rows at the top. 
				BeepBox automatically plays the notes out loud for you. Try it!
			</p>
			<p>
				Notes go into patterns, and you can edit one pattern at a time.
				Those numbered boxes at the bottom of the editor are the different patterns you can edit.
				<span id="bar-editing">
					Click the other boxes to move to a different part of the song, or click the arrows on the currently selected box to swap which pattern is played during that part of the song.
				</span>
			</p>
			<p>
				BeepBox can play several rows of patterns simultaneously, and each row has its own set of patterns. 
				Most rows can play melodies or harmonies, but the bottom row is for drums.
			</p>
			<p>
				The purple loop underneath the numbered boxes controls which part of the song is currently repeating. 
				Move the loop to listen to a different part of the song, or drag the ends to expand the loop to include the whole song. 
			</p>
			<div id="keyboard-instructions">
				<p>
					When BeepBox has focus (click on its interface above), you can use these keyboard shortcuts: <br/>
				</p>
				<ul>
					<li>Spacebar: Pause or Resume</li>
					<li>Z: Undo</li>
					<li>Y or Shift Z: Redo</li>
					<li>C: Copy the current pattern</li>
					<li>V: Paste the current pattern</li>
					<li>[ ]: Move the playhead backward and forward</li>
					<li>Arrow Keys: Change which bar is selected</li>
					<li>1-8: Reassign a pattern to the currently selected bar</li>
					<li>- +: Shift the notes in the pattern up or down</li>
				</ul>
			</div>
			<p>
				In the pattern editor, you can click and drag horizontally on a note to adjust its duration.
				You can also click above or below an existing note to enable a rapid arpeggio/trill effect, oscillating between two or more simultaneous notes. 
			</p>
			<p>
				ADVANCED: Drag vertically from an existing note to bend its pitch, or drag vertically from above or below the note to adjust its volume.
			</p>
			<p>
				BeepBox has many more features. 
				Try playing with the buttons and menus on the right side to find out what it can do!
			</p>
			<h1>
				About
			</h1>
			<p>
				BeepBox is developed by <a href="http://www.johnnesky.com">John Nesky</a>. 
			</p>
			<p>
				BeepBox does not claim ownership over songs created with it, so original songs belong to their authors. 
			</p>
			<p>
				Neither John Nesky nor BeepBox assume responsibility for any copyrighted material played on BeepBox. No songs are ever received, recorded, or distributed by BeepBox's servers. All song data is contained in the URL after the hash (#) mark, and BeepBox running inside your browser converts that data into sound waves.
			</p>
			<p>
				You can download and use <a href="https://bitbucket.org/shaktool/beepbox">the source code</a> under the MIT license.
			</p>
		</div>
	</div>

	<script type="text/javascript">

if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent) ) {
	document.getElementById("introduction").innerHTML = "BeepBox is an online tool for sketching and sharing chiptune melodies. Make sure that your volume is turned up, then press the play button!";
	document.getElementById("keyboard-instructions").style.display = "none";
	document.getElementById("bar-editing").innerHTML = "Tap the other boxes to move to a different part of the song, or tap on the currently selected box to swap which pattern is played during that part of the song.";
}

var beepbox=function(t){"use strict";function n(t,n){for(let e=0;e<t.length;e++)t[e]*=n}function e(t){if(!function(t){return!(!t||t&t-1)}(t))throw new Error("FFT array length must be a power of 2.");return Math.round(Math.log(t)/Math.log(2))}function i(t){const n=t.length,i=e(n);if(n<4)throw new Error("FFT array length must be at least 4.");for(let e=i-1;e>=2;e--){const i=1<<e,s=i>>1,h=i<<1,a=2*Math.PI/h,o=Math.cos(a),r=Math.sin(a),c=2*o;for(let e=0;e<n;e+=h){const n=e,h=n+s,a=n+i,l=a+s,f=a+i,p=t[n],d=t[a];t[n]=p+d,t[h]*=2,t[a]=p-d,t[l]*=2;let y=o,b=-r,m=1,u=0;for(let e=1;e<s;e++){const i=n+e,s=a-e,h=a+e,o=f-e,r=t[i],l=t[s],p=t[h],d=t[o],g=r-l,w=p+d;t[i]=r+l,t[s]=d-p,t[h]=g*y-w*b,t[o]=w*y+g*b;const x=c*y-m,v=c*b-u;m=y,u=b,y=x,b=v}}}for(let e=0;e<n;e+=4){const n=e+1,i=e+2,s=e+3,h=t[e],a=2*t[n],o=t[i],r=2*t[s],c=h+o,l=h-o;t[e]=c+a,t[n]=c-a,t[i]=l+r,t[s]=l-r}!function(t){const n=t.length,i=e(n);if(i>16)throw new Error("FFT array length must not be greater than 2^16.");const s=16-i;for(let e=0;e<n;e++){let n;if(n=(43690&e)>>1|(21845&e)<<1,n=(52428&n)>>2|(13107&n)<<2,n=(61680&n)>>4|(3855&n)<<4,n=(n>>8|(255&n)<<8)>>s,n>e){let i=t[e];t[e]=t[n],t[n]=i}}}(t)}
/*!
    Copyright (c) 2012-2022 John Nesky and contributing authors

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
    */class s{static t(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];const e=n/t.length;for(let n=0;n<t.length;n++)t[n]-=e;return new Float64Array(t)}static getDrumWave(t){let e=s.i[t];if(null==e)if(e=new Float32Array(32768),s.i[t]=e,0==t){let t=1;for(let n=0;n<32768;n++){e[n]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=16384),t=i}}else if(1==t)for(let t=0;t<32768;t++)e[t]=2*Math.random()-1;else if(2==t){let t=1;for(let n=0;n<32768;n++){e[n]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=32768),t=i}}else if(3==t){let t=1;for(let n=0;n<32767;n++){e[n]=2*(1&t)-1;let i=t>>2;1==(t+i&1)&&(i+=65536),t=i}}else if(4==t){let t=1;for(let n=0;n<32768;n++){e[n]=2*(1&t)-1;let i=t>>1;1==(t+i&1)&&(i+=40),t=i}}else if(5==t)s.drawNoiseSpectrum(e,10,11,1,1,0),s.drawNoiseSpectrum(e,11,14,-2,-2,0),i(e),n(e,1/Math.sqrt(e.length));else if(6==t)s.drawNoiseSpectrum(e,1,10,1,1,0),s.drawNoiseSpectrum(e,20,14,-2,-2,0),i(e),n(e,1/Math.sqrt(e.length));else if(7==t){let t=1;for(let n=0;n<32768;n++){e[n]=4*(1&t)*Math.random();let i=t>>1;1==(t+i&1)&&(i+=60),t=i}}else if(8==t){let t=1;for(let n=0;n<32768;n++){e[n]=(1&t)/2+.5;let i=t>>1;1==(t+i&1)&&(i-=40),t=i}}else{if(9!=t)throw new Error("Unrecognized drum index: "+t);for(let t=0;t<32768;t++)e[t]=2*Math.random()-1}return e}static drawNoiseSpectrum(t,n,e,i,s,h){const a=0|Math.pow(2,n),o=0|Math.pow(2,e),r=Math.log(2);for(let c=a;c<o;c++){let a=Math.pow(2,i+(s-i)*(Math.log(c)/r-n)/(e-n));a*=Math.pow(c/2048,h);const o=Math.random()*Math.PI*2;t[c]=Math.cos(o)*a,t[32768-c]=Math.sin(o)*a}}static generateSineWave(){const t=new Float64Array(s.sineWaveLength+1);for(let n=0;n<s.sineWaveLength+1;n++)t[n]=Math.sin(n*Math.PI*2/s.sineWaveLength);return t}}function h(t){const n={};for(let e=0;e<t.length;e++){const i=t[e];i.index=e,n[i.name]=i}const e=t;return e.dictionary=n,e}s.scaleNames=["easy :)","easy :(","island :)","island :(","blues :)","blues :(","normal :)","normal :(","dbl harmonic :)","dbl harmonic :(","enigma","expert","monotonic","no dabbing"],s.scaleFlags=[[!0,!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!1],[!0,!1,!1,!0,!1,!0,!1,!0,!1,!1,!0,!1],[!0,!1,!1,!1,!0,!0,!1,!0,!1,!1,!1,!0],[!0,!0,!1,!0,!1,!1,!1,!0,!0,!1,!1,!1],[!0,!1,!0,!0,!0,!1,!1,!0,!1,!0,!1,!1],[!0,!1,!1,!0,!1,!0,!0,!0,!1,!1,!0,!1],[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0],[!0,!1,!0,!0,!1,!0,!1,!0,!0,!1,!0,!1],[!0,!0,!1,!1,!0,!0,!1,!0,!0,!1,!1,!0],[!0,!1,!0,!0,!1,!1,!0,!0,!0,!1,!1,!0],[!0,!1,!0,!1,!0,!1,!0,!1,!0,!1,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!0,!0,!1,!0,!0,!0,!0,!0,!0,!1,!0,!1]],s.pianoScaleFlags=[!0,!1,!0,!1,!0,!0,!1,!0,!1,!0,!1,!0],s.blackKeyNameParents=[-1,1,-1,1,-1,1,-1,-1,1,-1,1,-1],s.pitchNames=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],s.keyNames=["B","A♯","A","G♯","G","F♯","F","E","D♯","D","C♯","C"],s.keyTransposes=[23,22,21,20,19,18,17,16,15,14,13,12],s.mixNames=["Type A (B & S)","Type B (M)","Type C"],s.sampleRateNames=["44100kHz","48000kHz","default","×4","×2","÷2","÷4","÷8","÷16"],s.tempoSteps=24,s.reverbRange=5,s.blendRange=4,s.riffRange=11,s.detuneRange=24,s.muffRange=24,s.beatsPerBarMin=1,s.beatsPerBarMax=24,s.barCountMin=1,s.barCountMax=256,s.patternsPerChannelMin=1,s.patternsPerChannelMax=64,s.instrumentsPerChannelMin=1,s.instrumentsPerChannelMax=64,s.partNames=["÷3 (triplets)","÷4 (standard)","÷6","÷8","÷16 (arpfest)","÷12","÷9","÷5","÷50","÷24"],s.partCounts=[3,4,6,8,16,12,9,5,50,24],s.waveNames=["triangle","square","pulse wide","pulse narrow","sawtooth","double saw","double pulse","spiky","plateau","glitch","10% pulse","sunsoft bass","loud pulse","sax","guitar","sine","atari bass","atari pulse","1% pulse","curved sawtooth","viola","brass","acoustic bass","lyre","ramp pulse","piccolo","squaretooth","flatline","pnryshk a (u5)","pnryshk b (riff)"],s.waveVolumes=[1,.5,.5,.5,.65,.5,.4,.4,.94,.5,.5,1,.6,.1,.25,1,1,1,1,1,1,1,1,.2,.2,.9,.9,1,.4,.5],s.drumNames=["retro","white","periodic","detuned periodic","shine","hollow","deep","cutter","metallic","snare"],s.drumVolumes=[.25,1,.4,.3,.3,1.5,1.5,.25,1,1],s.drumBasePitches=[69,69,69,69,69,96,120,96,96,69],s.drumPitchFilterMult=[100,8,100,100,100,1,100,100,100,100],s.drumWaveIsSoft=[!1,!0,!1,!1,!1,!0,!0,!1,!1,!1],s.i=[null,null,null,null,null,null,null,null,null,null],s.pwmwaveNames=["5%","10%","15%","20%","25%","30%","35%","40%","45%","50%"],s.pwmwaveVolumes=[1,1,1,1,1,1,1,1,1,1],s.filterNames=["none","sustain sharp","sustain medium","sustain soft","decay sharp","decay medium","decay soft","decay drawn","fade sharp","fade medium","fade soft","ring","muffled","submerged","shift","overtone","woosh","undertone"],s.filterBases=[0,2,3.5,5,1,2.5,4,1,5,7.5,10,-1,4,6,0,1,2,5],s.filterDecays=[0,0,0,0,10,7,4,.5,-10,-7,-4,.2,.2,.3,0,0,-6,0],s.filterVolumes=[.2,.4,.7,1,.5,.75,1,.5,.4,.7,1,.5,.75,.4,.4,1,.5,1.75],s.transitionNames=["seamless","sudden","smooth","slide","trill","click","bow","blip"],s.effectNames=["none","vibrato light","vibrato delayed","vibrato heavy","tremolo light","tremolo heavy","alien","stutter","strum"],s.effectVibratos=[0,.15,.3,.45,0,0,1,0,.05],s.effectTremolos=[0,0,0,0,.25,.5,0,1,.025],s.effectVibratoDelays=[0,0,3,0,0,0,0,0],s.chorusNames=["union","shimmer","hum","honky tonk","dissonant","fifths","octaves","spinner","detune","bowed","rising","vibrate","fourths","bass","dirty","stationary","harmonic (legacy)","recurve","voiced","fluctuate"],s.chorusIntervals=[0,.02,.05,.1,.25,3.5,6,.02,0,.02,1,3.5,4,0,0,3.5,0,.005,.25,12],s.chorusOffsets=[0,0,0,0,0,3.5,6,0,.25,0,.7,7,4,-7,.1,0,0,0,3,0],s.chorusVolumes=[.9,.9,1,1,.95,.95,.9,1,1,1,.95,.975,.95,1,.975,.9,1,1,.9,1],s.chorusSigns=[1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,-1,1,-1,1,1],s.chorusRiffApp=[0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1],s.chorusHarmonizes=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],s.harmDisplay=["arpeggio","duet","chord","seventh","half arpeggio","arp-chord"],s.harmNames=[0,1,2,3,4,5],s.fmChorusDisplay=["none","default","detune","honky tonk","consecutive","alt. major thirds","alt. minor thirds","fifths","octaves"],s.fmChorusNames=[0,1,2,3,4,5,6,7,8],s.imuteNames=["◉","◎"],s.imuteValues=[1,0],s.octoffNames=["none","+2 (2 octaves)","+1 1/2 (octave and fifth)","+1 (octave)","+1/2 (fifth)","-1/2 (fifth)","-1 (octave)","-1 1/2 (octave and fifth)","-2 (2 octaves"],s.octoffValues=[0,24,19,12,7,-7,-12,-19,-24],s.volumeNames=["loudest","loud","medium","quiet","quietest","mute","i","couldnt","be","bothered"],s.volumeValues=[0,.25,.5,.75,1,1.25,1.5,1.75,2,-1],s.volumeMValues=[0,.5,1,1.5,2,-1],s.ipanValues=[-1,-.75,-.5,-.25,0,.25,.5,.75,1],s.operatorCount=4,s.operatorAlgorithmNames=["1←(2 3 4)","1←(2 3←4)","1←2←(3 4)","1←(2 3)←4","1←2←3←4","1←3 2←4","1 2←(3 4)","1 2←3←4","(1 2)←3←4","(1 2)←(3 4)","1 2 3←4","(1 2 3)←4","1 2 3 4"],s.midiAlgorithmNames=["1<(2 3 4)","1<(2 3<4)","1<2<(3 4)","1<(2 3)<4","1<2<3<4","1<3 2<4","1 2<(3 4)","1 2<3<4","(1 2)<3<4","(1 2)<(3 4)","1 2 3<4","(1 2 3)<4","1 2 3 4"],s.operatorModulatedBy=[[[2,3,4],[],[],[]],[[2,3],[],[4],[]],[[2],[3,4],[],[]],[[2,3],[4],[4],[]],[[2],[3],[4],[]],[[3],[4],[],[]],[[],[3,4],[],[]],[[],[3],[4],[]],[[3],[3],[4],[]],[[3,4],[3,4],[],[]],[[],[],[4],[]],[[4],[4],[4],[]],[[],[],[],[]]],s.operatorAssociatedCarrier=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,2,1,2],[1,2,2,2],[1,2,2,2],[1,2,2,2],[1,2,2,2],[1,2,3,3],[1,2,3,3],[1,2,3,4]],s.operatorCarrierCounts=[1,1,1,1,1,2,2,2,2,2,3,3,4],s.operatorCarrierChorus=[[0,0,0,0],[0,.04,-.073,.091],[.5,.54,.427,.591],[0,.26,-.45,.67],[0,1,2,3],[0,4,7,11],[0,3,7,10],[0,7,14,21],[0,12,24,36]],s.operatorAmplitudeMax=15,s.operatorFrequencyNames=["1×","~1×","2×","~2×","3×","4×","5×","6×","7×","8×","9×","10×","11×","13×","16×","20×"],s.midiFrequencyNames=["1x","~1x","2x","~2x","3x","4x","5x","6x","7x","8x","9x","10x","11x","13x","16x","20x"],s.operatorFrequencies=[1,1,2,2,3,4,5,6,7,8,9,10,11,13,16,20],s.operatorHzOffsets=[0,1.5,0,-1.3,0,0,0,0,0,0,0,0,0,0,0,0],s.operatorAmplitudeSigns=[1,-1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1],s.operatorEnvelopeNames=["custom","steady","punch","flare 1","flare 2","flare 3","pluck 1","pluck 2","pluck 3","swell 1","swell 2","swell 3","tremolo1","tremolo2","tremolo3","custom flare","custom tremolo","flute 1","flute 2","flute 3"],s.operatorEnvelopeType=[0,1,2,3,3,3,4,4,4,4,4,4,5,5,5,3,5,6,6,6],s.operatorSpecialCustomVolume=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!1,!1,!1],s.operatorEnvelopeSpeed=[0,0,0,32,8,2,32,8,2,32,8,2,4,2,1,8,0,16,8,4],s.operatorEnvelopeInverted=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0,!0,!1,!1,!1,!1,!1,!1,!1,!1],s.operatorFeedbackNames=["1⟲","2⟲","3⟲","4⟲","1⟲ 2⟲","3⟲ 4⟲","1⟲ 2⟲ 3⟲ ","2⟲ 3⟲ 4⟲ ","1⟲ 2⟲ 3⟲ 4⟲ ","1→2","1→3","1→4","2→3","2→4","3→4","1→3 2→4","1→4 2→3","1→2→3→4","1🗘2","1🗘3","1🗘4","2🗘3","2🗘4","3🗘4"],s.midiFeedbackNames=["1","2","3","4","1 2","3 4","1 2 3","2 3 4","1 2 3 4","1>2","1>3","1>4","2>3","2>4","3>4","1>3 2>4","1>4 2>3","1>2>3>4","1-2","1-3","1-4","2-3","2-4","3-4"],s.operatorFeedbackIndices=[[[1],[],[],[]],[[],[2],[],[]],[[],[],[3],[]],[[],[],[],[4]],[[1],[2],[],[]],[[],[],[3],[4]],[[1],[2],[3],[]],[[],[2],[3],[4]],[[1],[2],[3],[4]],[[],[1],[],[]],[[],[],[1],[]],[[],[],[],[1]],[[],[],[2],[]],[[],[],[],[2]],[[],[],[],[3]],[[],[],[1],[2]],[[],[],[2],[1]],[[],[1],[2],[3]],[[2],[1],[],[]],[[3],[],[1],[]],[[4],[],[],[1]],[[],[3],[2],[]],[[],[4],[],[2]],[[],[],[4],[3]]],s.pitchChannelTypeNames=["chip","FM (expert)","PWM (beta)"],s.pitchChannelTypeValues=[0,1,3],s.drumChannelTypeNames=["noise"],s.instrumentTypeNames=["chip","FM","noise","PWM"],s.themeNames=["Default","ModBox 2.0","Artic","Cinnamon Roll [!]","Ocean","Rainbow [!]","Float [!]","Windows","Grassland","Dessert","Kahootiest","Beam to the Bit [!]","Pretty Egg","Poniryoshka","Gameboy [!]","Woodkid","Midnight","Snedbox","unnamed","Piano [!] [↻]","Halloween","FrozenOver❄️"],s.volumeColorPallet=["#777777","#c4ffa3","#42dcff","#ba8418","#090b3a","#ff00cb","#878787","#15a0db","#74bc21","#ff0000","#66bf39","#fefe00","#f01d7a","#ffc100","#8bac0f","#ef3027","#aa5599","#a53a3d","#ffffff","#ff0000","#9e2200","#ed2d2d"],s.sliderOneColorPallet=["#9900cc","#00ff00","#ffffff","#ba8418","#5982ff","#ff0000","#ffffff","#2779c2","#a0d168","#ff6254","#ff3355","#fefe00","#6b003a","#4b4b4b","#9bbc0f","#e83c4e","#445566","#a53a3d","#ffffff","#ffffff","#9e2200","#38ef17"],s.sliderOctaveColorPallet=["#444444","#00ff00","#a5eeff","#e59900","#4449a3","#43ff00","#ffffff","#295294","#74bc21","#ff5e3a","#eb670f","#0001fc","#ffb1f4","#5f4c99","#9bbc0f","#ef3027","#444444","#444444","#ffffff","#211616","#9e2200","#ffffff"],s.sliderOctaveNotchColorPallet=["#886644","#ffffff","#cefffd","#ffff25","#3dffdb","#0400ff","#c9c9c9","#fdd01d","#20330a","#fff570","#ff3355","#fa0103","#b4001b","#ff8291","#8bac0f","#ffedca","#aa5599","#a53a3d","#ffffff","#ff4c4c","#701800","#ed2d2d"],s.buttonColorPallet=["#ffffff","#00ff00","#42dcff","#ffff25","#4449a3","#f6ff00","#000000","#fdd01d","#69c400","#fffc5b","#66bf39","#fefe00","#75093e","#818383","#8bac0f","#ffedca","#000000","#ffffff","#ffffff","#ffffff","#9e2200","#38ef17"],s.noteOne=["#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#9e2200"],s.noteTwo=["#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#9e2200"],s.noteThree=["#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#9e2200"],s.noteFour=["#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#9e2200"],s.noteSix=["#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#9e2200"],s.noteSeven=["#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#9e2200"],s.noteEight=["#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#9e2200"],s.noteFive=["#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#9e2200"],s.noteNine=["#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#9e2200"],s.noteTen=["#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#9e2200"],s.noteEleven=["#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#9e2200"],s.noteTwelve=["#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#7a7a7a","#bfbfbf","#7a7a7a","#bfbfbf","#bfbfbf","#9e2200"],s.baseNoteColorPallet=["#886644","#c4ffa3","#eafffe","#f5bb00","#090b3a","#ffaaaa","#ffffff","#da4e2a","#20330a","#fffc5b","#45a3e5","#fefe00","#fffafa","#1a2844","#9bbc0f","#fff6fe","#222222","#886644","#ffffa0","#ffffff","#681701","#88bce8"],s.secondNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#ffceaa","#ededed","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#9bbc0f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#99c8ef"],s.thirdNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#ffdfaa","#cecece","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#9bbc0f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#abd3f4"],s.fourthNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#fff5aa","#bababa","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#8bac0f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#b8d7f2"],s.sixthNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#e8ffaa","#afafaf","#444444","#444444","#444444","#444444","#fa0103","#444444","#faf4c3","#8bac0f","#41323b","#222222","#10997e","#ffffa0","#ffffff","#754a3f","#cbe0f2"],s.seventhNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#bfffb2","#a5a5a5","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#8bac0f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#e5f0f9"],s.eigthNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#b2ffc8","#999999","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#306230","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#ffffff"],s.fifthNoteColorPallet=["#446688","#96fffb","#b7f1ff","#f5bb00","#3f669b","#b2ffe4","#8e8e8e","#5d9511","#74bc21","#ff5e3a","#864cbf","#111111","#ff91ce","#dabbe6","#306230","#fff6fe","#444444","#60389b","#ffffa0","#ffffff","#914300","#e5f0f9"],s.ninthNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#b2f3ff","#828282","#444444","#444444","#444444","#444444","#0001fc","#444444","#444444","#306230","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#cbe0f2"],s.tenNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#b2b3ff","#777777","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#0f380f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#b8d7f2"],s.elevenNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#e0b2ff","#565656","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#0f380f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#abd3f4"],s.twelveNoteColorPallet=["#444444","#444444","#444444","#f5bb00","#444444","#ffafe9","#282828","#444444","#444444","#444444","#444444","#111111","#444444","#444444","#0f380f","#41323b","#222222","#444444","#ffffa0","#ffffff","#754a3f","#99c8ef"],s.channelOneBrightColorPallet="#25f3ff",s.channelTwoBrightColorPallet="#44ff44",s.channelThreeBrightColorPallet="#ffff25",s.channelFourBrightColorPallet="#ff9752",s.channelFiveBrightColorPallet="#ff90ff",s.channelSixBrightColorPallet="#9f31ea",s.channelSevenBrightColorPallet="#2b6aff",s.channelEightBrightColorPallet="#00ff9f",s.channelNineBrightColorPallet="#ffbf00",s.channelTenBrightColorPallet="#d85d00",s.channelElevenBrightColorPallet="#ff00a1",s.channelTwelveBrightColorPallet="#c26afc",s.channelThirteenBrightColorPallet="#ff1616",s.channelFourteenBrightColorPallet="#ffffff",s.channelFifteenBrightColorPallet="#768dfc",s.channelSixteenBrightColorPallet="#a5ff00",s.channelOneDimColorPallet="#0099a1",s.channelTwoDimColorPallet="#439143",s.channelThreeDimColorPallet="#a1a100",s.channelFourDimColorPallet="#c75000",s.channelFiveDimColorPallet="#d020d0",s.channelSixDimColorPallet="#552377",s.channelSevenDimColorPallet="#221b89",s.channelEightDimColorPallet="#00995f",s.channelNineDimColorPallet="#d6b03e",s.channelTenDimColorPallet="#b25915",s.channelElevenDimColorPallet="#891a60",s.channelTwelveDimColorPallet="#965cbc",s.channelThirteenDimColorPallet="#991010",s.channelFourteenDimColorPallet="#aaaaaa",s.channelFifteenDimColorPallet="#5869BD",s.channelSixteenDimColorPallet="#7c9b42",s.pitchChannelColorsDim=[s.channelOneDimColorPallet,s.channelTwoDimColorPallet,s.channelThreeDimColorPallet,s.channelFourDimColorPallet,s.channelFiveDimColorPallet,s.channelSixDimColorPallet,s.channelSevenDimColorPallet,s.channelEightDimColorPallet,s.channelNineDimColorPallet,s.channelTenDimColorPallet,s.channelElevenDimColorPallet,s.channelTwelveDimColorPallet],s.pitchChannelColorsBright=[s.channelOneBrightColorPallet,s.channelTwoBrightColorPallet,s.channelThreeBrightColorPallet,s.channelFourBrightColorPallet,s.channelFiveBrightColorPallet,s.channelSixBrightColorPallet,s.channelSevenBrightColorPallet,s.channelEightBrightColorPallet,s.channelNineBrightColorPallet,s.channelTenBrightColorPallet,s.channelElevenBrightColorPallet,s.channelTwelveBrightColorPallet],s.pitchNoteColorsDim=[s.channelOneDimColorPallet,s.channelTwoDimColorPallet,s.channelThreeDimColorPallet,s.channelFourDimColorPallet,s.channelFiveDimColorPallet,s.channelSixDimColorPallet,s.channelSevenDimColorPallet,s.channelEightDimColorPallet,s.channelNineDimColorPallet,s.channelTenDimColorPallet,s.channelElevenDimColorPallet,s.channelTwelveDimColorPallet],s.pitchNoteColorsBright=[s.channelOneBrightColorPallet,s.channelTwoBrightColorPallet,s.channelThreeBrightColorPallet,s.channelFourBrightColorPallet,s.channelFiveBrightColorPallet,s.channelSixBrightColorPallet,s.channelSevenBrightColorPallet,s.channelEightBrightColorPallet,s.channelNineBrightColorPallet,s.channelTenBrightColorPallet,s.channelElevenBrightColorPallet,s.channelTwelveBrightColorPallet],s.drumChannelColorsDim=[s.channelThirteenDimColorPallet,s.channelFourteenDimColorPallet,s.channelFifteenDimColorPallet,s.channelSixteenDimColorPallet],s.drumChannelColorsBright=[s.channelThirteenBrightColorPallet,s.channelFourteenBrightColorPallet,s.channelFifteenBrightColorPallet,s.channelSixteenBrightColorPallet],s.drumNoteColorsDim=[s.channelThirteenDimColorPallet,s.channelFourteenDimColorPallet,s.channelFifteenDimColorPallet,s.channelSixteenDimColorPallet],s.drumNoteColorsBright=[s.channelThirteenBrightColorPallet,s.channelFourteenBrightColorPallet,s.channelFifteenBrightColorPallet,s.channelSixteenBrightColorPallet],s.midiPitchChannelNames=["cyan channel","yellow channel","orange channel","green channel","purple channel","blue channel"],s.midiDrumChannelNames=["gray channel","brown channel","indigo channel"],s.midiSustainInstruments=[71,80,70,68,81,81,81,81,74],s.midiDecayInstruments=[46,46,6,24,25,25,106,106,33],s.drumInterval=6,s.drumCount=12,s.pitchCount=37,s.maxPitch=84,s.pitchChannelCountMin=0,s.pitchChannelCountMax=12,s.drumChannelCountMin=0,s.drumChannelCountMax=4,s.waves=[s.t([1/15,.2,5/15,7/15,.6,11/15,13/15,1,1,13/15,11/15,.6,7/15,5/15,.2,1/15,-1/15,-.2,-5/15,-7/15,-.6,-11/15,-13/15,-1,-1,-13/15,-11/15,-.6,-7/15,-5/15,-.2,-1/15]),s.t([1,-1]),s.t([1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1]),s.t([1/31,3/31,5/31,7/31,9/31,11/31,13/31,15/31,17/31,19/31,21/31,23/31,25/31,27/31,29/31,1,-1,-29/31,-27/31,-25/31,-23/31,-21/31,-19/31,-17/31,-15/31,-13/31,-11/31,-9/31,-7/31,-5/31,-3/31,-1/31]),s.t([0,-.2,-.4,-.6,-.8,-1,1,-.8,-.6,-.4,-.2,1,.8,.6,.4,.2]),s.t([1,1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1]),s.t([1,-1,1,-1,1,0]),s.t([0,.2,.4,.5,.6,.7,.8,.85,.9,.95,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.95,.9,.85,.8,.7,.6,.5,.4,.2,0,-.2,-.4,-.5,-.6,-.7,-.8,-.85,-.9,-.95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-.95,-.9,-.85,-.8,-.7,-.6,-.5,-.4,-.2]),s.t([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([0,.1875,.3125,.5625,.5,.75,.875,1,1,.6875,.5,.625,.625,.5,.375,.5625,.4375,.5625,.4375,.4375,.3125,.1875,.1875,.375,.5625,.5625,.5625,.5625,.5625,.4375,.25,0]),s.t([1,.7,.1,.1,0,0,0,0,0,.1,.2,.15,.25,.125,.215,.345,4]),s.t([1/15,.2,5/15,9,.06]),s.t([-.5,3.5,3,-.5,-.25,-1]),s.t([0,.05,.125,.2,.25,.3,.425,.475,.525,.625,.675,.725,.775,.8,.825,.875,.9,.925,.95,.975,.98,.99,.995,1,.995,.99,.98,.975,.95,.925,.9,.875,.825,.8,.775,.725,.675,.625,.525,.475,.425,.3,.25,.2,.125,.05,0,-.05,-.125,-.2,-.25,-.3,-.425,-.475,-.525,-.625,-.675,-.725,-.775,-.8,-.825,-.875,-.9,-.925,-.95,-.975,-.98,-.99,-.995,-1,-.995,-.99,-.98,-.975,-.95,-.925,-.9,-.875,-.825,-.8,-.775,-.725,-.675,-.625,-.525,-.475,-.425,-.3,-.25,-.2,-.125,-.05]),s.t([1,1,1,1,0,1,0,1,1,0,0,1,0,0,0]),s.t([0,0,1,1,1,1,1,1,1,1,1,1,1,1,1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,.5,1/3,1/4]),s.t([-.9,-1,-.85,-.775,-.7,-.6,-.5,-.4,-.325,-.225,-.2,-.125,-.1,-.11,-.125,-.15,-.175,-.18,-.2,-.21,-.22,-.21,-.2,-.175,-.15,-.1,-.5,.75,.11,.175,.2,.25,.26,.275,.26,.25,.225,.2,.19,.18,.19,.2,.21,.22,.23,.24,.25,.26,.275,.28,.29,.3,.29,.28,.27,.26,.25,.225,.2,.175,.15,.1,.075,0,-.01,-.025,.025,.075,.2,.3,.475,.6,.75,.85,.85,1,.99,.95,.8,.675,.475,.275,.01,-.15,-.3,-.475,-.5,-.6,-.71,-.81,-.9,-1,-.9]),s.t([-1,-.95,-.975,-.9,-.85,-.8,-.775,-.65,-.6,-.5,-.475,-.35,-.275,-.2,-.125,-.05,0,.075,.125,.15,.2,.21,.225,.25,.225,.21,.2,.19,.175,.125,.1,.075,.06,.05,.04,.025,.04,.05,.1,.15,.225,.325,.425,.575,.7,.85,.95,1,.9,.675,.375,.2,.275,.4,.5,.55,.6,.625,.65,.65,.65,.65,.64,.6,.55,.5,.4,.325,.25,.15,.05,-.05,-.15,-.275,-.35,-.45,-.55,-.65,-.7,-.78,-.825,-.9,-.925,-.95,-.975]),s.t([1,0,.1,-.1,-.2,-.4,-.3,-1]),s.t([1,-1,4,2.15,4.13,5.15,0,-.05,1]),s.t([6.1,-2.9,1.4,-2.9]),s.t([1,4,2,1,-.1,-1,-.12]),s.t([.2,1,2.6,1,0,-2.4]),s.t([1,.9,.8,.7,.6,.5,.4,.3,.2,.1,0,.1,.2,.3,.4,.5,.6,.7,.8,.9]),s.t([1,.9,.8,.7,.6,.5,.4,.3,.2,.1,0]),s.t([1,-.9,.8,-.7,.6,-.5,.4,-.3,.2,-.1,0,-.1,.2,-.3,.4,-.5,.6,-.7,.8,-.9,1])],s.wavesMixC=[s.t([1/15,.2,5/15,7/15,.6,11/15,13/15,1,1,13/15,11/15,.6,7/15,5/15,.2,1/15,-1/15,-.2,-5/15,-7/15,-.6,-11/15,-13/15,-1,-1,-13/15,-11/15,-.6,-7/15,-5/15,-.2,-1/15]),s.t([1,-1]),s.t([1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1]),s.t([1/31,3/31,5/31,7/31,9/31,11/31,13/31,15/31,17/31,19/31,21/31,23/31,25/31,27/31,29/31,1,-1,-29/31,-27/31,-25/31,-23/31,-21/31,-19/31,-17/31,-15/31,-13/31,-11/31,-9/31,-7/31,-5/31,-3/31,-1/31]),s.t([0,-.2,-.4,-.6,-.8,-1,1,-.8,-.6,-.4,-.2,1,.8,.6,.4,.2]),s.t([1,1,1,1,1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1]),s.t([1,-1,1,-1,1,0]),s.t([0,.2,.4,.5,.6,.7,.8,.85,.9,.95,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,.95,.9,.85,.8,.7,.6,.5,.4,.2,0,-.2,-.4,-.5,-.6,-.7,-.8,-.85,-.9,-.95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-.95,-.9,-.85,-.8,-.7,-.6,-.5,-.4,-.2]),s.t([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([0,.1875,.3125,.5625,.5,.75,.875,1,1,.6875,.5,.625,.625,.5,.375,.5625,.4375,.5625,.4375,.4375,.3125,.1875,.1875,.375,.5625,.5625,.5625,.5625,.5625,.4375,.25,0]),s.t([1,.7,.1,.1,0,0,0,0,0,.1,.2,.15,.25,.125,.215,.345,4]),s.t([1/15,.2,5/15,9,.06]),s.t([-.5,3.5,3,-.5,-.25,-1]),s.t([0,.05,.125,.2,.25,.3,.425,.475,.525,.625,.675,.725,.775,.8,.825,.875,.9,.925,.95,.975,.98,.99,.995,1,.995,.99,.98,.975,.95,.925,.9,.875,.825,.8,.775,.725,.675,.625,.525,.475,.425,.3,.25,.2,.125,.05,0,-.05,-.125,-.2,-.25,-.3,-.425,-.475,-.525,-.625,-.675,-.725,-.775,-.8,-.825,-.875,-.9,-.925,-.95,-.975,-.98,-.99,-.995,-1,-.995,-.99,-.98,-.975,-.95,-.925,-.9,-.875,-.825,-.8,-.775,-.725,-.675,-.625,-.525,-.475,-.425,-.3,-.25,-.2,-.125,-.05]),s.t([1,1,1,1,0,1,0,1,1,0,0,1,0,0,0]),s.t([0,0,1,1,1,1,1,1,1,1,1,1,1,1,1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,.5,1/3,1/4]),s.t([-.9,-1,-.85,-.775,-.7,-.6,-.5,-.4,-.325,-.225,-.2,-.125,-.1,-.11,-.125,-.15,-.175,-.18,-.2,-.21,-.22,-.21,-.2,-.175,-.15,-.1,-.5,.75,.11,.175,.2,.25,.26,.275,.26,.25,.225,.2,.19,.18,.19,.2,.21,.22,.23,.24,.25,.26,.275,.28,.29,.3,.29,.28,.27,.26,.25,.225,.2,.175,.15,.1,.075,0,-.01,-.025,.025,.075,.2,.3,.475,.6,.75,.85,.85,1,.99,.95,.8,.675,.475,.275,.01,-.15,-.3,-.475,-.5,-.6,-.71,-.81,-.9,-1,-.9]),s.t([-1,-.95,-.975,-.9,-.85,-.8,-.775,-.65,-.6,-.5,-.475,-.35,-.275,-.2,-.125,-.05,0,.075,.125,.15,.2,.21,.225,.25,.225,.21,.2,.19,.175,.125,.1,.075,.06,.05,.04,.025,.04,.05,.1,.15,.225,.325,.425,.575,.7,.85,.95,1,.9,.675,.375,.2,.275,.4,.5,.55,.6,.625,.65,.65,.65,.65,.64,.6,.55,.5,.4,.325,.25,.15,.05,-.05,-.15,-.275,-.35,-.45,-.55,-.65,-.7,-.78,-.825,-.9,-.925,-.95,-.975]),s.t([.7,0,.1,-.1,-.2,-.4,-.3,-.7]),s.t([1,-1,4,2.15,4.1,5.05,0,-.05,1]),s.t([4.5,-1.7,1,-1.7]),s.t([.1,.4,.2,.1,-.1,-1,-.12]),s.t([.03,.13,.3,1,0,-.26]),s.t([2,1.75,1.5,1.25,1,.75,.5,.25,0,.25,.5,.75,1,1.25,1.5,1.75]),s.t([1,1.9,1.8,1.7,1.6,1.5,1.4,1.3,1.2,1.1,1]),s.t([-1,-.9,.8,-.7,.6,-.5,.4,-.3,.2,-.1,0,-.1,.2,-.3,.4,-.5,.6,-.7,.8,-.9,-1])],s.pwmwaves=[s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),s.t([1,1,1,1,1,-1,-1,-1,-1,-1])],s.sineWaveLength=256,s.sineWaveMask=s.sineWaveLength-1,s.sineWave=s.generateSineWave();var a=t&&t.h||function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},o=t&&t.o||function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var i,s,h=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(i=h.next()).done;)a.push(i.value)}catch(t){s={error:t}}finally{try{i&&!i.done&&(e=h.return)&&e.call(h)}finally{if(s)throw s.error}}return a},r=t&&t.l||function(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(o(arguments[n]));return t};function c(t,n){var e,i,s,h,o,l;try{for(var f=a(n),p=f.next();!p.done;p=f.next()){var d=p.value;if(d instanceof Node)t.appendChild(d);else if("string"==typeof d)t.appendChild(document.createTextNode(d));else if("function"==typeof d)c(t,[d()]);else if(Array.isArray(d))c(t,d);else if(d&&"undefined"!=typeof Symbol&&"function"==typeof d[Symbol.iterator])c(t,r(d));else if(d&&d.constructor===Object&&t instanceof Element)try{for(var y=(s=void 0,a(Object.keys(d))),b=y.next();!b.done;b=y.next()){var m=b.value,u=d[m];if("class"===m)"string"==typeof u?t.setAttribute("class",u):Array.isArray(d)||u&&"undefined"!=typeof Symbol&&"function"==typeof u[Symbol.iterator]?t.setAttribute("class",r(u).join(" ")):console.warn("Invalid "+m+' value "'+u+'" on '+t.tagName+" element.");else if("style"===m)if(u&&u.constructor===Object)try{for(var g=(o=void 0,a(Object.keys(u))),w=g.next();!w.done;w=g.next()){var x=w.value;x in t.style?t.style[x]=u[x]:t.style.setProperty(x,u[x])}}catch(t){o={error:t}}finally{try{w&&!w.done&&(l=g.return)&&l.call(g)}finally{if(o)throw o.error}}else t.setAttribute(m,u);else"function"==typeof u?t[m]=u:"boolean"==typeof u?u?t.setAttribute(m,""):t.removeAttribute(m):t.setAttribute(m,u)}}catch(t){s={error:t}}finally{try{b&&!b.done&&(h=y.return)&&h.call(y)}finally{if(s)throw s.error}}else t.appendChild(document.createTextNode(d))}}catch(t){e={error:t}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(e)throw e.error}}return t}var l="http://www.w3.org/2000/svg";var f,p,d,y,b=t&&t.h||function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},m=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return document.createRange().createContextualFragment(t.join())},u=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=document.createDocumentFragment(),i=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">'+t.join()+"</svg>","image/svg+xml").documentElement;null!==i.firstChild;)document.importNode(i.firstChild,!0),e.appendChild(i.firstChild);return e},g=function(t){m[t]=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return c(document.createElement(t),n)}};try{for(var w=b("a abbr address area article aside audio b base bdi bdo blockquote br button canvas caption cite code col colgroup datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hr i iframe img input ins kbd label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" ")),x=w.next();!x.done;x=w.next()){g(x.value)}}catch(Re){f={error:Re}}finally{try{x&&!x.done&&(p=w.return)&&p.call(w)}finally{if(f)throw f.error}}var v=function(t){if(u[t]=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return c(document.createElementNS(l,t),n)},/-/.test(t)){var n=t.replace(/-/g,"_");u[n]=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return c(document.createElementNS(l,t),n)}}};try{for(var k=b("a altGlyph altGlyphDef altGlyphItem animate animateMotion animateTransform circle clipPath color-profile cursor defs desc discard ellipse feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence filter font font-face font-face-format font-face-name font-face-src font-face-uri foreignObject g glyph glyphRef hkern image line linearGradient marker mask metadata missing-glyph mpath path pattern polygon polyline radialGradient rect script set stop style svg switch symbol text textPath title tref tspan use view vkern".split(" ")),M=k.next();!M.done;M=k.next()){v(M.value)}}catch(Ee){d={error:Ee}}finally{try{M&&!M.done&&(y=k.return)&&y.call(k)}finally{if(d)throw d.error}}class L{constructor(t,n,e,i){this.m=[],this.u=0;for(let s=e;s<i;s++){const e=t[n.charCodeAt(s)];this.m.push(e>>5&1),this.m.push(e>>4&1),this.m.push(e>>3&1),this.m.push(e>>2&1),this.m.push(e>>1&1),this.m.push(1&e)}}read(t){let n=0;for(;t>0;)n<<=1,n+=this.m[this.u++],t--;return n}readLongTail(t,n){let e=t,i=n;for(;this.m[this.u++];)e+=1<<i,i++;for(;i>0;)i--,this.m[this.u++]&&(e+=1<<i);return e}readPartDuration(){return this.readLongTail(1,2)}readPinCount(){return this.readLongTail(1,0)}readPitchInterval(){return this.read(1)?-this.readLongTail(1,3):this.readLongTail(1,3)}}class C{constructor(){this.m=[]}write(t,n){for(t--;t>=0;)this.m.push(n>>>t&1),t--}writeLongTail(t,n,e){if(e<t)throw new Error("value out of bounds");e-=t;let i=n;for(;e>=1<<i;)this.m.push(1),e-=1<<i,i++;for(this.m.push(0);i>0;)i--,this.m.push(e>>>i&1)}writePartDuration(t){this.writeLongTail(1,2,t)}writePinCount(t){this.writeLongTail(1,0,t)}writePitchInterval(t){t<0?(this.write(1,1),this.writeLongTail(1,3,-t)):(this.write(1,0),this.writeLongTail(1,3,t))}concat(t){this.m=this.m.concat(t.m)}encodeBase64(t,n){for(let e=0;e<this.m.length;e+=6){const i=this.m[e]<<5|this.m[e+1]<<4|this.m[e+2]<<3|this.m[e+3]<<2|this.m[e+4]<<1|this.m[e+5];n.push(t[i])}return n}lengthBase64(){return Math.ceil(this.m.length/6)}}function A(t,n,e){return{interval:t,time:n,volume:e}}function S(t,n,e,i,s=!1){return{pitches:[t],pins:[A(0,0,i),A(0,e-n,s?0:i)],start:n,end:e}}class B{constructor(){this.notes=[],this.instrument=0}cloneNotes(){const t=[];for(const n of this.notes){const e=S(-1,n.start,n.end,3);e.pitches=n.pitches.concat(),e.pins=[];for(const t of n.pins)e.pins.push(A(t.interval,t.time,t.volume));t.push(e)}return t}reset(){this.notes.length=0,this.instrument=0}}class R{constructor(t){this.frequency=0,this.amplitude=0,this.envelope=0,this.reset(t)}reset(t){this.frequency=0,this.amplitude=t<=1?s.operatorAmplitudeMax:0,this.envelope=1}copy(t){this.frequency=t.frequency,this.amplitude=t.amplitude,this.envelope=t.envelope}}class E{constructor(){this.type=0,this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.fmChorus=1,this.imute=0,this.octoff=0,this.chorus=0,this.volume=0,this.ipan=4,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1,this.operators=[];for(let t=0;t<s.operatorCount;t++)this.operators.push(new R(t))}reset(){this.type=0,this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.fmChorus=1,this.imute=0,this.ipan=4,this.octoff=0,this.chorus=0,this.volume=0,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1;for(let t=0;t<this.operators.length;t++)this.operators[t].reset(t)}setTypeAndReset(t){switch(this.type=t,t){case 0:case 3:this.wave=1,this.filter=1,this.transition=1,this.effect=0,this.harm=0,this.imute=0,this.ipan=4,this.octoff=0,this.chorus=0,this.volume=0;break;case 1:this.wave=1,this.transition=1,this.volume=0,this.imute=0,this.ipan=4,this.harm=0,this.octoff=0;break;case 2:this.transition=1,this.octoff=0,this.fmChorus=1,this.ipan=4,this.effect=0,this.algorithm=0,this.feedbackType=0,this.feedbackAmplitude=0,this.feedbackEnvelope=1,this.volume=0;for(let t=0;t<this.operators.length;t++)this.operators[t].reset(t)}}copy(t){this.type=t.type,this.wave=t.wave,this.filter=t.filter,this.transition=t.transition,this.effect=t.effect,this.chorus=t.chorus,this.volume=t.volume,this.harm=t.harm,this.fmChorus=t.fmChorus,this.imute=t.imute,this.ipan=t.ipan,this.octoff=t.octoff,this.algorithm=t.algorithm,this.feedbackType=t.feedbackType,this.feedbackAmplitude=t.feedbackAmplitude,this.feedbackEnvelope=t.feedbackEnvelope;for(let n=0;n<this.operators.length;n++)this.operators[n].copy(t.operators[n])}}class F{constructor(){this.octave=0,this.instruments=[],this.patterns=[],this.bars=[]}}class P{constructor(t){this.channels=[],this.v=[],null!=t?this.fromBase64String(t):this.initToDefault(!0)}getChannelCount(){return this.pitchChannelCount+this.drumChannelCount}getChannelUnusedCount(){return s.pitchChannelCountMax+s.drumChannelCountMax-(this.pitchChannelCount+this.drumChannelCount)}getThemeName(){return s.themeNames[this.theme]}getTimeSig(){return this.beatsPerBar+"/"+this.partsPerBeat+" with "+this.barCount+" bars."}getScaleNKey(){return' "'+s.scaleNames[this.scale]+'" and your key is '+s.keyNames[this.key]}getChannelIsDrum(t){return t>=this.pitchChannelCount}getChannelColorDim(t){return t<this.pitchChannelCount?s.pitchChannelColorsDim[t]:s.drumChannelColorsDim[t-this.pitchChannelCount]}getChannelColorBright(t){return t<this.pitchChannelCount?s.pitchChannelColorsBright[t]:s.drumChannelColorsBright[t-this.pitchChannelCount]}getNoteColorDim(t){return t<this.pitchChannelCount?s.pitchNoteColorsDim[t]:s.drumNoteColorsDim[t-this.pitchChannelCount]}getNoteColorBright(t){return t<this.pitchChannelCount?s.pitchNoteColorsBright[t]:s.drumNoteColorsBright[t-this.pitchChannelCount]}initToDefault(t=!0){if(this.scale=0,this.theme=0,this.key=s.keyNames.length-1,this.mix=1,this.sampleRate=2,this.loopStart=0,this.loopLength=4,this.tempo=7,this.reverb=0,this.blend=0,this.riff=0,this.detune=0,this.muff=0,this.beatsPerBar=8,this.barCount=16,this.patternsPerChannel=8,this.partsPerBeat=4,this.instrumentsPerChannel=1,t){this.pitchChannelCount=4,this.drumChannelCount=1;for(let t=0;t<this.getChannelCount();t++){this.channels.length<=t&&(this.channels[t]=new F);const n=this.channels[t];n.octave=4-t;for(let t=0;t<this.patternsPerChannel;t++)n.patterns.length<=t?n.patterns[t]=new B:n.patterns[t].reset();n.patterns.length=this.patternsPerChannel;for(let t=0;t<this.instrumentsPerChannel;t++)n.instruments.length<=t?n.instruments[t]=new E:n.instruments[t].reset();n.instruments.length=this.instrumentsPerChannel;for(let t=0;t<this.barCount;t++)n.bars[t]=t<4?1:0;n.bars.length=this.barCount}this.channels.length=this.getChannelCount()}}toBase64String(){let t,n=[];const e=P.k;n.push(e[P.M]),n.push(110,e[this.pitchChannelCount],e[this.drumChannelCount]),n.push(122,e[this.theme]),n.push(115,e[this.scale]),n.push(117,e[this.mix]),n.push(124,e[this.sampleRate]),n.push(107,e[this.key]),n.push(108,e[this.loopStart>>6],e[63&this.loopStart]),n.push(101,e[this.loopLength-1>>6],e[this.loopLength-1&63]),n.push(116,e[this.tempo]),n.push(109,e[this.reverb]),n.push(120,e[this.blend]),n.push(121,e[this.riff]),n.push(72,e[this.detune]),n.push(36,e[this.muff]),n.push(97,e[this.beatsPerBar-1]),n.push(103,e[this.barCount-1>>6],e[this.barCount-1&63]),n.push(106,e[this.patternsPerChannel-1]),n.push(105,e[this.instrumentsPerChannel-1]),n.push(114,e[s.partCounts.indexOf(this.partsPerBeat)]),n.push(111);for(let t=0;t<this.getChannelCount();t++)n.push(e[this.channels[t].octave]);for(let t=0;t<this.getChannelCount();t++)for(let i=0;i<this.instrumentsPerChannel;i++){const h=this.channels[t].instruments[i];if(t<this.pitchChannelCount)if(n.push(84,e[h.type]),0==h.type)n.push(119,e[h.wave]),n.push(102,e[h.filter]),n.push(100,e[h.transition]),n.push(99,e[h.effect]),n.push(113,e[h.harm]),n.push(71,e[h.imute]),n.push(76,e[h.ipan]),n.push(66,e[h.octoff]),n.push(104,e[h.chorus]),n.push(118,e[h.volume]);else if(1==h.type){n.push(100,e[h.transition]),n.push(99,e[h.effect]),n.push(66,e[h.octoff]),n.push(35,e[h.fmChorus]),n.push(71,e[h.imute]),n.push(76,e[h.ipan]),n.push(65,e[h.algorithm]),n.push(70,e[h.feedbackType]),n.push(95,e[h.feedbackAmplitude]),n.push(86,e[h.feedbackEnvelope]),n.push(118,e[h.volume]),n.push(81);for(let t=0;t<s.operatorCount;t++)n.push(e[h.operators[t].frequency]);n.push(80);for(let t=0;t<s.operatorCount;t++)n.push(e[h.operators[t].amplitude]);n.push(69);for(let t=0;t<s.operatorCount;t++)n.push(e[h.operators[t].envelope])}else{if(3!=h.type)throw new Error("Unknown instrument type.");n.push(119,e[h.wave]),n.push(102,e[h.filter]),n.push(100,e[h.transition]),n.push(99,e[h.effect]),n.push(113,e[h.harm]),n.push(71,e[h.imute]),n.push(76,e[h.ipan]),n.push(66,e[h.octoff]),n.push(104,e[h.chorus]),n.push(118,e[h.volume])}else n.push(84,e[2]),n.push(119,e[h.wave]),n.push(100,e[h.transition]),n.push(118,e[h.volume]),n.push(71,e[h.imute]),n.push(113,e[h.harm]),n.push(66,e[h.octoff]),n.push(76,e[h.ipan])}n.push(98),t=new C;let i=0;for(;1<<i<this.patternsPerChannel+1;)i++;for(let n=0;n<this.getChannelCount();n++)for(let e=0;e<this.barCount;e++)t.write(i,this.channels[n].bars[e]);t.encodeBase64(e,n),n.push(112),t=new C;let h=0;for(;1<<h<this.instrumentsPerChannel;)h++;for(let n=0;n<this.getChannelCount();n++){const i=this.getChannelIsDrum(n),s=i?0:12*this.channels[n].octave;let a=(i?4:12)+s;const o=i?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],r=[];for(let t=0;t<o.length;t++)o[t]+=s;for(const i of this.channels[n].patterns)if(t.write(h,i.instrument),i.notes.length>0){t.write(1,1);let n=0;for(const s of i.notes){s.start>n&&(t.write(2,0),t.writePartDuration(s.start-n));const i=new C;for(let t=1;t<s.pitches.length;t++)i.write(1,1);s.pitches.length<4&&i.write(1,0),i.writePinCount(s.pins.length-1),i.write(2,s.pins[0].volume);let h=0,c=s.pitches[0],l=c;const f=[];for(let t=1;t<s.pins.length;t++){const n=s.pins[t],e=c+n.interval;l!=e?(i.write(1,1),f.push(e),l=e):i.write(1,0),i.writePartDuration(n.time-h),h=n.time,i.write(2,n.volume)}const p=String.fromCharCode.apply(null,i.encodeBase64(e,[])),d=r.indexOf(p);-1==d?(t.write(2,1),t.concat(i)):(t.write(1,1),t.writeLongTail(0,0,d),r.splice(d,1)),r.unshift(p),r.length>10&&r.pop();const y=s.pitches.concat(f);for(let n=0;n<y.length;n++){const e=y[n],i=o.indexOf(e);if(-1==i){let n=0,i=a;if(i<e)for(;i!=e;)i++,-1==o.indexOf(i)&&n++;else for(;i!=e;)i--,-1==o.indexOf(i)&&n--;t.write(1,0),t.writePitchInterval(n)}else t.write(1,1),t.write(3,i),o.splice(i,1);o.unshift(e),o.length>8&&o.pop(),a=n==s.pitches.length-1?s.pitches[0]:e}n=s.end}n<this.beatsPerBar*this.partsPerBeat&&(t.write(2,0),t.writePartDuration(this.beatsPerBar*this.partsPerBeat-n))}else t.write(1,0)}let a=t.lengthBase64(),o=[];for(;a>0;)o.unshift(e[63&a]),a>>=6;if(n.push(e[o.length]),Array.prototype.push.apply(n,o),t.encodeBase64(e,n),n.length>=65535)throw new Error("Song hash code too long.");return String.fromCharCode.apply(null,n)}fromBase64String(t){if(null==t||""==t)return void this.initToDefault(!0);let n=0;for(;t.charCodeAt(n)<=32;)n++;if(35==t.charCodeAt(n)&&n++,123==t.charCodeAt(n))return void this.fromJsonObject(JSON.parse(0==n?t:t.substring(n)));const e=P.L[t.charCodeAt(n++)];if(-1==e||e>P.M||e<P.S)return;const i=e<3,h=e<4,a=e<5,o=e<6,r=P.L;if(this.initToDefault(o),i){for(const t of this.channels)t.instruments[0].transition=0;this.channels[3].instruments[0].wave=0}let c=0,l=-1;for(;n<t.length;){const e=t.charCodeAt(n++);let f;if(110==e){this.pitchChannelCount=r[t.charCodeAt(n++)],this.drumChannelCount=r[t.charCodeAt(n++)],this.pitchChannelCount=P.R(s.pitchChannelCountMin,s.pitchChannelCountMax+1,this.pitchChannelCount),this.drumChannelCount=P.R(s.drumChannelCountMin,s.drumChannelCountMax+1,this.drumChannelCount);for(let t=this.channels.length;t<this.getChannelCount();t++)this.channels[t]=new F;this.channels.length=this.getChannelCount()}else if(115==e)this.scale=r[t.charCodeAt(n++)],i&&10==this.scale&&(this.scale=11);else if(117==e)this.mix=r[t.charCodeAt(n++)];else if(107==e)this.key=r[t.charCodeAt(n++)];else if(122==e)this.theme=r[t.charCodeAt(n++)];else if(108==e)this.loopStart=a?r[t.charCodeAt(n++)]:(r[t.charCodeAt(n++)]<<6)+r[t.charCodeAt(n++)];else if(101==e)this.loopLength=a?r[t.charCodeAt(n++)]:(r[t.charCodeAt(n++)]<<6)+r[t.charCodeAt(n++)]+1;else if(116==e)this.tempo=h?[1,4,7,10][r[t.charCodeAt(n++)]]:r[t.charCodeAt(n++)],this.tempo=P.R(0,s.tempoSteps,this.tempo);else if(109==e)this.reverb=r[t.charCodeAt(n++)],this.reverb=P.R(0,s.reverbRange,this.reverb);else if(120==e)this.blend=P.R(0,s.blendRange,r[t.charCodeAt(n++)]);else if(121==e)this.riff=P.R(0,s.riffRange,r[t.charCodeAt(n++)]);else if(124==e)this.sampleRate=r[t.charCodeAt(n++)];else if(72==e)this.detune=P.R(0,s.detuneRange,r[t.charCodeAt(n++)]);else if(36==e)this.muff=P.R(0,s.muffRange,r[t.charCodeAt(n++)]);else if(97==e)this.beatsPerBar=i?[6,7,8,9,10][r[t.charCodeAt(n++)]]:r[t.charCodeAt(n++)]+1,this.beatsPerBar=Math.max(s.beatsPerBarMin,Math.min(s.beatsPerBarMax,this.beatsPerBar));else if(103==e){this.barCount=(r[t.charCodeAt(n++)]<<6)+r[t.charCodeAt(n++)]+1,this.barCount=Math.max(s.barCountMin,Math.min(s.barCountMax,this.barCount));for(let t=0;t<this.getChannelCount();t++){for(let n=this.channels[t].bars.length;n<this.barCount;n++)this.channels[t].bars[n]=1;this.channels[t].bars.length=this.barCount}}else if(106==e){this.patternsPerChannel=r[t.charCodeAt(n++)]+1,this.patternsPerChannel=Math.max(1,Math.min(s.barCountMax,this.patternsPerChannel));for(let t=0;t<this.getChannelCount();t++){for(let n=this.channels[t].patterns.length;n<this.patternsPerChannel;n++)this.channels[t].patterns[n]=new B;this.channels[t].patterns.length=this.patternsPerChannel}}else if(105==e){this.instrumentsPerChannel=r[t.charCodeAt(n++)]+1,this.instrumentsPerChannel=Math.max(s.instrumentsPerChannelMin,Math.min(s.instrumentsPerChannelMax,this.instrumentsPerChannel));for(let t=0;t<this.getChannelCount();t++){for(let n=this.channels[t].instruments.length;n<this.instrumentsPerChannel;n++)this.channels[t].instruments[n]=new E;this.channels[t].instruments.length=this.instrumentsPerChannel}}else if(114==e)this.partsPerBeat=s.partCounts[r[t.charCodeAt(n++)]];else if(111==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].octave=P.R(0,5,r[t.charCodeAt(n++)]);else for(f=0;f<this.getChannelCount();f++)this.channels[f].octave=P.R(0,5,r[t.charCodeAt(n++)]);else if(84==e){l++,l>=this.instrumentsPerChannel&&(c++,l=0);const e=c<this.pitchChannelCount,i=this.channels[c].instruments[l];let s=P.R(0,4,r[t.charCodeAt(n++)]);2==s&&e&&(s=3),i.setTypeAndReset(s)}else if(119==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].instruments[0].wave=P.R(0,s.waveNames.length,r[t.charCodeAt(n++)]);else if(o)for(f=0;f<this.getChannelCount();f++){const e=f>=this.pitchChannelCount;for(let i=0;i<this.instrumentsPerChannel;i++)this.channels[f].instruments[i].wave=P.R(0,e?s.drumNames.length:s.waveNames.length,r[t.charCodeAt(n++)])}else{const e=c>=this.pitchChannelCount;this.channels[c].instruments[l].wave=P.R(0,e?s.drumNames.length:s.waveNames.length,r[t.charCodeAt(n++)])}else if(102==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].instruments[0].filter=[1,3,4,5][P.R(0,s.filterNames.length,r[t.charCodeAt(n++)])];else if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].filter=P.R(0,s.filterNames.length,r[t.charCodeAt(n++)]+1);else this.channels[c].instruments[l].filter=P.R(0,s.filterNames.length,r[t.charCodeAt(n++)]);else if(100==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].instruments[0].transition=P.R(0,s.transitionNames.length,r[t.charCodeAt(n++)]);else if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].transition=P.R(0,s.transitionNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].transition=P.R(0,s.transitionNames.length,r[t.charCodeAt(n++)]);else if(99==e)if(i){f=r[t.charCodeAt(n++)];let e=P.R(0,s.effectNames.length,r[t.charCodeAt(n++)]);1==e?e=3:3==e&&(e=5),this.channels[f].instruments[0].effect=e}else if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].effect=P.R(0,s.effectNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].effect=P.R(0,s.effectNames.length,r[t.charCodeAt(n++)]);else if(104==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].instruments[0].chorus=P.R(0,s.chorusNames.length,r[t.charCodeAt(n++)]);else if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].chorus=P.R(0,s.chorusNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].chorus=P.R(0,s.chorusNames.length,r[t.charCodeAt(n++)]);else if(113==e)if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].harm=P.R(0,s.harmNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].harm=P.R(0,s.harmNames.length,r[t.charCodeAt(n++)]);else if(35==e)this.channels[c].instruments[l].fmChorus=P.R(0,s.fmChorusNames.length,r[t.charCodeAt(n++)]);else if(71==e)this.channels[c].instruments[l].imute=P.R(0,s.imuteNames.length,r[t.charCodeAt(n++)]);else if(76==e)this.channels[c].instruments[l].ipan=P.R(0,s.ipanValues.length,r[t.charCodeAt(n++)]);else if(66==e)if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].octoff=P.R(0,s.octoffNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].octoff=P.R(0,s.octoffNames.length,r[t.charCodeAt(n++)]);else if(118==e)if(i)f=r[t.charCodeAt(n++)],this.channels[f].instruments[0].volume=P.R(0,s.volumeNames.length,r[t.charCodeAt(n++)]);else if(o)for(f=0;f<this.getChannelCount();f++)for(let e=0;e<this.instrumentsPerChannel;e++)this.channels[f].instruments[e].volume=P.R(0,s.volumeNames.length,r[t.charCodeAt(n++)]);else this.channels[c].instruments[l].volume=P.R(0,s.volumeNames.length,r[t.charCodeAt(n++)]);else if(65==e)this.channels[c].instruments[l].algorithm=P.R(0,s.operatorAlgorithmNames.length,r[t.charCodeAt(n++)]);else if(70==e)this.channels[c].instruments[l].feedbackType=P.R(0,s.operatorFeedbackNames.length,r[t.charCodeAt(n++)]);else if(95==e)this.channels[c].instruments[l].feedbackAmplitude=P.R(0,s.operatorAmplitudeMax+1,r[t.charCodeAt(n++)]);else if(86==e)this.channels[c].instruments[l].feedbackEnvelope=P.R(0,s.operatorEnvelopeNames.length,r[t.charCodeAt(n++)]);else if(81==e)for(let e=0;e<s.operatorCount;e++)this.channels[c].instruments[l].operators[e].frequency=P.R(0,s.operatorFrequencyNames.length,r[t.charCodeAt(n++)]);else if(80==e)for(let e=0;e<s.operatorCount;e++)this.channels[c].instruments[l].operators[e].amplitude=P.R(0,s.operatorAmplitudeMax+1,r[t.charCodeAt(n++)]);else if(69==e)for(let e=0;e<s.operatorCount;e++)this.channels[c].instruments[l].operators[e].envelope=P.R(0,s.operatorEnvelopeNames.length,r[t.charCodeAt(n++)]);else if(98==e){let e;if(i){f=r[t.charCodeAt(n++)];const i=r[t.charCodeAt(n++)];e=Math.ceil(.5*i);const s=new L(r,t,n,n+e);for(let t=0;t<i;t++)this.channels[f].bars[t]=s.read(3)+1}else if(a){let i=0;for(;1<<i<this.patternsPerChannel;)i++;e=Math.ceil(this.getChannelCount()*this.barCount*i/6);const s=new L(r,t,n,n+e);for(f=0;f<this.getChannelCount();f++)for(let t=0;t<this.barCount;t++)this.channels[f].bars[t]=s.read(i)+1}else{let i=0;for(;1<<i<this.patternsPerChannel+1;)i++;e=Math.ceil(this.getChannelCount()*this.barCount*i/6);const s=new L(r,t,n,n+e);for(f=0;f<this.getChannelCount();f++)for(let t=0;t<this.barCount;t++)this.channels[f].bars[t]=s.read(i)}n+=e}else if(112==e){let e=0;if(i)f=r[t.charCodeAt(n++)],n++,e=r[t.charCodeAt(n++)],e<<=6,e+=r[t.charCodeAt(n++)];else{f=0;let i=r[t.charCodeAt(n++)];for(;i>0;)e<<=6,e+=r[t.charCodeAt(n++)],i--}const s=new L(r,t,n,n+e);n+=e;let h=0;for(;1<<h<this.instrumentsPerChannel;)h++;for(;;){const t=this.getChannelIsDrum(f),n=t?0:12*this.channels[f].octave;let e=null,a=null,o=(t?4:12)+n;const r=t?[4,6,7,2,3,8,0,10]:[12,19,24,31,36,7,0],c=[];for(let t=0;t<r.length;t++)r[t]+=n;for(let t=0;t<this.patternsPerChannel;t++){const n=this.channels[f].patterns[t];if(n.reset(),n.instrument=s.read(h),!i&&0==s.read(1))continue;let l=0;const p=n.notes;for(;l<this.beatsPerBar*this.partsPerBeat;){const t=1==s.read(1);let n=!1,i=0;if(t?i=s.readLongTail(0,0):n=1==s.read(1),t||n){let n,h,f;if(t)n=c[i],c.splice(i,1);else{for(n={},n.pitchCount=1;n.pitchCount<4&&1==s.read(1);)n.pitchCount++;n.pinCount=s.readPinCount(),n.initialVolume=s.read(2),n.pins=[],n.length=0,n.bendCount=0;for(let t=0;t<n.pinCount;t++)h={},h.pitchBend=1==s.read(1),h.pitchBend&&n.bendCount++,n.length+=s.readPartDuration(),h.time=n.length,h.volume=s.read(2),n.pins.push(h)}c.unshift(n),c.length>10&&c.pop(),e=S(0,l,l+n.length,n.initialVolume),e.pitches=[],e.pins.length=1;const d=[];for(let t=0;t<n.pitchCount+n.bendCount;t++){if(1==s.read(1)){const t=s.read(3);f=r[t],r.splice(t,1)}else{f=o;let t=s.readPitchInterval();for(;t>0;){for(f++;-1!=r.indexOf(f);)f++;t--}for(;t<0;){for(f--;-1!=r.indexOf(f);)f--;t++}}r.unshift(f),r.length>8&&r.pop(),t<n.pitchCount?e.pitches.push(f):d.push(f),o=t==n.pitchCount-1?e.pitches[0]:f}d.unshift(e.pitches[0]);for(const t of n.pins)t.pitchBend&&d.shift(),a=A(d[0]-e.pitches[0],t.time,t.volume),e.pins.push(a);l=e.end,p.push(e)}else{l+=s.readPartDuration()}}}if(i)break;if(f++,f>=this.getChannelCount())break}}}}toJsonObject(t=!0,n=1,e=!0){const i=[];for(let h=0;h<this.getChannelCount();h++){const a=[],o=this.getChannelIsDrum(h);for(let t=0;t<this.instrumentsPerChannel;t++){const n=this.channels[h].instruments[t];if(o)a.push({type:s.instrumentTypeNames[2],volume:20*(5-n.volume),imute:s.imuteNames[n.imute],wave:s.drumNames[n.wave],transition:s.transitionNames[n.transition],octoff:s.octoffNames[n.octoff],ipan:s.ipanValues[n.ipan]});else if(0==n.type)a.push({type:s.instrumentTypeNames[n.type],volume:20*(5-n.volume),wave:s.waveNames[n.wave],transition:s.transitionNames[n.transition],filter:s.filterNames[n.filter],chorus:s.chorusNames[n.chorus],effect:s.effectNames[n.effect],harm:s.harmNames[n.harm],imute:s.imuteNames[n.imute],octoff:s.octoffNames[n.octoff],ipan:s.ipanValues[n.ipan]});else if(1==n.type){const t=[];for(const e of n.operators)t.push({frequency:s.operatorFrequencyNames[e.frequency],amplitude:e.amplitude,envelope:s.operatorEnvelopeNames[e.envelope]});a.push({type:s.instrumentTypeNames[n.type],volume:20*(5-n.volume),transition:s.transitionNames[n.transition],effect:s.effectNames[n.effect],octoff:s.octoffNames[n.octoff],fmChorus:s.fmChorusNames[n.fmChorus],algorithm:s.operatorAlgorithmNames[n.algorithm],feedbackType:s.operatorFeedbackNames[n.feedbackType],feedbackAmplitude:n.feedbackAmplitude,feedbackEnvelope:s.operatorEnvelopeNames[n.feedbackEnvelope],operators:t,ipan:s.ipanValues[n.ipan],imute:s.imuteNames[n.imute]})}else{if(3!=n.type)throw new Error("Unrecognized instrument type");a.push({type:s.instrumentTypeNames[2],volume:20*(5-n.volume),wave:s.pwmwaveNames[n.wave],transition:s.transitionNames[n.transition],filter:s.filterNames[n.filter],chorus:s.chorusNames[n.chorus],effect:s.effectNames[n.effect],harm:s.harmNames[n.harm],imute:s.imuteNames[n.imute],octoff:s.octoffNames[n.octoff],ipan:s.ipanValues[n.ipan]})}}const r=[];for(const t of this.channels[h].patterns){const n=[];for(const e of t.notes){const t=[];for(const n of e.pins)t.push({tick:n.time+e.start,pitchBend:n.interval,volume:Math.round(100*n.volume/3)});n.push({pitches:e.pitches,points:t})}r.push({instrument:t.instrument+1,notes:n})}const c=[];if(t)for(let t=0;t<this.loopStart;t++)c.push(this.channels[h].bars[t]);for(let t=0;t<n;t++)for(let t=this.loopStart;t<this.loopStart+this.loopLength;t++)c.push(this.channels[h].bars[t]);if(e)for(let t=this.loopStart+this.loopLength;t<this.barCount;t++)c.push(this.channels[h].bars[t]);i.push({type:o?"drum":"pitch",octaveScrollBar:this.channels[h].octave,instruments:a,patterns:r,sequence:c})}return{format:P.P,version:P.M,theme:s.themeNames[this.theme],scale:s.scaleNames[this.scale],mix:s.mixNames[this.mix],sampleRate:s.sampleRateNames[this.sampleRate],key:s.keyNames[this.key],introBars:this.loopStart,loopBars:this.loopLength,beatsPerBar:this.beatsPerBar,ticksPerBeat:this.partsPerBeat,beatsPerMinute:this.getBeatsPerMinute(),reverb:this.reverb,blend:this.blend,riff:this.riff,detune:this.detune,muff:this.muff,channels:i}}fromJsonObject(t){if(this.initToDefault(!0),!t)return;if(t.version>P.P)return;if(this.scale=11,null!=t.scale){const n={"romani :)":8,"romani :(":9},e=null!=n[t.scale]?n[t.scale]:s.scaleNames.indexOf(t.scale);-1!=e&&(this.scale=e)}if(null!=t.mix&&(this.mix=s.mixNames.indexOf(t.mix),-1==this.mix&&(this.mix=1)),null!=t.sampleRate&&(this.sampleRate=s.sampleRateNames.indexOf(t.sampleRate),-1==this.sampleRate&&(this.sampleRate=2)),null!=t.key)if("number"==typeof t.key)this.key=s.keyNames.length-1-(t.key+1200>>>0)%s.keyNames.length;else if("string"==typeof t.key){const n=t.key,e=n.charAt(0).toUpperCase(),i=n.charAt(1).toLowerCase();let s={C:11,D:9,E:7,F:6,G:4,A:2,B:0}[e];const h={"#":-1,"♯":-1,b:1,"♭":1}[i];null!=s&&(null!=h&&(s+=h),s<0&&(s+=12),s%=12,this.key=s)}if(null!=t.beatsPerMinute){const n=0|t.beatsPerMinute;this.tempo=Math.round(4+9*Math.log(n/120)/Math.LN2),this.tempo=P.R(0,s.tempoSteps,this.tempo)}null!=t.reverb&&(this.reverb=P.R(0,s.reverbRange,0|t.reverb)),null!=t.blend&&(this.blend=P.R(0,s.blendRange,0|t.blend)),null!=t.riff&&(this.riff=P.R(0,s.riffRange,0|t.riff)),null!=t.detune&&(this.detune=P.R(0,s.detuneRange,0|t.detune)),null!=t.muff&&(this.muff=P.R(0,s.muffRange,0|t.muff)),null!=t.beatsPerBar&&(this.beatsPerBar=Math.max(s.beatsPerBarMin,Math.min(s.beatsPerBarMax,0|t.beatsPerBar))),null!=t.ticksPerBeat&&(this.partsPerBeat=0|t.ticksPerBeat,-1==s.partCounts.indexOf(this.partsPerBeat)&&(this.partsPerBeat=s.partCounts[s.partCounts.length-1]));let n=1,e=1,i=1;if(t.channels)for(const s of t.channels)s.instruments&&(n=Math.max(n,0|s.instruments.length)),s.patterns&&(e=Math.max(e,0|s.patterns.length)),s.sequence&&(i=Math.max(i,0|s.sequence.length));this.instrumentsPerChannel=n,this.patternsPerChannel=e,this.barCount=i,null!=t.introBars&&(this.loopStart=P.R(0,this.barCount,0|t.introBars)),null!=t.loopBars&&(this.loopLength=P.R(1,this.barCount-this.loopStart+1,0|t.loopBars));let h=0,a=0;if(t.channels)for(let n=0;n<t.channels.length;n++){let e=t.channels[n];this.channels.length<=n&&(this.channels[n]=new F),null!=e.octaveScrollBar&&(this.channels[n].octave=P.R(0,5,0|e.octaveScrollBar));for(let t=this.channels[n].instruments.length;t<this.instrumentsPerChannel;t++)this.channels[n].instruments[t]=new E;this.channels[n].instruments.length=this.instrumentsPerChannel;for(let t=this.channels[n].patterns.length;t<this.patternsPerChannel;t++)this.channels[n].patterns[t]=new B;this.channels[n].patterns.length=this.patternsPerChannel;for(let t=0;t<this.barCount;t++)this.channels[n].bars[t]=1;this.channels[n].bars.length=this.barCount;let i=!1;i=e.type?"drum"==e.type:n>=3,i?a++:h++;for(let t=0;t<this.instrumentsPerChannel;t++){const h=this.channels[n].instruments[t];let a;e.instruments&&(a=e.instruments[t]),null==a&&(a={});const o={binary:0},r=a.transition||a.envelope;if(h.transition=null!=o[r]?o[r]:s.transitionNames.indexOf(r),-1==h.transition&&(h.transition=1),i)null!=a.volume?h.volume=P.R(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.drumNames.indexOf(a.wave),-1==h.wave&&(h.wave=1),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4);else if(h.type=s.instrumentTypeNames.indexOf(a.type),null==h.type&&(h.type=0),0==h.type){null!=a.volume?h.volume=P.R(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.waveNames.indexOf(a.wave),-1==h.wave&&(h.wave=1);const t={"sustain sharp":1,"sustain medium":2,"sustain soft":3,"decay sharp":4};h.filter=null!=t[a.filter]?t[a.filter]:s.filterNames.indexOf(a.filter),-1==h.filter&&(h.filter=0),h.chorus=s.chorusNames.indexOf(a.chorus),-1==h.chorus&&(h.chorus=0),h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.harm=s.harmNames.indexOf(a.harm),-1==h.harm&&(h.harm=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4)}else if(3==h.type||2==h.type){2==h.type&&(h.type=3),null!=a.volume?h.volume=P.R(0,s.volumeNames.length,Math.round(5-(0|a.volume)/20)):h.volume=0,h.wave=s.pwmwaveNames.indexOf(a.wave),-1==h.wave&&(h.wave=1);const t={"sustain sharp":1,"sustain medium":2,"sustain soft":3,"decay sharp":4};h.filter=null!=t[a.filter]?t[a.filter]:s.filterNames.indexOf(a.filter),-1==h.filter&&(h.filter=0),h.chorus=s.chorusNames.indexOf(a.chorus),-1==h.chorus&&(h.chorus=0),h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.harm=s.harmNames.indexOf(a.harm),-1==h.harm&&(h.harm=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0),h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4)}else{if(1!=h.type)throw new Error("Unrecognized instrument type.");h.effect=s.effectNames.indexOf(a.effect),-1==h.effect&&(h.effect=0),h.octoff=s.octoffNames.indexOf(a.octoff),-1==h.octoff&&(h.octoff=0),h.fmChorus=s.fmChorusNames.indexOf(a.fmChorus),-1==h.fmChorus&&(h.fmChorus=0),h.algorithm=s.operatorAlgorithmNames.indexOf(a.algorithm),-1==h.algorithm&&(h.algorithm=0),h.feedbackType=s.operatorFeedbackNames.indexOf(a.feedbackType),-1==h.feedbackType&&(h.feedbackType=0),null!=a.feedbackAmplitude?h.feedbackAmplitude=P.R(0,s.operatorAmplitudeMax+1,0|a.feedbackAmplitude):h.feedbackAmplitude=0,h.feedbackEnvelope=s.operatorEnvelopeNames.indexOf(a.feedbackEnvelope),-1==h.feedbackEnvelope&&(h.feedbackEnvelope=0);for(let t=0;t<s.operatorCount;t++){const n=h.operators[t];let e;a.operators&&(e=a.operators[t]),null==e&&(e={}),n.frequency=s.operatorFrequencyNames.indexOf(e.frequency),-1==n.frequency&&(n.frequency=0),null!=e.amplitude?n.amplitude=P.R(0,s.operatorAmplitudeMax+1,0|e.amplitude):n.amplitude=0,n.envelope=s.operatorEnvelopeNames.indexOf(e.envelope),-1==n.envelope&&(n.envelope=0)}h.ipan=s.ipanValues.indexOf(a.ipan),-1==h.ipan&&(h.ipan=4),h.imute=s.imuteNames.indexOf(a.imute),-1==h.imute&&(h.imute=0)}}for(let t=0;t<this.patternsPerChannel;t++){const h=this.channels[n].patterns[t];let a;if(e.patterns&&(a=e.patterns[t]),null!=a&&(h.instrument=P.R(0,this.instrumentsPerChannel,(0|a.instrument)-1),a.notes&&a.notes.length>0)){const t=Math.min(this.beatsPerBar*this.partsPerBeat,a.notes.length>>>0);let n=0;for(let e=0;e<a.notes.length&&!(e>=t);e++){const t=a.notes[e];if(!(t&&t.pitches&&t.pitches.length>=1&&t.points&&t.points.length>=2))continue;const o=S(0,0,0,0);o.pitches=[],o.pins=[];for(let n=0;n<t.pitches.length;n++){const e=0|t.pitches[n];if(-1==o.pitches.indexOf(e)&&(o.pitches.push(e),o.pitches.length>=4))break}if(o.pitches.length<1)continue;let r=n,c=0;for(let n=0;n<t.points.length;n++){const e=t.points[n];if(null==e||null==e.tick)continue;const i=null==e.pitchBend?0:0|e.pitchBend,s=0|e.tick,h=null==e.volume?3:Math.max(0,Math.min(3,Math.round(3*(0|e.volume)/100)));if(!(s>this.beatsPerBar*this.partsPerBeat)){if(0==o.pins.length){if(s<r)continue;o.start=s,c=i}else if(s<=r)continue;r=s,o.pins.push(A(i-c,s-o.start,h))}}if(o.pins.length<2)continue;o.end=o.pins[o.pins.length-1].time+o.start;const l=i?s.drumCount-1:s.maxPitch;let f=l,p=0;for(let t=0;t<o.pitches.length;t++)o.pitches[t]+=c,(o.pitches[t]<0||o.pitches[t]>l)&&(o.pitches.splice(t,1),t--),o.pitches[t]<f&&(f=o.pitches[t]),o.pitches[t]>p&&(p=o.pitches[t]);if(!(o.pitches.length<1)){for(let t=0;t<o.pins.length;t++){const n=o.pins[t];n.interval+f<0&&(n.interval=-f),n.interval+p>l&&(n.interval=l-p),t>=2&&n.interval==o.pins[t-1].interval&&n.interval==o.pins[t-2].interval&&n.volume==o.pins[t-1].volume&&n.volume==o.pins[t-2].volume&&(o.pins.splice(t-1,1),t--)}h.notes.push(o),n=o.end}}}}for(let t=0;t<this.barCount;t++)this.channels[n].bars[t]=e.sequence?Math.min(this.patternsPerChannel,e.sequence[t]>>>0):0}this.pitchChannelCount=h,this.drumChannelCount=a,this.channels.length=this.getChannelCount()}static R(t,n,e){return e<=(n-=1)?e>=t?e:t:n}getPattern(t,n){const e=this.channels[t].bars[n];return 0==e?null:this.channels[t].patterns[e-1]}getPatternInstrument(t,n){const e=this.getPattern(t,n);return null==e?0:e.instrument}getPatternInstrumentMute(t,n){const e=this.getPattern(t,n),i=this.getPatternInstrument(t,n),s=this.channels[t].instruments[i];return null==e?0:s.imute}getPatternInstrumentVolume(t,n){const e=this.getPattern(t,n),i=this.getPatternInstrument(t,n),s=this.channels[t].instruments[i];return null==e?0:s.volume}getBeatsPerMinute(){return Math.round(120*Math.pow(2,(-4+this.tempo)/9))}getChannelFingerprint(t){const n=this.getChannelCount();let e=0;for(let i=0;i<n;i++)if(i<this.pitchChannelCount){const n=this.getPatternInstrument(i,t),s=this.channels[i].instruments[n];if(0==s.type)this.v[e++]="c";else if(1==s.type)this.v[e++]="f",this.v[e++]=s.algorithm,this.v[e++]=s.feedbackType;else{if(3!=s.type)throw new Error("Unknown instrument type.");this.v[e++]="p"}}else this.v[e++]="d";return this.v.length=e,this.v.join("")}}P.P="BeepBox",P.S=2,P.M=6,P.L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,62,0,0,1,2,3,4,5,6,7,8,9,0,0,0,0,0,0,0,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,0,0,0,0,63,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,0,0,0,0,0],P.k=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,45,95];class N{constructor(){this.sampleLeft=0,this.sampleRight=0,this.phases=[],this.phaseDeltas=[],this.volumeStarts=[],this.volumeDeltas=[],this.volumeLeft=[],this.volumeRight=[],this.phaseDeltaScale=0,this.filter=0,this.filterScale=0,this.vibratoScale=0,this.harmonyMult=0,this.harmonyVolumeMult=1,this.feedbackOutputs=[],this.feedbackMult=0,this.feedbackDelta=0,this.reset()}reset(){for(let t=0;t<s.operatorCount;t++)this.phases[t]=0,this.feedbackOutputs[t]=0;this.sampleLeft=0,this.sampleRight=0}}class I{static warmUpSynthesizer(t){if(null!=t){for(let n=0;n<t.instrumentsPerChannel;n++)for(let e=t.pitchChannelCount;e<t.pitchChannelCount+t.drumChannelCount;e++)s.getDrumWave(t.channels[e].instruments[n].wave);for(let n=0;n<t.barCount;n++)I.getGeneratedSynthesizer(t,n)}}static operatorAmplitudeCurve(t){return(Math.pow(16,t/15)-1)/15}get playing(){return!this.paused}get playhead(){return this.playheadInternal}set playhead(t){if(null!=this.song){this.playheadInternal=Math.max(0,Math.min(this.song.barCount,t));let n=this.playheadInternal;this.bar=Math.floor(n),n=this.song.beatsPerBar*(n-this.bar),this.beat=Math.floor(n),n=this.song.partsPerBeat*(n-this.beat),this.part=Math.floor(n),n=4*(n-this.part),this.arpeggio=Math.floor(n);const e=this.getSamplesPerArpeggio();n=e*(n-this.arpeggio),this.arpeggioSampleCountdown=Math.floor(e-n),this.bar<this.song.loopStart&&(this.enableIntro=!0),this.bar>this.song.loopStart+this.song.loopLength&&(this.enableOutro=!0)}}get totalSamples(){if(null==this.song)return 0;const t=4*this.getSamplesPerArpeggio()*this.song.partsPerBeat*this.song.beatsPerBar;let n=this.loopCount;n<0&&(n=1);let e=this.song.loopLength*n;return this.enableIntro&&(e+=this.song.loopStart),this.enableOutro&&(e+=this.song.barCount-(this.song.loopStart+this.song.loopLength)),e*t}get totalSeconds(){return Math.round(this.totalSamples/this.samplesPerSecond)}get totalBars(){return null==this.song?0:this.song.barCount}constructor(t=null){this.samplesPerSecond=44100,this.effectDuration=.14,this.effectAngle=2*Math.PI/(this.effectDuration*this.samplesPerSecond),this.effectYMult=2*Math.cos(this.effectAngle),this.limitDecay=1/(2*this.samplesPerSecond),this.song=null,this.pianoPressed=!1,this.pianoPitch=[0],this.pianoChannel=0,this.enableIntro=!0,this.enableOutro=!1,this.loopCount=-1,this.volume=1,this.playheadInternal=0,this.bar=0,this.beat=0,this.part=0,this.arpeggio=0,this.arpeggioSampleCountdown=0,this.paused=!0,this.channels=[],this.stillGoing=!1,this.effectPhase=0,this.limit=0,this.delayLineLeft=new Float32Array(16384),this.delayLineRight=new Float32Array(16384),this.delayPosLeft=0,this.delayPosRight=0,this.delayFeedback0Left=0,this.delayFeedback0Right=0,this.delayFeedback1Left=0,this.delayFeedback1Right=0,this.delayFeedback2Left=0,this.delayFeedback2Right=0,this.delayFeedback3Left=0,this.delayFeedback3Right=0,this.audioProcessCallback=t=>{const n=t.outputBuffer,e=n.getChannelData(0),i=n.getChannelData(1);this.synthesize(e,i,n.length)},null!=t&&this.setSong(t)}setSong(t){"string"==typeof t?this.song=new P(t):t instanceof P&&(this.song=t)}spsCalc(){return I.warmUpSynthesizer(this.song),0==this.song.sampleRate?44100:1==this.song.sampleRate?48e3:2==this.song.sampleRate?this.audioCtx.sampleRate:3==this.song.sampleRate?4*this.audioCtx.sampleRate:4==this.song.sampleRate?2*this.audioCtx.sampleRate:5==this.song.sampleRate?this.audioCtx.sampleRate/2:6==this.song.sampleRate?this.audioCtx.sampleRate/4:7==this.song.sampleRate?this.audioCtx.sampleRate/8:8==this.song.sampleRate?this.audioCtx.sampleRate/16:this.audioCtx.sampleRate}play(){if(!this.paused)return;this.paused=!1,I.warmUpSynthesizer(this.song);const t=window.AudioContext;this.audioCtx=this.audioCtx||new t,this.scriptNode=this.audioCtx.createScriptProcessor?this.audioCtx.createScriptProcessor(2048,0,2):this.audioCtx.createJavaScriptNode(2048,0,2),this.scriptNode.onaudioprocess=this.audioProcessCallback,this.scriptNode.connect(this.audioCtx.destination),this.scriptNode.channelCountMode="explicit",this.scriptNode.channelInterpretation="speakers",this.samplesPerSecond=this.spsCalc(),this.effectAngle=2*Math.PI/(this.effectDuration*this.samplesPerSecond),this.effectYMult=2*Math.cos(this.effectAngle),this.limitDecay=1/(2*this.samplesPerSecond)}pause(){this.paused||(this.paused=!0,this.audioCtx.close&&(this.audioCtx.close(),this.audioCtx=null),this.scriptNode=null)}snapToStart(){this.bar=0,this.enableIntro=!0,this.snapToBar()}snapToBar(t){void 0!==t&&(this.bar=t),this.playheadInternal=this.bar,this.beat=0,this.part=0,this.arpeggio=0,this.arpeggioSampleCountdown=0,this.effectPhase=0;for(const t of this.channels)t.reset();this.delayPosLeft=0,this.delayPosRight=0,this.delayFeedback0Left=0,this.delayFeedback0Right=0,this.delayFeedback1Left=0,this.delayFeedback1Right=0,this.delayFeedback2Left=0,this.delayFeedback2Right=0,this.delayFeedback3Left=0,this.delayFeedback3Right=0;for(let t=0;t<this.delayLineLeft.length;t++)this.delayLineLeft[t]=0;for(let t=0;t<this.delayLineRight.length;t++)this.delayLineRight[t]=0}nextBar(){if(!this.song)return;const t=this.bar;this.bar++,this.enableOutro?this.bar>=this.song.barCount&&(this.bar=this.enableIntro?0:this.song.loopStart):(this.bar>=this.song.loopStart+this.song.loopLength||this.bar>=this.song.barCount)&&(this.bar=this.song.loopStart),this.playheadInternal+=this.bar-t}prevBar(){if(!this.song)return;const t=this.bar;this.bar--,this.bar<0&&(this.bar=this.song.loopStart+this.song.loopLength-1),this.bar>=this.song.barCount&&(this.bar=this.song.barCount-1),this.bar<this.song.loopStart&&(this.enableIntro=!0),!this.enableOutro&&this.bar>=this.song.loopStart+this.song.loopLength&&(this.bar=this.song.loopStart+this.song.loopLength-1),this.playheadInternal+=this.bar-t}synthesize(t,n,e){if(null==this.song){for(let i=0;i<e;i++)t[i]=0,n[i]=0;return}const i=this.song.getChannelCount();for(let t=this.channels.length;t<i;t++)this.channels[t]=new N;this.channels.length=i;const s=this.getSamplesPerArpeggio();let h=0,a=!1;for((0==this.arpeggioSampleCountdown||this.arpeggioSampleCountdown>s)&&(this.arpeggioSampleCountdown=s),this.part>=this.song.partsPerBeat&&(this.beat++,this.part=0,this.arpeggio=0,this.arpeggioSampleCountdown=s),this.beat>=this.song.beatsPerBar&&(this.bar++,this.beat=0,this.part=0,this.arpeggio=0,this.arpeggioSampleCountdown=s,-1==this.loopCount&&(this.bar<this.song.loopStart&&!this.enableIntro&&(this.bar=this.song.loopStart),this.bar>=this.song.loopStart+this.song.loopLength&&!this.enableOutro&&(this.bar=this.song.loopStart))),this.bar>=this.song.barCount&&(this.enableOutro?(this.bar=0,this.enableIntro=!0,a=!0,this.pause()):this.bar=this.song.loopStart),this.bar>=this.song.loopStart&&(this.enableIntro=!1);;){if(a){for(;h<e;)t[h]=0,n[h]=0,h++;break}h=I.getGeneratedSynthesizer(this.song,this.bar)(this,this.song,t,n,e,h,s);if(-1==h)break;this.beat=0,this.effectPhase=0,this.bar++,this.bar<this.song.loopStart?this.enableIntro||(this.bar=this.song.loopStart):this.enableIntro=!1,this.bar>=this.song.loopStart+this.song.loopLength&&(this.loopCount>0&&this.loopCount--,(this.loopCount>0||!this.enableOutro)&&(this.bar=this.song.loopStart)),this.bar>=this.song.barCount&&(this.bar=0,this.enableIntro=!0,a=!0,this.pause())}this.playheadInternal=(((this.arpeggio+1-this.arpeggioSampleCountdown/s)/4+this.part)/this.song.partsPerBeat+this.beat)/this.song.beatsPerBar+this.bar}static computeOperatorEnvelope(t,n,e,i){switch(s.operatorEnvelopeType[t]){case 0:return i;case 1:return 1;case 4:let h=1/(1+n*s.operatorEnvelopeSpeed[t]);return s.operatorEnvelopeInverted[t]?1-h:h;case 5:return s.operatorSpecialCustomVolume[t]?.5-.5*Math.cos(2*e*Math.PI*(4*i)):.5-.5*Math.cos(2*e*Math.PI*s.operatorEnvelopeSpeed[t]);case 2:return Math.max(1,2-10*n);case 3:if(s.operatorSpecialCustomVolume[t]){const t=.25/Math.sqrt(i);return n<t?n/t:1/(1+16*i*(n-t))}{const e=s.operatorEnvelopeSpeed[t],i=.25/Math.sqrt(e);return n<i?n/i:1/(1+(n-i)*e)}case 6:return Math.max(-1-n,-2+n);default:throw new Error("Unrecognized operator envelope type.")}}static computeChannelInstrument(t,n,e,i,h,a,o){const r=n.getChannelIsDrum(e),c=t.channels[e],l=n.getPattern(e,t.bar),f=n.channels[e].instruments[null==l?0:l.instrument],p=t.pianoPressed&&e==t.pianoChannel,d=r?s.drumBasePitches[f.wave]:s.keyTransposes[n.key],y=r?s.drumInterval:1,b=r?s.drumWaveIsSoft[f.wave]?24:60:48,m=4*a/t.samplesPerSecond,u=1/n.partsPerBeat;c.phaseDeltaScale=0,c.filter=1,c.filterScale=1,c.vibratoScale=0,c.harmonyMult=1,c.harmonyVolumeMult=1;let g=0,w=t.arpeggio,x=t.arpeggioSampleCountdown,v=null,k=!0,M=0,L=0,C=1,A=1,S=0,B=0,R=0,E=0,F=0,P=0;for(let t=0;t<s.operatorCount;t++)c.phaseDeltas[t]=0,c.volumeStarts[t]=0,c.volumeDeltas[t]=0,c.volumeLeft[0]=0,c.volumeRight[0]=0;if(p)v=t.pianoPitch,C=A=1,S=B=1,k=!1;else if(null!=l){let e=null,s=null,h=null;for(let t=0;t<l.notes.length;t++)if(l.notes[t].end<=i)s=l.notes[t];else if(l.notes[t].start<=i&&l.notes[t].end>i)e=l.notes[t];else if(l.notes[t].start>i){h=l.notes[t];break}if(null!=e&&null!=s&&s.end!=e.start&&(s=null),null!=e&&null!=h&&h.start!=e.end&&(h=null),null!=e){let r;for(v=e.pitches,g=i-e.start,r=1;r<e.pins.length-1&&!(e.pins[r].time+e.start>i);r++);const c=e.pins[r-1],l=e.pins[r],p=4*e.start,d=4*e.end,y=4*(e.start+c.time),b=4*(e.start+l.time),m=4*i+w,u=4*i+w+1,N=(m-y)/(b-y),I=(u-y)/(b-y);let D=c.volume+(l.volume-c.volume)*N,T=c.volume+(l.volume-c.volume)*I,Z=1,j=1,z=c.interval+(l.interval-c.interval)*N,O=c.interval+(l.interval-c.interval)*I,G=c.time+(l.time-c.time)*N,U=c.time+(l.time-c.time)*I,V=G,Y=U;const W=1-(x+o)/a,J=1-x/a;k=m+W-p==0;const H=f.transition;m==p&&(0==H?k=!1:2==H?Z=0:3==H?null==s||0==s.pins[s.pins.length-1].volume||0==e.pins[0].volume?Z=0:(z=.5*(s.pitches[0]+s.pins[s.pins.length-1].interval-e.pitches[0]),V=.5*s.pins[s.pins.length-1].time,k=!1):4==H?j=0:5==H?z=100:6==H?z=-1:7==H&&(Z=6)),u==d&&(0==H?null==h&&e.start+l.time!=n.partsPerBeat*n.beatsPerBar&&(j=0):1==H||2==H?j=0:3==H&&(null==h||0==e.pins[e.pins.length-1].volume||0==h.pins[0].volume?j=0:(O=.5*(h.pitches[0]-e.pitches[0]+e.pins[e.pins.length-1].interval),Y*=.5))),M=z+(O-z)*W,L=z+(O-z)*J,S=t.volumeConversion(D+(T-D)*W),B=t.volumeConversion(D+(T-D)*J),C=Z+(j-Z)*W,A=Z+(j-Z)*J,R=e.start+G+(U-G)*W,E=e.start+G+(U-G)*J,F=V+(Y-V)*W,P=V+(Y-V)*J}}if(null!=v){if(r||1!=f.type){let e=v[0];if(r)0==s.harmNames[f.harm]?1==v.length?e=v[0]+s.octoffValues[f.octoff]:2==v.length?e=v[w>>1]+s.octoffValues[f.octoff]:3==v.length?e=v[3==w?1:w]+s.octoffValues[f.octoff]:4==v.length&&(e=v[w]+s.octoffValues[f.octoff]):1==s.harmNames[f.harm]?1==v.length?e=v[0]+s.octoffValues[f.octoff]:2==v.length?e=(v[1]+v[0])/2+s.octoffValues[f.octoff]:3==v.length?e=(v[1+(w>>1)]+v[0])/2+s.octoffValues[f.octoff]:4==v.length&&(e=(v[(3==w?1:w)+1]+v[0])/2+s.octoffValues[f.octoff]):2==s.harmNames[f.harm]?1==v.length?e=v[0]+s.octoffValues[f.octoff]:2==v.length?e=(v[1]+v[0])/2+s.octoffValues[f.octoff]:3==v.length?e=(v[2]+v[0])/2+s.octoffValues[f.octoff]:4==v.length&&(e=(v[(3==w?2:w)+1]+v[0])/2+s.octoffValues[f.octoff]):3==s.harmNames[f.harm]?1==v.length?e=v[0]+s.octoffValues[f.octoff]:2==v.length?e=(v[1]+v[0])/2+s.octoffValues[f.octoff]:3==v.length?e=(v[2]+v[0])/2+s.octoffValues[f.octoff]:4==v.length&&(e=(v[3]+v[0])/2+s.octoffValues[f.octoff]):4==s.harmNames[f.harm]&&(1==v.length?e=v[0]+s.octoffValues[f.octoff]:2==v.length?e=(v[1]+v[0])/2+s.octoffValues[f.octoff]:3==v.length?e=(v[1+(w>>1)]+v[0])/2+s.octoffValues[f.octoff]:4==v.length&&(e=v[2+(w>>1)]+v[0]+s.octoffValues[f.octoff]));else if(1==s.harmNames[f.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[1+(w>>1)]-v[0]:4==v.length&&(t=v[(3==w?1:w)+1]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/b)}else if(2==s.harmNames[f.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[(3==w?2:w)+1]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/b)}else if(3==s.harmNames[f.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[3]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/b)}else if(4==s.harmNames[f.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[1+(w>>1)]-v[0]:4==v.length&&(t=v[2+(w>>1)]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/b)}else if(5==s.harmNames[f.harm]){let t=0;2==v.length?t=v[1]-v[0]:3==v.length?t=v[2]-v[0]:4==v.length&&(t=v[3==w?2:w]-v[0]),c.harmonyMult=Math.pow(2,t/12),c.harmonyVolumeMult=Math.pow(2,-t/b)}else 0==s.harmNames[f.harm]&&(2==v.length?e=v[w>>1]:3==v.length?e=v[3==w?1:w]:4==v.length&&(e=v[w]));const i=(e+M)*y,a=(e+L)*y,l=t.frequencyFromPitch(d+i),p=Math.pow(2,-i/b),u=Math.pow(2,-a/b);let g;if(r&&s.drumWaveIsSoft[f.wave]&&(c.filter=Math.min(1,l*h*s.drumPitchFilterMult[f.wave])),r)g=0==n.mix?.19*s.drumVolumes[f.wave]:3==n.mix?.12*s.drumVolumes[f.wave]:.09*s.drumVolumes[f.wave];else{const t=s.filterDecays[f.filter];c.filter=Math.pow(2,-t*m*F);const n=Math.pow(2,-t*m*P);c.filterScale=Math.pow(n/c.filter,1/o),g=.135*s.waveVolumes[f.wave]*s.filterVolumes[f.filter]*s.chorusVolumes[f.chorus]}k&&!r&&c.reset(),c.phaseDeltas[0]=l*h;let x=0;x=2==n.mix?9==f.volume?0:Math.pow(3,-s.volumeValues[f.volume])*s.imuteValues[f.imute]:1==n.mix?f.volume>=5?0:Math.pow(3,-s.volumeMValues[f.volume])*s.imuteValues[f.imute]:f.volume>=5?0:Math.pow(2,-s.volumeMValues[f.volume])*s.imuteValues[f.imute],c.volumeStarts[0]=C*S*p*g*x;const R=A*B*u*g*x;c.volumeDeltas[0]=(R-c.volumeStarts[0])/o,c.volumeLeft[0]=Math.min(1,1+s.ipanValues[f.ipan]),c.volumeRight[0]=Math.min(1,1-s.ipanValues[f.ipan])}else{let e=1,i=0;const a=s.operatorCarrierCounts[f.algorithm];for(let r=0;r<s.operatorCount;r++){const l=r<s.operatorCarrierCounts[f.algorithm],p=s.operatorAssociatedCarrier[f.algorithm][r]-1,g=v[r<v.length?r:p<v.length?p:0]+s.octoffValues[f.octoff]+n.detune/24,w=s.operatorFrequencies[f.operators[r].frequency],x=(g+M)*y+s.operatorCarrierChorus[s.fmChorusNames[f.fmChorus]][p],N=w*t.frequencyFromPitch(d+x)+s.operatorHzOffsets[f.operators[r].frequency];c.phaseDeltas[r]=N*h*s.sineWaveLength,k&&c.reset();const D=I.operatorAmplitudeCurve(f.operators[r].amplitude);let T=0;-1!=s.volumeValues[f.volume]&&2==n.mix||-1!=s.volumeMValues[f.volume]&&2!=n.mix?T=2==n.mix?l?D*s.operatorAmplitudeSigns[f.operators[r].frequency]*(1-s.volumeValues[f.volume]/2.3):D*s.operatorAmplitudeSigns[f.operators[r].frequency]:D*s.operatorAmplitudeSigns[f.operators[r].frequency]*(1-s.volumeMValues[f.volume]/2.3):(-1!=s.volumeValues[f.volume]||-1!=s.volumeMValues[f.volume])&&(T=0);let Z=T*s.imuteValues[f.imute],j=T*s.imuteValues[f.imute];if(c.volumeLeft[0]=Math.min(1,1+s.ipanValues[f.ipan]),c.volumeRight[0]=Math.min(1,1-s.ipanValues[f.ipan]),r<a){const t=.03,e=(g+L)*y;let s=0,h=0;3==n.mix?(s=Math.pow(5,-x/b),h=Math.pow(5,-e/b)):(s=Math.pow(2,-x/b),h=Math.pow(2,-e/b)),Z*=s*t*C,j*=h*t*A,i+=D}else Z*=1.5*s.sineWaveLength,j*=1.5*s.sineWaveLength,e*=1-Math.min(1,f.operators[r].amplitude/15);const z=f.operators[r].envelope;Z*=I.computeOperatorEnvelope(z,m*F,u*R,S),j*=I.computeOperatorEnvelope(z,m*P,u*E,B),c.volumeStarts[r]=Z,c.volumeDeltas[r]=(j-Z)/o}const r=.3*s.sineWaveLength*f.feedbackAmplitude/15;let l=r*I.computeOperatorEnvelope(f.feedbackEnvelope,m*F,u*R,S),p=r*I.computeOperatorEnvelope(f.feedbackEnvelope,m*P,u*E,B);c.feedbackMult=l,c.feedbackDelta=(p-c.feedbackMult)/o,e*=1-f.feedbackAmplitude/15,e*=1-Math.min(1,Math.max(0,i-1)/2);for(let t=0;t<a;t++)c.volumeStarts[t]*=1+3*e,c.volumeDeltas[t]*=1+3*e}c.phaseDeltaScale=Math.pow(2,(L-M)*y/12/o),c.vibratoScale=g<s.effectVibratoDelays[f.effect]?0:Math.pow(2,s.effectVibratos[f.effect]/12)-1}else{c.reset();for(let t=0;t<s.operatorCount;t++)c.phaseDeltas[0]=0,c.volumeStarts[0]=0,c.volumeDeltas[0]=0,c.volumeLeft[0]=0,c.volumeRight[0]=0}}static getGeneratedSynthesizer(t,n){const e=t.getChannelFingerprint(n);if(null==I.generatedSynthesizers[e]){const i=[],h=[];for(let e=0;e<t.pitchChannelCount;e++)h[e]=t.channels[e].instruments[t.getPatternInstrument(e,n)];for(const n of I.synthSourceTemplate)if(-1!=n.indexOf("#"))if(-1!=n.indexOf("// PITCH"))for(let e=0;e<t.pitchChannelCount;e++)i.push(n.replace(/#/g,e+""));else if(-1!=n.indexOf("// JCHIP"))for(let e=0;e<t.pitchChannelCount;e++)0==h[e].type&&i.push(n.replace(/#/g,e+""));else if(-1!=n.indexOf("// CHIP"))for(let e=0;e<t.pitchChannelCount;e++)(0==h[e].type||3==h[e].type)&&i.push(n.replace(/#/g,e+""));else if(-1!=n.indexOf("// FM")){for(let e=0;e<t.pitchChannelCount;e++)if(1==h[e].type)if(-1!=n.indexOf("$"))for(let t=0;t<s.operatorCount;t++)i.push(n.replace(/#/g,e+"").replace(/\$/g,t+""));else i.push(n.replace(/#/g,e+""))}else if(-1!=n.indexOf("// PWM"))for(let e=0;e<t.pitchChannelCount;e++)3==h[e].type&&i.push(n.replace(/#/g,e+""));else if(-1!=n.indexOf("// CARRIER OUTPUTS")){for(let e=0;e<t.pitchChannelCount;e++)if(1==h[e].type){const t=[];for(let n=0;n<s.operatorCarrierCounts[h[e].algorithm];n++)t.push("channel"+e+"Operator"+n+"Scaled");i.push(n.replace(/#/g,e+"").replace("/*channel"+e+"Operator$Scaled*/",t.join(" + ")))}}else if(-1!=n.indexOf("// NOISE"))for(let e=t.pitchChannelCount;e<t.pitchChannelCount+t.drumChannelCount;e++)i.push(n.replace(/#/g,e+""));else{if(-1==n.indexOf("// ALL"))throw new Error("Missing channel type annotation for line: "+n);for(let e=0;e<t.pitchChannelCount+t.drumChannelCount;e++)i.push(n.replace(/#/g,e+""))}else if(-1!=n.indexOf("// INSERT OPERATOR COMPUTATION HERE")){for(let n=s.operatorCount-1;n>=0;n--)for(const e of I.operatorSourceTemplate)for(let a=0;a<t.pitchChannelCount;a++)if(1==h[a].type)if(-1!=e.indexOf("/* + channel#Operator@Scaled*/")){let t="";for(const e of s.operatorModulatedBy[h[a].algorithm][n])t+=" + channel"+a+"Operator"+(e-1)+"Scaled";const o=s.operatorFeedbackIndices[h[a].feedbackType][n];if(o.length>0){t+=" + channel"+a+"FeedbackMult * (";const n=[];for(const t of o)n.push("channel"+a+"Operator"+(t-1)+"Output");t+=n.join(" + ")+")"}i.push(e.replace(/#/g,a+"").replace(/\$/g,n+"").replace("/* + channel"+a+"Operator@Scaled*/",t))}else i.push(e.replace(/#/g,a+"").replace(/\$/g,n+""))}else i.push(n);I.generatedSynthesizers[e]=new Function("synth","song","dataLeft","dataRight","bufferLength","bufferIndex","samplesPerArpeggio",i.join("\n"))}return I.generatedSynthesizers[e]}frequencyFromPitch(t){return 440*Math.pow(2,(t-69)/12)}volumeConversion(t){return Math.pow(t/3,1.5)}getSamplesPerArpeggio(){if(null==this.song)return 0;const t=4*(this.song.getBeatsPerMinute()/60*this.song.partsPerBeat);return Math.floor(this.samplesPerSecond/t)}}I.negativePhaseGuard=1e3,I.generatedSynthesizers={},I.synthSourceTemplate=("\n\t\t\tvar sampleTime = 1.0 / synth.samplesPerSecond;\n\t\t\tvar effectYMult = +synth.effectYMult;\n\t\t\tvar limitDecay = +synth.limitDecay;\n\t\t\tvar volume = +synth.volume;\n\t\t\tvar delayLineLeft = synth.delayLineLeft;\n\t\t\tvar delayLineRight = synth.delayLineRight;\n\t\t\tvar reverb = Math.pow(song.reverb / beepbox.Config.reverbRange, 0.667) * 0.425;\n\t\t\tvar blend = Math.pow(song.blend / beepbox.Config.blendRange, 0.667) * 0.425;\n\t\t\tvar mix = song.mix;\n\t\t\tvar muff = Math.pow(song.muff / beepbox.Config.muffRange, 0.667) * 0.425;\n\t\t\tvar detune = song.detune;\n\t\t\tvar riff = Math.pow(song.riff / beepbox.Config.riffRange, 0.667) * 0.425; \n\t\t\tvar sineWave = beepbox.Config.sineWave;\n\t\t\t\n\t\t\t// Initialize instruments based on current pattern.\n\t\t\tvar instrumentChannel# = song.getPatternInstrument(#, synth.bar); // ALL\n\t\t\tvar instrument# = song.channels[#].instruments[instrumentChannel#]; // ALL\n\t\t\tvar channel#Wave = (mix <= 1) ? beepbox.Config.waves[instrument#.wave] : beepbox.Config.wavesMixC[instrument#.wave]; // CHIP\n\t\t\tvar channel#Wave = beepbox.Config.getDrumWave(instrument#.wave); // NOISE\n\t\t\tvar channel#WaveLength = channel#Wave.length; // CHIP\n\t\t\tvar channel#Wave = beepbox.Config.pwmwaves[instrument#.wave]; // PWM\n\t\t\tvar channel#WaveLength = channel#Wave.length; // PWM\n\t\t\tvar channel#FilterBase = (song.mix == 2) ? Math.pow(2 - (blend * 2) + (muff * 2), -beepbox.Config.filterBases[instrument#.filter]) : Math.pow(2, -beepbox.Config.filterBases[instrument#.filter] + (blend * 4) - (muff * 4)); // CHIP\n\t\t\tvar channel#TremoloScale = beepbox.Config.effectTremolos[instrument#.effect]; // PITCH\n\t\t\t\n\t\t\twhile (bufferIndex < bufferLength) {\n\t\t\t\t\n\t\t\t\tvar samples;\n\t\t\t\tvar samplesLeftInBuffer = bufferLength - bufferIndex;\n\t\t\t\tif (synth.arpeggioSampleCountdown <= samplesLeftInBuffer) {\n\t\t\t\t\tsamples = synth.arpeggioSampleCountdown;\n\t\t\t\t} else {\n\t\t\t\t\tsamples = samplesLeftInBuffer;\n\t\t\t\t}\n\t\t\t\tsynth.arpeggioSampleCountdown -= samples;\n\t\t\t\t\n\t\t\t\tvar time = synth.part + synth.beat * song.partsPerBeat;\n\t\t\t\t\n\t\t\t\tbeepbox.Synth.computeChannelInstrument(synth, song, #, time, sampleTime, samplesPerArpeggio, samples); // ALL\n\t\t\t\tvar synthChannel# = synth.channels[#]; // ALL\n\t\t\t\t\n\t\t\t\tvar channel#ChorusA = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] + beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\n\t\t\t\tvar channel#ChorusB = Math.pow(2.0, (beepbox.Config.chorusOffsets[instrument#.chorus] - beepbox.Config.chorusIntervals[instrument#.chorus] + beepbox.Config.octoffValues[instrument#.octoff] + (detune / 24) * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1)) / 12.0); // CHIP\n\t\t\t\tvar channel#ChorusSign = synthChannel#.harmonyVolumeMult * (beepbox.Config.chorusSigns[instrument#.chorus]); // CHIP\n\t\t\t\tchannel#ChorusB *= synthChannel#.harmonyMult; // CHIP\n\t\t\t\tvar channel#ChorusDeltaRatio = channel#ChorusB / channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\n\t\t\t\t\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] * channel#ChorusA * ((riff * beepbox.Config.chorusRiffApp[instrument#.chorus]) + 1); // CHIP\n\t\t\t\tvar channel#PhaseDelta = synthChannel#.phaseDeltas[0] / 32768.0; // NOISE\n\t\t\t\tvar channel#PhaseDeltaScale = synthChannel#.phaseDeltaScale; // ALL\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // CHIP\n\t\t\t\tvar channel#Volume = synthChannel#.volumeStarts[0]; // NOISE\n\t\t\t\tvar channel#VolumeLeft = synthChannel#.volumeLeft[0]; // ALL\n\t\t\t\tvar channel#VolumeRight = synthChannel#.volumeRight[0]; // ALL\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // CHIP\n\t\t\t\tvar channel#VolumeDelta = synthChannel#.volumeDeltas[0]; // NOISE\n\t\t\t\tvar channel#Filter = synthChannel#.filter * channel#FilterBase; // CHIP\n\t\t\t\tvar channel#Filter = synthChannel#.filter; // NOISE\n\t\t\t\tvar channel#FilterScale = synthChannel#.filterScale; // CHIP\n\t\t\t\tvar channel#VibratoScale = synthChannel#.vibratoScale; // PITCH\n\t\t\t\t\n\t\t\t\tvar effectY     = Math.sin(synth.effectPhase);\n\t\t\t\tvar prevEffectY = Math.sin(synth.effectPhase - synth.effectAngle);\n\t\t\t\t\n\t\t\t\tvar channel#PhaseA = synth.channels[#].phases[0] % 1; // CHIP\n\t\t\t\tvar channel#PhaseB = synth.channels[#].phases[1] % 1; // CHIP\n\t\t\t\tvar channel#Phase  = synth.channels[#].phases[0] % 1; // NOISE\n\t\t\t\t\n\t\t\t\tvar channel#Operator$Phase       = ((synth.channels[#].phases[$] % 1) + "+I.negativePhaseGuard+") * "+s.sineWaveLength+"; // FM\n\t\t\t\tvar channel#Operator$PhaseDelta  = synthChannel#.phaseDeltas[$]; // FM\n\t\t\t\tvar channel#Operator$OutputMult  = synthChannel#.volumeStarts[$]; // FM\n\t\t\t\tvar channel#Operator$OutputDelta = synthChannel#.volumeDeltas[$]; // FM\n\t\t\t\tvar channel#Operator$Output      = synthChannel#.feedbackOutputs[$]; // FM\n\t\t\t\tvar channel#FeedbackMult         = synthChannel#.feedbackMult; // FM\n\t\t\t\tvar channel#FeedbackDelta        = synthChannel#.feedbackDelta; // FM\n\t\t\t\t\n\t\t\t\tvar channel#SampleLeft = +synth.channels[#].sampleLeft; // ALL\n\t\t\t\tvar channel#SampleRight = +synth.channels[#].sampleRight; // ALL\n\t\t\t\t\n\t\t\t\tvar delayPosLeft = 0|synth.delayPosLeft;\n\t\t\t\tvar delayFeedback0Left = +synth.delayFeedback0Left;\n\t\t\t\tvar delayFeedback1Left = +synth.delayFeedback1Left;\n\t\t\t\tvar delayFeedback2Left = +synth.delayFeedback2Left;\n\t\t\t\tvar delayFeedback3Left = +synth.delayFeedback3Left;\n\t\t\t\tvar delayPosRight = 0|synth.delayPosRight;\n\t\t\t\tvar delayFeedback0Right = +synth.delayFeedback0Right;\n\t\t\t\tvar delayFeedback1Right = +synth.delayFeedback1Right;\n\t\t\t\tvar delayFeedback2Right = +synth.delayFeedback2Right;\n\t\t\t\tvar delayFeedback3Right = +synth.delayFeedback3Right;\n\t\t\t\tvar limit = +synth.limit;\n\t\t\t\t\n\t\t\t\twhile (samples) {\n\t\t\t\t\tvar channel#Vibrato = 1.0 + channel#VibratoScale * effectY; // PITCH\n\t\t\t\t\tvar channel#Tremolo = 1.0 + channel#TremoloScale * (effectY - 1.0); // PITCH\n\t\t\t\t\tvar temp = effectY;\n\t\t\t\t\teffectY = effectYMult * effectY - prevEffectY;\n\t\t\t\t\tprevEffectY = temp;\n\t\t\t\t\t\n\t\t\t\t\tchannel#SampleLeft += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // CHIP \n\t\t\t\t\tchannel#SampleLeft += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleLeft) * channel#Filter * channel#VolumeLeft; // NOISE\n\t\t\t\t\tchannel#SampleRight += ((channel#Wave[0|(channel#PhaseA * channel#WaveLength)] + channel#Wave[0|(channel#PhaseB * channel#WaveLength)] * channel#ChorusSign) * channel#Volume * channel#Tremolo - channel#SampleRight) * channel#Filter * channel#VolumeRight; // CHIP \n\t\t\t\t\tchannel#SampleRight += (channel#Wave[0|(channel#Phase * 32768.0)] * channel#Volume - channel#SampleRight) * channel#Filter * channel#VolumeRight; // NOISE\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // CHIP\n\t\t\t\t\tchannel#Volume += channel#VolumeDelta; // NOISE\n\t\t\t\t\tchannel#PhaseA += channel#PhaseDelta * channel#Vibrato; // CHIP\n\t\t\t\t\tchannel#PhaseB += channel#PhaseDelta * channel#Vibrato * channel#ChorusDeltaRatio; // CHIP\n\t\t\t\t\tchannel#Phase += channel#PhaseDelta; // NOISE\n\t\t\t\t\tchannel#Filter *= channel#FilterScale; // CHIP\n\t\t\t\t\tchannel#PhaseA -= 0|channel#PhaseA; // CHIP\n\t\t\t\t\tchannel#PhaseB -= 0|channel#PhaseB; // CHIP\n\t\t\t\t\tchannel#Phase -= 0|channel#Phase; // NOISE\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // CHIP\n\t\t\t\t\tchannel#PhaseDelta *= channel#PhaseDeltaScale; // NOISE\n\t\t\t\t\t\n\t\t\t\t\t// INSERT OPERATOR COMPUTATION HERE\n\t\t\t\t\tchannel#SampleLeft = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeLeft; // CARRIER OUTPUTS\n\t\t\t\t\tchannel#SampleRight = channel#Tremolo * (/*channel#Operator$Scaled*/) * channel#VolumeRight; // CARRIER OUTPUTS\n\t\t\t\t\tchannel#FeedbackMult += channel#FeedbackDelta; // FM\n\t\t\t\t\tchannel#Operator$OutputMult += channel#Operator$OutputDelta; // FM\n\t\t\t\t\tchannel#Operator$Phase += channel#Operator$PhaseDelta * channel#Vibrato; // FM\n\t\t\t\t\tchannel#Operator$PhaseDelta *= channel#PhaseDeltaScale; // FM\n\t\t\t\t\t\n\t\t\t\t\t// Reverb, implemented using a feedback delay network with a Hadamard matrix and lowpass filters.\n\t\t\t\t\t// good ratios:    0.555235 + 0.618033 + 0.818 +   1.0 = 2.991268\n\t\t\t\t\t// Delay lengths:  3041     + 3385     + 4481  +  5477 = 16384 = 2^14\n\t\t\t\t\t// Buffer offsets: 3041    -> 6426   -> 10907 -> 16384\n\t\t\t\t\tvar delayPos1Left = (delayPosLeft +  3041) & 0x3FFF;\n\t\t\t\t\tvar delayPos2Left = (delayPosLeft +  6426) & 0x3FFF;\n\t\t\t\t\tvar delayPos3Left = (delayPosLeft + 10907) & 0x3FFF;\n\t\t\t\t\tvar delaySampleLeft0 = (delayLineLeft[delayPosLeft]\n\t\t\t\t\t\t+ channel#SampleLeft // PITCH\n\t\t\t\t\t);\n\t\t\t\t\tvar delayPos1Right = (delayPosRight +  3041) & 0x3FFF;\n\t\t\t\t\tvar delayPos2Right = (delayPosRight +  6426) & 0x3FFF;\n\t\t\t\t\tvar delayPos3Right = (delayPosRight + 10907) & 0x3FFF;\n\t\t\t\t\tvar delaySampleRight0 = (delayLineRight[delayPosRight]\n\t\t\t\t\t\t+ channel#SampleRight // PITCH\n\t\t\t\t\t);\n\t\t\t\t\tvar delaySampleLeft1 = delayLineLeft[delayPos1Left];\n\t\t\t\t\tvar delaySampleLeft2 = delayLineLeft[delayPos2Left];\n\t\t\t\t\tvar delaySampleLeft3 = delayLineLeft[delayPos3Left];\n\t\t\t\t\tvar delayTemp0Left = -delaySampleLeft0 + delaySampleLeft1;\n\t\t\t\t\tvar delayTemp1Left = -delaySampleLeft0 - delaySampleLeft1;\n\t\t\t\t\tvar delayTemp2Left = -delaySampleLeft2 + delaySampleLeft3;\n\t\t\t\t\tvar delayTemp3Left = -delaySampleLeft2 - delaySampleLeft3;\n\t\t\t\t\tdelayFeedback0Left += ((delayTemp0Left + delayTemp2Left) * reverb - delayFeedback0Left) * 0.5;\n\t\t\t\t\tdelayFeedback1Left += ((delayTemp1Left + delayTemp3Left) * reverb - delayFeedback1Left) * 0.5;\n\t\t\t\t\tdelayFeedback2Left += ((delayTemp0Left - delayTemp2Left) * reverb - delayFeedback2Left) * 0.5;\n\t\t\t\t\tdelayFeedback3Left += ((delayTemp1Left - delayTemp3Left) * reverb - delayFeedback3Left) * 0.5;\n\t\t\t\t\tdelayLineLeft[delayPos1Left] = delayFeedback0Left;\n\t\t\t\t\tdelayLineLeft[delayPos2Left] = delayFeedback1Left;\n\t\t\t\t\tdelayLineLeft[delayPos3Left] = delayFeedback2Left;\n\t\t\t\t\tdelayLineLeft[delayPosLeft ] = delayFeedback3Left;\n\t\t\t\t\tdelayPosLeft = (delayPosLeft + 1) & 0x3FFF;\n\t\t\t\t\t\n\t\t\t\t\tvar delaySampleRight1 = delayLineRight[delayPos1Right];\n\t\t\t\t\tvar delaySampleRight2 = delayLineRight[delayPos2Right];\n\t\t\t\t\tvar delaySampleRight3 = delayLineRight[delayPos3Right];\n\t\t\t\t\tvar delayTemp0Right = -delaySampleRight0 + delaySampleRight1;\n\t\t\t\t\tvar delayTemp1Right = -delaySampleRight0 - delaySampleRight1;\n\t\t\t\t\tvar delayTemp2Right = -delaySampleRight2 + delaySampleRight3;\n\t\t\t\t\tvar delayTemp3Right = -delaySampleRight2 - delaySampleRight3;\n\t\t\t\t\tdelayFeedback0Right += ((delayTemp0Right + delayTemp2Right) * reverb - delayFeedback0Right) * 0.5;\n\t\t\t\t\tdelayFeedback1Right += ((delayTemp1Right + delayTemp3Right) * reverb - delayFeedback1Right) * 0.5;\n\t\t\t\t\tdelayFeedback2Right += ((delayTemp0Right - delayTemp2Right) * reverb - delayFeedback2Right) * 0.5;\n\t\t\t\t\tdelayFeedback3Right += ((delayTemp1Right - delayTemp3Right) * reverb - delayFeedback3Right) * 0.5;\n\t\t\t\t\tdelayLineRight[delayPos1Right] = delayFeedback0Right;\n\t\t\t\t\tdelayLineRight[delayPos2Right] = delayFeedback1Right;\n\t\t\t\t\tdelayLineRight[delayPos3Right] = delayFeedback2Right;\n\t\t\t\t\tdelayLineRight[delayPosRight ] = delayFeedback3Right;\n\t\t\t\t\tdelayPosRight = (delayPosRight + 1) & 0x3FFF;\n\t\t\t\t\t\n\t\t\t\t\tvar sampleLeft = delaySampleLeft0 + delaySampleLeft1 + delaySampleLeft2 + delaySampleLeft3\n\t\t\t\t\t\t+ channel#SampleLeft // NOISE\n\t\t\t\t\t;\n\t\t\t\t\t\n\t\t\t\t\tvar sampleRight = delaySampleRight0 + delaySampleRight1 + delaySampleRight2 + delaySampleRight3\n\t\t\t\t\t\t+ channel#SampleRight // NOISE\n\t\t\t\t\t;\n\t\t\t\t\t\n\t\t\t\t\tvar abs = sampleLeft < 0.0 ? -sampleLeft : sampleLeft;\n\t\t\t\t\tlimit -= limitDecay;\n\t\t\t\t\tif (limit < abs) limit = abs;\n\t\t\t\t\tsampleLeft /= limit * 0.75 + 0.25;\n\t\t\t\t\tsampleLeft *= volume;\n\t\t\t\t\tsampleLeft = sampleLeft;\n\t\t\t\t\tdataLeft[bufferIndex] = sampleLeft;\n\t\t\t\t\tsampleRight /= limit * 0.75 + 0.25;\n\t\t\t\t\tsampleRight *= volume;\n\t\t\t\t\tsampleRight = sampleRight;\n\t\t\t\t\tdataRight[bufferIndex] = sampleRight;\n\t\t\t\t\tbufferIndex++;\n\t\t\t\t\tsamples--;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsynthChannel#.phases[0] = channel#PhaseA; // CHIP\n\t\t\t\tsynthChannel#.phases[1] = channel#PhaseB; // CHIP\n\t\t\t\tsynthChannel#.phases[0] = channel#Phase; // NOISE\n\t\t\t\tsynthChannel#.phases[$] = channel#Operator$Phase / "+s.sineWaveLength+"; // FM\n\t\t\t\tsynthChannel#.feedbackOutputs[$] = channel#Operator$Output; // FM\n\t\t\t\tsynthChannel#.sampleLeft = channel#SampleLeft; // ALL\n\t\t\t\tsynthChannel#.sampleRight = channel#SampleRight; // ALL\n\t\t\t\t\n\t\t\t\tsynth.delayPosLeft = delayPosLeft;\n\t\t\t\tsynth.delayFeedback0Left = delayFeedback0Left;\n\t\t\t\tsynth.delayFeedback1Left = delayFeedback1Left;\n\t\t\t\tsynth.delayFeedback2Left = delayFeedback2Left;\n\t\t\t\tsynth.delayFeedback3Left = delayFeedback3Left;\n\t\t\t\tsynth.delayPosRight = delayPosRight;\n\t\t\t\tsynth.delayFeedback0Right = delayFeedback0Right;\n\t\t\t\tsynth.delayFeedback1Right = delayFeedback1Right;\n\t\t\t\tsynth.delayFeedback2Right = delayFeedback2Right;\n\t\t\t\tsynth.delayFeedback3Right = delayFeedback3Right;\n\t\t\t\tsynth.limit = limit;\n\t\t\t\t\n\t\t\t\tif (effectYMult * effectY - prevEffectY > prevEffectY) {\n\t\t\t\t\tsynth.effectPhase = Math.asin(effectY);\n\t\t\t\t} else {\n\t\t\t\t\tsynth.effectPhase = Math.PI - Math.asin(effectY);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (synth.arpeggioSampleCountdown == 0) {\n\t\t\t\t\tsynth.arpeggio++;\n\t\t\t\t\tsynth.arpeggioSampleCountdown = samplesPerArpeggio;\n\t\t\t\t\tif (synth.arpeggio == 4) {\n\t\t\t\t\t\tsynth.arpeggio = 0;\n\t\t\t\t\t\tsynth.part++;\n\t\t\t\t\t\tif (synth.part == song.partsPerBeat) {\n\t\t\t\t\t\t\tsynth.part = 0;\n\t\t\t\t\t\t\tsynth.beat++;\n\t\t\t\t\t\t\tif (synth.beat == song.beatsPerBar) {\n\t\t\t\t\t\t\t\t// The bar ended, may need to regenerate synthesizer.\n\t\t\t\t\t\t\t\treturn bufferIndex;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// Indicate that the buffer is finished generating.\n\t\t\treturn -1;\n\t\t").split("\n"),I.operatorSourceTemplate=("\n\t\t\t\t\t\tvar channel#Operator$PhaseMix = channel#Operator$Phase/* + channel#Operator@Scaled*/;\n\t\t\t\t\t\tvar channel#Operator$PhaseInt = channel#Operator$PhaseMix|0;\n\t\t\t\t\t\tvar channel#Operator$Index    = channel#Operator$PhaseInt & "+s.sineWaveMask+";\n\t\t\t\t\t\tvar channel#Operator$Sample   = sineWave[channel#Operator$Index];\n\t\t\t\t\t\tchannel#Operator$Output       = channel#Operator$Sample + (sineWave[channel#Operator$Index + 1] - channel#Operator$Sample) * (channel#Operator$PhaseMix - channel#Operator$PhaseInt);\n\t\t\t\t\t\tvar channel#Operator$Scaled   = channel#Operator$OutputMult * channel#Operator$Output;\n\t\t").split("\n");class D{constructor(){this.N=!0}I(){this.N=!1}isNoop(){return this.N}}class T extends D{constructor(t){super(),this.T=t,this.Z=!t}undo(){this.T?(this.j(),this.Z=!0):(this.O(),this.Z=!1)}redo(){this.T?(this.O(),this.Z=!1):(this.j(),this.Z=!0)}U(){return this.Z}j(){throw new Error("Change.doForwards(): Override me.")}O(){throw new Error("Change.doBackwards(): Override me.")}}class Z extends D{constructor(){super()}append(t){t.isNoop()||this.I()}}class j extends T{constructor(t){super(!1),this.V=null==t?[]:t.concat()}append(t){t.isNoop()||(this.V[this.V.length]=t,this.I())}j(){for(let t=0;t<this.V.length;t++)this.V[t].redo()}O(){for(let t=this.V.length-1;t>=0;t--)this.V[t].undo()}}class z extends T{constructor(t,n){super(!1),this.Y=t,this.W=n,this.J=this.W.start,this.H=this.W.end,this.X=this.W.start,this.$=this.W.end,this.K=this.W.pins,this._=[],this.q=this.W.pitches,this.tt=[]}nt(){for(let t=0;t<this._.length-1;)this._[t].time>=this._[t+1].time?this._.splice(t,1):t++;for(let t=1;t<this._.length-1;)this._[t-1].interval==this._[t].interval&&this._[t].interval==this._[t+1].interval&&this._[t-1].volume==this._[t].volume&&this._[t].volume==this._[t+1].volume?this._.splice(t,1):t++;const t=this._[0].interval,n=this._[0].time;for(let n=0;n<this.q.length;n++)this.tt[n]=this.q[n]+t;for(let e=0;e<this._.length;e++)this._[e].interval-=t,this._[e].time-=n;this.X=this.J+n,this.$=this.X+this._[this._.length-1].time,this.j(),this.I()}j(){this.W.pins=this._,this.W.pitches=this.tt,this.W.start=this.X,this.W.end=this.$,this.Y.notifier.changed()}O(){this.W.pins=this.K,this.W.pitches=this.q,this.W.start=this.J,this.W.end=this.H,this.Y.notifier.changed()}}class O extends D{constructor(t,n){super();if(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].type!=n){if(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].type=n,0==n){const n=t.song.channels[t.channel].instruments[t.getCurrentInstrument()];n.wave=Math.max(0,Math.min(s.waves.length-1,n.wave))}else if(3==n){const n=t.song.channels[t.channel].instruments[t.getCurrentInstrument()];n.wave=Math.max(0,Math.min(s.pwmwaves.length-1,n.wave))}t.notifier.changed(),this.I()}}}class G extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].transition!=n&&(this.I(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].transition=n,t.notifier.changed())}}class U extends D{constructor(t,n,e){if(super(),this.oldValue=n,e>t.song.patternsPerChannel)throw new Error("invalid pattern");t.song.channels[t.channel].bars[t.bar]=e,t.notifier.changed(),n!=e&&this.I()}}class V extends D{constructor(t,n){if(super(),t.song.barCount!=n){for(let e=0;e<t.song.getChannelCount();e++){for(let i=t.song.barCount;i<n;i++)t.song.channels[e].bars[i]=0;t.song.channels[e].bars.length=n}let e=t.bar,i=t.barScrollPos,s=t.song.loopStart,h=t.song.loopLength;t.song.barCount>n&&(e=Math.min(e,n-1),i=Math.max(0,Math.min(n-t.trackVisibleBars,i)),h=Math.min(n,h),s=Math.min(n-h,s)),t.bar=e,t.barScrollPos=i,t.song.loopStart=s,t.song.loopLength=h,t.song.barCount=n,t.notifier.changed(),this.I()}}}class Y extends D{constructor(t,n,e){super();const i=Math.min(s.barCountMax,t.song.barCount+e);if(0!=(e=i-t.song.barCount)){for(const e of t.song.channels)for(;e.bars.length<i;)e.bars.splice(n,0,0);t.song.barCount=i,t.bar+=e,t.barScrollPos+=e,t.song.loopStart>=n?t.song.loopStart+=e:t.song.loopStart+t.song.loopLength>=n&&(t.song.loopLength+=e),t.notifier.changed(),this.I()}}}class W extends D{constructor(t,n,e){super();for(const i of t.song.channels)i.bars.splice(n,e),0==i.bars.length&&i.bars.push(0);t.song.barCount=Math.max(1,t.song.barCount-e),t.bar=Math.max(0,t.bar-e),t.barScrollPos=Math.max(0,t.barScrollPos-e),t.song.loopStart>=n?t.song.loopStart=Math.max(0,t.song.loopStart-e):t.song.loopStart+t.song.loopLength>n&&(t.song.loopLength-=e),t.song.loopLength=Math.max(1,Math.min(t.song.barCount-t.song.loopStart,t.song.loopLength)),t.notifier.changed(),this.I()}}class J extends D{constructor(t,n,e){if(super(),t.song.pitchChannelCount!=n||t.song.drumChannelCount!=e){const i=[];for(let e=0;e<n;e++){const n=e,s=e;if(e<t.song.pitchChannelCount)i[n]=t.song.channels[s];else{i[n]=new F,i[n].octave=2;for(let e=0;e<t.song.instrumentsPerChannel;e++)i[n].instruments[e]=new E;for(let e=0;e<t.song.patternsPerChannel;e++)i[n].patterns[e]=new B;for(let e=0;e<t.song.barCount;e++)i[n].bars[e]=0}}for(let s=0;s<e;s++){const e=s+n,h=s+t.song.pitchChannelCount;if(s<t.song.drumChannelCount)i[e]=t.song.channels[h];else{i[e]=new F,i[e].octave=0;for(let n=0;n<t.song.instrumentsPerChannel;n++)i[e].instruments[n]=new E;for(let n=0;n<t.song.patternsPerChannel;n++)i[e].patterns[n]=new B;for(let n=0;n<t.song.barCount;n++)i[e].bars[n]=0}}t.song.pitchChannelCount=n,t.song.drumChannelCount=e;for(let n=0;n<t.song.getChannelCount();n++)t.song.channels[n]=i[n];t.song.channels.length=t.song.getChannelCount(),t.channel=Math.min(t.channel,n+e-1),t.notifier.changed(),this.I()}}}class H extends D{constructor(t,n){if(super(),t.song.beatsPerBar!=n){if(t.song.beatsPerBar>n){const e=new j;for(let i=0;i<t.song.getChannelCount();i++)for(let s=0;s<t.song.channels[i].patterns.length;s++)e.append(new Ot(t,t.song.channels[i].patterns[s],n*t.song.partsPerBeat,t.song.beatsPerBar*t.song.partsPerBeat))}t.song.beatsPerBar=n,t.notifier.changed(),this.I()}}}class Q extends D{constructor(t,n,e,i){super(),t.song.channels.splice(n+i,0,...t.song.channels.splice(n,e-n+1)),t.notifier.changed(),this.I()}}class X extends Z{constructor(t,n,e){super();const i=t.song.pitchChannelCount+(e?0:1),h=t.song.drumChannelCount+(e?1:0);if(i<=s.pitchChannelCountMax&&h<=s.drumChannelCountMax){const s=e?t.song.pitchChannelCount+t.song.drumChannelCount:t.song.pitchChannelCount;this.append(new J(t,i,h)),this.append(new Q(t,n,s-1,1))}t.notifier.changed(),this.I()}}class $ extends Z{constructor(t,n,e){for(super();e>=n;){const n=t.song.getChannelIsDrum(e);t.song.channels.splice(e,1),n?t.song.drumChannelCount--:t.song.pitchChannelCount--,e--}t.song.pitchChannelCount<s.pitchChannelCountMin&&this.append(new J(t,s.pitchChannelCountMin,t.song.drumChannelCount)),this.append(new K(t,Math.max(0,n-1),t.bar)),this.I(),t.notifier.changed()}}class K extends D{constructor(t,n,e){super();const i=t.channel,s=t.bar;t.channel=n,t.bar=e,t.barScrollPos=Math.min(t.bar,Math.max(t.bar-(t.trackVisibleBars-1),t.barScrollPos)),t.notifier.changed(),i==n&&s==e||this.I()}}class _ extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].chorus!=n&&(this.I(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].chorus=n,t.notifier.changed())}}class q extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].effect!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].effect=n,t.notifier.changed(),this.I())}}class tt extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].harm!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].harm=n,t.notifier.changed(),this.I())}}class nt extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].fmChorus!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].fmChorus=n,t.notifier.changed(),this.I())}}class et extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].octoff!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].octoff=n,t.notifier.changed(),this.I())}}class it extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].imute!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].imute=n,t.notifier.changed(),this.I())}}class st extends D{constructor(t,n,e){super(),n!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].ipan=e,t.notifier.changed(),this.I())}}class ht extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].filter!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].filter=n,t.notifier.changed(),this.I())}}class at extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].algorithm!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].algorithm=n,t.notifier.changed(),this.I())}}class ot extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackType!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackType=n,t.notifier.changed(),this.I())}}class rt extends D{constructor(t,n){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackEnvelope!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackEnvelope=n,t.notifier.changed(),this.I())}}class ct extends D{constructor(t,n,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[n].envelope!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[n].envelope=e,t.notifier.changed(),this.I())}}class lt extends D{constructor(t,n,e){super();t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[n].frequency!=e&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[n].frequency=e,t.notifier.changed(),this.I())}}class ft extends D{constructor(t,n,e,i){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].operators[n].amplitude=i,t.notifier.changed(),e!=i&&this.I()}}class pt extends D{constructor(t,n,e){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].feedbackAmplitude=e,t.notifier.changed(),n!=e&&this.I()}}class dt extends D{constructor(t,n){if(super(),t.song.instrumentsPerChannel!=n){for(let e=0;e<t.song.getChannelCount();e++){const i=t.song.channels[e].instruments[t.song.instrumentsPerChannel-1];for(let s=t.song.instrumentsPerChannel;s<n;s++){const n=new E;n.copy(i),t.song.channels[e].instruments[s]=n}t.song.channels[e].instruments.length=n;for(let i=0;i<t.song.patternsPerChannel;i++)t.song.channels[e].patterns[i].instrument>=n&&(t.song.channels[e].patterns[i].instrument=0)}t.song.instrumentsPerChannel=n,t.notifier.changed(),this.I()}}}class yt extends D{constructor(t,n){super(),t.song.key!=n&&(t.song.key=n,t.notifier.changed(),this.I())}}class bt extends D{constructor(t,n){super(),t.song.theme!=n&&(t.song.theme=n,t.notifier.changed(),this.I())}}class mt extends D{constructor(t,n,e,i,s){super(),this.Y=t,this.oldStart=n,this.oldLength=e,this.newStart=i,this.newLength=s,this.Y.song.loopStart=this.newStart,this.Y.song.loopLength=this.newLength,this.Y.notifier.changed(),this.oldStart==this.newStart&&this.oldLength==this.newLength||this.I()}}class ut extends T{constructor(t,n,e,i,s=!1){super(s),this.Y=t,this.W=n,this.et=e,this.it=i,this.I(),this.redo()}j(){this.W.pitches.splice(this.it,0,this.et),this.Y.notifier.changed()}O(){this.W.pitches.splice(this.it,1),this.Y.notifier.changed()}}class gt extends D{constructor(t,n,e){super(),this.oldValue=n,t.song.channels[t.channel].octave=e,t.notifier.changed(),n!=e&&this.I()}}class wt extends Z{constructor(t,n){if(super(),t.song.partsPerBeat!=n){for(let e=0;e<t.song.getChannelCount();e++)for(let i=0;i<t.song.channels[e].patterns.length;i++)this.append(new At(t,t.song.channels[e].patterns[i],t.song.partsPerBeat,n));t.song.partsPerBeat=n,t.notifier.changed(),this.I()}}}class xt extends Z{constructor(t,n,e,i,s){super(),n.notes=e,t.song.partsPerBeat!=s&&this.append(new At(t,n,s,t.song.partsPerBeat)),t.song.beatsPerBar!=i&&this.append(new Ot(t,n,t.song.beatsPerBar*t.song.partsPerBeat,i*t.song.partsPerBeat)),t.notifier.changed(),this.I()}}class vt extends D{constructor(t,n,e){super(),e.instrument!=n&&(e.instrument=n,t.notifier.changed(),this.I())}}class kt extends D{constructor(t,n){if(super(),t.song.patternsPerChannel!=n){for(let e=0;e<t.song.getChannelCount();e++){const i=t.song.channels[e].bars,s=t.song.channels[e].patterns;for(let t=0;t<i.length;t++)i[t]>n&&(i[t]=0);for(let t=s.length;t<n;t++)s[t]=new B;s.length=n}t.song.patternsPerChannel=n,t.notifier.changed(),this.I()}}}class Mt extends T{constructor(t){super(!1),this.st=null;const n=t.song;if(0!=n.channels[t.channel].bars[t.bar])return;this.Y=t,this.ht=t.bar,this.ot=t.channel,this.rt=n.patternsPerChannel,this.ct=n.patternsPerChannel;let e=null,i=null;for(let s=1;s<=n.patternsPerChannel;s++){let h=!1;for(let e=0;e<n.barCount;e++)if(n.channels[t.channel].bars[e]==s){h=!0;break}if(h)continue;null==i&&(i=s);if(0==n.channels[t.channel].patterns[s-1].notes.length){e=s;break}}if(null!=e)this.lt=e;else if(n.patternsPerChannel<n.barCount)this.ct=n.patternsPerChannel+1,this.lt=n.patternsPerChannel+1;else{if(null==i)throw new Error;this.lt=i,this.st=n.channels[t.channel].patterns[i-1].notes}this.I(),this.j()}j(){const t=this.Y.song;for(let n=t.patternsPerChannel;n<this.ct;n++)for(let e=0;e<t.getChannelCount();e++)t.channels[e].patterns[n]=new B;t.patternsPerChannel=this.ct;t.channels[this.ot].patterns[this.lt-1].notes=[],t.channels[this.ot].bars[this.ht]=this.lt,this.Y.notifier.changed()}O(){const t=this.Y.song,n=t.channels[this.ot].patterns[this.lt-1];null!=this.st&&(n.notes=this.st),t.channels[this.ot].bars[this.ht]=0;for(let n=0;n<t.getChannelCount();n++)t.channels[n].patterns.length=this.rt;t.patternsPerChannel=this.rt,this.Y.notifier.changed()}}class Lt extends z{constructor(t,n,e,i){super(t,n),i-=this.J;const s=this.K[e].time,h=Math.min(s,i),a=Math.max(s,i);let o=!1;for(let t=0;t<this.K.length;t++){const s=n.pins[t],r=s.time;r<h?this._.push(A(s.interval,r,s.volume)):r>a&&(o||(this._.push(A(this.K[e].interval,i,this.K[e].volume)),o=!0),this._.push(A(s.interval,r,s.volume)))}o||this._.push(A(this.K[e].interval,i,this.K[e].volume)),this.nt()}}class Ct extends z{constructor(t,n,e,i,s,h){super(t,n),e-=this.J,i-=this.J,s-=n.pitches[h];let a,o,r,c,l=!1,f=!1,p=0,d=3,y=!0;for(i>e?(a=0,o=1,r=n.pins.length,c=t=>{this._.push(t)}):(a=n.pins.length-1,o=-1,r=-1,c=t=>{this._.unshift(t)});a!=r;a+=o){const t=n.pins[a],h=t.time;for(;;)if(l){if(f){if(h*o==i*o)break;t.interval!=p&&(y=!1),c(A(y?s:t.interval,h,t.volume));break}if(h*o<=i*o&&(p=t.interval,d=t.volume),h*o<i*o)break;c(A(s,i,d)),f=!0}else{if(h*o<=e*o&&(p=t.interval,d=t.volume),h*o<e*o){c(A(t.interval,h,t.volume));break}c(A(p,e,d)),l=!0}}f||c(A(s,i,d)),this.nt()}}class At extends j{constructor(t,n,e,i){let s;if(super(),e>i)s=t=>Math.ceil(t*i/e);else{if(!(e<i))throw new Error("ChangeRhythm couldn't handle rhythm change from "+e+" to "+i+".");s=t=>Math.floor(t*i/e)}let h=0;for(;h<n.notes.length;){const e=n.notes[h];s(e.start)>=s(e.end)?this.append(new jt(t,n,e,h,!0)):(this.append(new St(t,e,s)),h++)}}}class St extends z{constructor(t,n,e){super(t,n);for(const t of this.K)this._.push(A(t.interval,e(t.time+this.J)-this.J,t.volume));this.nt()}}class Bt extends D{constructor(t,n){super(),t.song.scale!=n&&(t.song.scale=n,t.notifier.changed(),this.I())}}class Rt extends D{constructor(t,n){super(),t.song.mix!=n&&(t.song.mix=n,t.notifier.changed(),this.I())}}class Et extends D{constructor(t,n){super(),t.song.sampleRate!=n&&(t.song.sampleRate=n,t.notifier.changed(),this.I())}}class Ft extends D{constructor(t,n){super(),t.song.fromBase64String(n),t.channel=Math.min(t.channel,t.song.getChannelCount()-1),t.bar=Math.max(0,Math.min(t.song.barCount-1,t.bar)),t.barScrollPos=Math.max(0,Math.min(t.song.barCount-t.trackVisibleBars,t.barScrollPos)),t.barScrollPos=Math.min(t.bar,Math.max(t.bar-(t.trackVisibleBars-1),t.barScrollPos)),t.notifier.changed(),this.I()}}class Pt extends D{constructor(t,n,e){super(),t.song.tempo=e,t.notifier.changed(),n!=e&&this.I()}}class Nt extends D{constructor(t,n,e){super(),t.song.reverb=e,t.notifier.changed(),n!=e&&this.I()}}class It extends D{constructor(t,n,e){super(),t.song.blend=e,t.notifier.changed(),n!=e&&this.I()}}class Dt extends D{constructor(t,n,e){super(),t.song.riff=e,t.notifier.changed(),n!=e&&this.I()}}class Tt extends D{constructor(t,n,e){super(),t.song.detune=e,t.notifier.changed(),n!=e&&this.I()}}class Zt extends D{constructor(t,n,e){super(),t.song.muff=e,t.notifier.changed(),n!=e&&this.I()}}class jt extends T{constructor(t,n,e,i,s=!1){super(s),this.Y=t,this.ft=n,this.W=e,this.it=i,this.I(),this.redo()}j(){this.ft.notes.splice(this.it,0,this.W),this.Y.notifier.changed()}O(){this.ft.notes.splice(this.it,1),this.Y.notifier.changed()}}class zt extends z{constructor(t,n,e,i){super(t,n),e-=this.J,i-=this.J;let s,h=!1,a=this.K[0].volume,o=this.K[0].interval,r=!0;for(s=0;s<this.K.length;s++){const t=this.K[s];if(t.time<e)a=t.volume,o=t.interval;else{if(!(t.time<=i))break;if(t.time>e&&!h&&this._.push(A(o,e,a)),this._.push(A(t.interval,t.time,t.volume)),h=!0,t.time==i){r=!1;break}}}r&&this._.push(A(this.K[s].interval,i,this.K[s].volume)),this.nt()}}class Ot extends j{constructor(t,n,e,i,s){super();let h=0;for(;h<n.notes.length;){const a=n.notes[h];if(a==s&&null!=s)h++;else if(a.end<=e)h++;else{if(a.start>=i)break;a.start<e?(this.append(new zt(t,a,a.start,e)),h++):a.end>i?(this.append(new zt(t,a,i,a.end)),h++):this.append(new jt(t,n,a,h,!0))}}}}class Gt extends T{constructor(t,n,e){super(!1),this.Y=t,this.W=n,this.K=n.pins,this._=[],this.q=n.pitches,this.tt=[];const i=t.song.getChannelIsDrum(t.channel)?s.drumCount-1:s.maxPitch;for(let n=0;n<this.q.length;n++){let h=this.q[n];if(e){for(let n=h+1;n<=i;n++)if(t.song.getChannelIsDrum(t.channel)||s.scaleFlags[t.song.scale][n%12]){h=n;break}}else for(let n=h-1;n>=0;n--)if(t.song.getChannelIsDrum(t.channel)||s.scaleFlags[t.song.scale][n%12]){h=n;break}let a=!1;for(let t=0;t<this.tt.length;t++)if(this.tt[t]==h){a=!0;break}a||this.tt.push(h)}let h=0,a=i;for(let t=1;t<this.tt.length;t++){const n=this.tt[0]-this.tt[t];h<n&&(h=n),a>n+i&&(a=n+i)}for(const n of this.K){let i=n.interval+this.q[0];if(i<h&&(i=h),i>a&&(i=a),e){for(let n=i+1;n<=a;n++)if(t.song.getChannelIsDrum(t.channel)||s.scaleFlags[t.song.scale][n%12]){i=n;break}}else for(let n=i-1;n>=h;n--)if(t.song.getChannelIsDrum(t.channel)||s.scaleFlags[t.song.scale][n%12]){i=n;break}i-=this.tt[0],this._.push(A(i,n.time,n.volume))}if(0!=this._[0].interval)throw new Error("wrong pin start interval");for(let t=1;t<this._.length-1;)this._[t-1].interval==this._[t].interval&&this._[t].interval==this._[t+1].interval&&this._[t-1].volume==this._[t].volume&&this._[t].volume==this._[t+1].volume?this._.splice(t,1):t++;this.j(),this.I()}j(){this.W.pins=this._,this.W.pitches=this.tt,this.Y.notifier.changed()}O(){this.W.pins=this.K,this.W.pitches=this.q,this.Y.notifier.changed()}}class Ut extends j{constructor(t,n,e){super();for(let i=0;i<n.notes.length;i++)this.append(new Gt(t,n.notes[i],e))}}class Vt extends D{constructor(t,n,e){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].volume=e,t.notifier.changed(),n!=e&&this.I()}}class Yt extends T{constructor(t,n,e,i,s){super(!1),this.Y=t,this.W=n,this.K=n.pins,this._=[];let h=!1;for(const t of n.pins)t.time<e?this._.push(t):t.time==e?(this._.push(A(s,e,i)),h=!0):(h||(this._.push(A(s,e,i)),h=!0),this._.push(t));for(let t=1;t<this._.length-1;)this._[t-1].interval==this._[t].interval&&this._[t].interval==this._[t+1].interval&&this._[t-1].volume==this._[t].volume&&this._[t].volume==this._[t+1].volume?this._.splice(t,1):t++;this.j(),this.I()}j(){this.W.pins=this._,this.Y.notifier.changed()}O(){this.W.pins=this.K,this.Y.notifier.changed()}}class Wt extends D{constructor(t,n){super(),t.song.channels[t.channel].instruments[t.getCurrentInstrument()].wave!=n&&(t.song.channels[t.channel].instruments[t.getCurrentInstrument()].wave=n,t.notifier.changed(),this.I())}}class Jt{static getChannelColor(t,n){return n<t.pitchChannelCount?Jt.pitchChannels[n%Jt.pitchChannels.length]:Jt.noiseChannels[(n-t.pitchChannelCount)%Jt.noiseChannels.length]}static setTheme(t){this.dt.textContent=this.yt[t],this.usesPianoScheme="true"==getComputedStyle(this.dt).getPropertyValue("--use-piano-scheme").trim(),console.log("use-piano-scheme: "+this.usesPianoScheme)}}Jt.colorLookup=new Map,Jt.usesPianoScheme=!1,Jt.yt={default:"\n            :root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9900cc;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #864;\n\t\t\t\t--fifth-note: #468;\n                --volume-icon: #777777;\n\t\t\t\t--octave-scrollbar: #444;\n\t\t\t\t--scrollbar-octave: #864;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n        ",nepbox:"\n            :root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: #00fff5;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #00fff5;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #0a2d44;\n\t\t\t\t--tonic: #9150ff;\n\t\t\t\t--fifth-note: #990000;\n                --volume-icon: #00fff5;\n\t\t\t\t--octave-scrollbar: #484848;\n\t\t\t\t--scrollbar-octave: #9150ff;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #c13cbf;\n\t\t\t\t--pitch1-primary-channel: #f75dff;\n\t\t\t\t--pitch1-secondary-note: #b930a2;\n\t\t\t\t--pitch1-primary-note: #fca5ff;\n\t\t\t\t--pitch2-secondary-channel: #800000;\n\t\t\t\t--pitch2-primary-channel: #f00;\n\t\t\t\t--pitch2-secondary-note: #8c2121;\n\t\t\t\t--pitch2-primary-note: #ff5252;\n\t\t\t\t--pitch3-secondary-channel: #004bb3;\n\t\t\t\t--pitch3-primary-channel: #1792ff;\n\t\t\t\t--pitch3-secondary-note: #005cb3;\n\t\t\t\t--pitch3-primary-note: #00ffe9;\n\t\t\t\t--pitch4-secondary-channel: #a48800;\n\t\t\t\t--pitch4-primary-channel: #fb0;\n\t\t\t\t--pitch4-secondary-note: #9c4100;\n\t\t\t\t--pitch4-primary-note: #ffd84e;\n\t\t\t\t--pitch5-secondary-channel: #6c0000;\n\t\t\t\t--pitch5-primary-channel:   #ff3e3e;\n\t\t\t\t--pitch5-secondary-note:    #6c0000;\n\t\t\t\t--pitch5-primary-note:      #ff3e3e;\n\t\t\t\t--pitch6-secondary-channel:#d25a00;\n\t\t\t\t--pitch6-primary-channel:  #fdff00;\n\t\t\t\t--pitch6-secondary-note:   #d25a00;\n\t\t\t\t--pitch6-primary-note:     #fdff00;\n\t\t\t\t--pitch7-secondary-channel: #046000;\n\t\t\t\t--pitch7-primary-channel:   #0c79ff;\n\t\t\t\t--pitch7-secondary-note:    #046000;\n\t\t\t\t--pitch7-primary-note:      #0c79ff;\n\t\t\t\t--pitch8-secondary-channel:#3b2bae;\n\t\t\t\t--pitch8-primary-channel:  #d85d00;\n\t\t\t\t--pitch8-secondary-note:   #3b2bae;\n\t\t\t\t--pitch8-primary-note:     #d85d00;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #868686;\n\t\t\t\t--noise1-primary-channel: #fff;\n\t\t\t\t--noise1-secondary-note: #868686;\n\t\t\t\t--noise1-primary-note: #fff;\n\t\t\t\t--noise2-secondary-channel: #805300;\n\t\t\t\t--noise2-primary-channel: #ff8c00;\n\t\t\t\t--noise2-secondary-note: #6a3500;\n\t\t\t\t--noise2-primary-note: #a85400;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n        ",modbox2:"\n            :root {\n                --page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #00ff00;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #c4ffa3;\n\t\t\t\t--fifth-note: #96fffb;\n                --volume-icon: #c4ffa3;\n\t\t\t\t--octave-scrollbar: #00ff00;\n\t\t\t\t--scrollbar-octave: #fff;\n\t\t\t\t--channel-box: #444;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n            }\n\t\t",artic:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ffffff;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #eafffe;\n\t\t\t\t--fifth-note: #b7f1ff;\n\t\t\t\t--octave-scrollbar: #a5eeff;\n\t\t\t\t--scrollbar-octave: #cefffd;\n\t\t\t\t--volume-icon: #42dcff;\t\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t","Cinnamon Roll":"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ba8418;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--pitch1-background: #f5bb00;\n\t\t\t\t--pitch2-background: #f5bb00;\n\t\t\t\t--pitch3-background: #f5bb00;\n\t\t\t\t--pitch4-background: #f5bb00;\n\t\t\t\t--pitch5-background: #f5bb00;\n\t\t\t\t--pitch6-background: #f5bb00;\n\t\t\t\t--pitch8-background: #f5bb00;\n\t\t\t\t--pitch9-background: #f5bb00;\n\t\t\t\t--pitch10-background: #f5bb00;\n\t\t\t\t--pitch11-background: #f5bb00;\n\t\t\t\t--pitch12-background: #f5bb00;\n\t\t\t\t--tonic: #f5bb00;\n\t\t\t\t--fifth-note: #f5bb00;\n\t\t\t\t--volume-icon: #ba8418;\t\n\n\t\t\t\t--octave-scrollbar: #e59900;\n\t\t\t\t--scrollbar-octave: #ffff25;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",Ocean:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #5982ff;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--pitch-background: #444;\n\t\t\t\t--tonic: #090b3a;\n\t\t\t\t--fifth-note: #3f669b;\n\t\t\t\t--volume-icon: #090b3a;\t\n\n\t\t\t\t--octave-scrollbar: #4449a3;\n\t\t\t\t--scrollbar-octave: #3dffdb;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",rainbow:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\n\t\t\t\t--pitch-background: #444; \n\t\t\t\t--tonic: #ffaaaa; \n\t\t\t\t--pitch1-background: #ffceaa; \n\t\t\t\t--pitch2-background: #ffdfaa; \n\t\t\t\t--pitch3-background: #fff5aa; \n\t\t\t\t--pitch4-background: #e8ffaa;\n\t\t\t\t--pitch5-background: #bfffb2; \n\t\t\t\t--pitch6-background: #b2ffc8; \n\t\t\t\t--fifth-note: #b2ffe4; \n\t\t\t\t--pitch8-background: #b2f3ff; \n\t\t\t\t--pitch9-background: #b2b3ff; \n\t\t\t\t--pitch10-background: #e0b2ff; \n\t\t\t\t--pitch11-background: #ffafe9; \n\t\t\t\t--octave-scrollbar: #43ff00; \n\t\t\t\t--volume-icon: #ff00cb;\t\n\n\t\t\t\t--octave-scrollbar: #43ff00;\n\t\t\t\t--scrollbar-octave: #0400ff;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",float:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #878787;\t\n\n\t\t\t\t--pitch-background: #444; \n\t\t\t\t--tonic: #ffffff; \n\t\t\t\t--pitch1-background: #ededed;  \n\t\t\t\t--pitch2-background: #cecece;  \n\t\t\t\t--pitch3-background: #bababa;  \n\t\t\t\t--pitch4-background: #afafaf;\n\t\t\t\t--pitch5-background: #a5a5a5; \n\t\t\t\t--pitch6-background: #999999; \n\t\t\t\t--fifth-note: #8e8e8e; \n\t\t\t\t--pitch8-background: #828282; \n\t\t\t\t--pitch9-background: #777777; \n\t\t\t\t--pitch10-background: #565656; \n\t\t\t\t--pitch11-background: #282828; \n\t\t\t\t--octave-scrollbar: #ffffff; \n\t\t\t\t--scrollbar-octave: #c9c9c9;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",windows:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff0000;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #15a0db;\t\n\n\t\t\t\t--tonic: #da4e2a;\n\t\t\t\t--fifth-note: #5d9511;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #295294; \n\t\t\t\t--scrollbar-octave: #fdd01d;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",grassland:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #a0d168;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #74bc21;\t\n\n\t\t\t\t--tonic: #20330a;\n\t\t\t\t--fifth-note: #74bc21;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #74bc21; \n\t\t\t\t--scrollbar-octave: #20330a;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",dessert:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff6254;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ff0000;\t\n\n\t\t\t\t--tonic: #fffc5b;\n\t\t\t\t--fifth-note: #ff5e3a;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ff5e3a; \n\t\t\t\t--scrollbar-octave: #fffc5b;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",kahootiest:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #ff3355;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #66bf39;\t\n\n\t\t\t\t--tonic: #45a3e5;\n\t\t\t\t--fifth-note: #864cbf;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #eb670f; \n\t\t\t\t--scrollbar-octave: #ff3355;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",beambit:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #fefe00;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #fefe00;\t\n\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--tonic: #fefe00;\n\t\t\t\t--pitch1-background: #111111; \n\t\t\t\t--pitch2-background: #111111; \n\t\t\t\t--pitch3-background: #111111; \n\t\t\t\t--pitch4-background: #fa0103;\n\t\t\t\t--pitch5-background: #111111; \n\t\t\t\t--pitch6-background: #111111; \n\t\t\t\t--fifth-note: #111111; \n\t\t\t\t--pitch8-background: #0001fc; \n\t\t\t\t--pitch9-background: #111111; \n\t\t\t\t--pitch10-background: #111111; \n\t\t\t\t--pitch11-background: #111111;\n\n\t\t\t\t--octave-scrollbar: #0001fc; \n\t\t\t\t--scrollbar-octave: #fa0103;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",egg:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #6b003a;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #f01d7a;\t\n\n\t\t\t\t--tonic: #fffafa;\n\t\t\t\t--fifth-note: #ff91ce;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ffb1f4; \n\t\t\t\t--scrollbar-octave: #b4001b;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",Poniryoshka:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #4b4b4b;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ffc100;\t\n\n\t\t\t\t--tonic: #1a2844;\n\t\t\t\t--fifth-note: #dabbe6;\n\t\t\t\t--pitch4-background: #faf4c3;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #5f4c99; \n\t\t\t\t--scrollbar-octave: #ff8291;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",gameboy:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9bbc0f;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #8bac0f;\t\n\n\t\t\t\t--tonic: #9bbc0f; \n\t\t\t\t--pitch1-background: #9bbc0f; \n\t\t\t\t--pitch2-background: #9bbc0f; \n\t\t\t\t--pitch3-background: #9bbc0f; \n\t\t\t\t--pitch4-background: #9bbc0f;\n\t\t\t\t--pitch5-background: #9bbc0f; \n\t\t\t\t--pitch6-background: #306230; \n\t\t\t\t--fifth-note: #306230; \n\t\t\t\t--pitch8-background: #306230; \n\t\t\t\t--pitch9-background: #0f380f; \n\t\t\t\t--pitch10-background: #0f380f; \n\t\t\t\t--pitch11-background: #0f380f; \n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #9bbc0f; \n\t\t\t\t--scrollbar-octave: #8bac0f;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",woodkid:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #e83c4e;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ef3027;\t\n\n\t\t\t\t--tonic: #fff6fe;\n\t\t\t\t--pitch1-background: #41323b;\n\t\t\t\t--pitch2-background: #41323b;\n\t\t\t\t--pitch3-background: #41323b;\n\t\t\t\t--pitch4-background: #fff6fe;\n\t\t\t\t--pitch5-background: #41323b;\n\t\t\t\t--pitch6-background: #41323b;\n\t\t\t\t--fifth-note: #fff6fe;\n\t\t\t\t--pitch8-background: #41323b;\n\t\t\t\t--pitch9-background: #41323b;\n\t\t\t\t--pitch10-background: #41323b;\n\t\t\t\t--pitch11-background: #41323b;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ef3027; \n\t\t\t\t--scrollbar-octave: #ffedca;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",midnight:"\n\t\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #445566;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #aa5599;\t\n\n\t\t\t\t--tonic: #222222;\n\t\t\t\t--pitch1-background: #222222;\n\t\t\t\t--pitch2-background: #222222;\n\t\t\t\t--pitch3-background: #222222;\n\t\t\t\t--pitch4-background: #222222;\n\t\t\t\t--pitch5-background: #222222;\n\t\t\t\t--pitch6-background:#222222;\n\t\t\t\t--fifth-note: #444444;\n\t\t\t\t--pitch8-background: #222222;\n\t\t\t\t--pitch9-background: #222222;\n\t\t\t\t--pitch10-background: #222222;\n\t\t\t\t--pitch11-background: #222222;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #444444; \n\t\t\t\t--scrollbar-octave: #aa5599;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t\t}\n\t\t",snedbox:"\n\t\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #a53a3d;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\t\t\t--pitch-background: #444;\n\t\t\t--tonic: #864;\n\t\t\t--fifth-note: #60389b;\n\t\t\t--pitch4-background: #10997e;\n\t\t\t--volume-icon: #a53a3d;\n\t\t\t--octave-scrollbar: #444;\n\t\t\t--scrollbar-octave: #a53a3d;\n\t\t\t--channel-box: #444;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t}\n\t",unnamed:"\n\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #ffffff;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\t\t\t--pitch-background: #444;\n\t\t\t--pitch1-background: #ffffa0;\n\t\t\t--pitch2-background: #ffffa0;\n\t\t\t--pitch3-background: #ffffa0;\n\t\t\t--pitch4-background: #ffffa0;\n\t\t\t--pitch5-background: #ffffa0;\n\t\t\t--pitch6-background: #ffffa0;\n\t\t\t--pitch8-background: #ffffa0;\n\t\t\t--pitch9-background: #ffffa0;\n\t\t\t--pitch10-background: #ffffa0;\n\t\t\t--pitch11-background: #ffffa0;\n\t\t\t--pitch12-background: #ffffa0;\n\t\t\t--tonic: #ffffa0;\n\t\t\t--fifth-note: #ffffa0;\n\t\t\t--volume-icon: #ffffff;\t\n\n\t\t\t--octave-scrollbar: #ffffff;\n\t\t\t--scrollbar-octave: #ffffff;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",piano:"\n\t:root {\n\t\t\t--page-margin: black;\n\t\t\t--editor-background: black;\n\t\t\t--hover-preview: white;\n\t\t\t--playhead: white;\n\t\t\t--primary-text: white;\n\t\t\t--secondary-text: #999;\n\t\t\t--inverted-text: black;\n\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t--loop-accent: #ffffff;\n\t\t\t--link-accent: #98f;\n\t\t\t--ui-widget-background: #363636;\n\t\t\t--ui-widget-focus: #777;\n\n\t\t\t--use-piano-scheme: true;\n\n\t\t\t--pitch-background: #444;\n\t\t\t--volume-icon: #ff0000;\t\n\n\t\t\t--tonic: #ffffff;\n\t\t\t--white-tonic: #fff;\n\t\t\t--black-tonic: #222;\n\t\t\t--fifth-note: #7a7a7a;\n\n\t\t\t--octave-scrollbar: #211616;\n\t\t\t--scrollbar-octave: #ff4c4c;\n\t\t\t--pitch-white-key: #bfbfbf;\n\t\t\t--pitch-black-key: #7a7a7a;\n\n\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",halloween:"\n\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #9e2200;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #9e2200;\t\n\n\t\t\t\t--tonic: #681701;\n\t\t\t\t--pitch1-background: #754a3f;\n\t\t\t\t--pitch2-background: #754a3f;\n\t\t\t\t--pitch3-background: #754a3f;\n\t\t\t\t--pitch4-background: #754a3f;\n\t\t\t\t--pitch5-background: #754a3f;\n\t\t\t\t--pitch6-background:#754a3f;\n\t\t\t\t--fifth-note: #914300;\n\t\t\t\t--pitch8-background: #754a3f;\n\t\t\t\t--pitch9-background: #754a3f;\n\t\t\t\t--pitch10-background: #754a3f;\n\t\t\t\t--pitch11-background: #754a3f;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #9e2200; \n\t\t\t\t--scrollbar-octave: #701800;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t",frozen:"\n\t:root {\n\t\t\t\t--page-margin: black;\n\t\t\t\t--editor-background: black;\n\t\t\t\t--hover-preview: white;\n\t\t\t\t--playhead: white;\n\t\t\t\t--primary-text: white;\n\t\t\t\t--secondary-text: #999;\n\t\t\t\t--inverted-text: black;\n\t\t\t\t--text-selection: rgba(119,68,255,0.99);\n\t\t\t\t--box-selection-fill: rgba(255,255,255,0.2);\n\t\t\t\t--loop-accent: #38ef17;\n\t\t\t\t--link-accent: #98f;\n\t\t\t\t--ui-widget-background: #363636;\n\t\t\t\t--ui-widget-focus: #777;\n\t\t\t\t--volume-icon: #ed2d2d;\t\n\n\t\t\t\t--tonic: #88bce8; \n\t\t\t\t--pitch1-background: #99c8ef; \n\t\t\t\t--pitch2-background: #abd3f4; \n\t\t\t\t--pitch3-background: #b8d7f2; \n\t\t\t\t--pitch4-background: #cbe0f2;\n\t\t\t\t--pitch5-background: #e5f0f9; \n\t\t\t\t--pitch6-background: #ffffff; \n\t\t\t\t--fifth-note: #e5f0f9; \n\t\t\t\t--pitch8-background: #cbe0f2; \n\t\t\t\t--pitch9-background: #b8d7f2; \n\t\t\t\t--pitch10-background: #abd3f4; \n\t\t\t\t--pitch11-background: #99c8ef;\n\t\t\t\t--pitch-background: #444;\n\n\t\t\t\t--octave-scrollbar: #ffffff; \n\t\t\t\t--scrollbar-octave: #ed2d2d;\n\n\t\t\t\t--pitch1-secondary-channel: #0099a1;\n\t\t\t\t--pitch1-primary-channel:   #25f3ff;\n\t\t\t\t--pitch1-secondary-note:    #0099a1;\n\t\t\t\t--pitch1-primary-note:      #25f3ff;\n\t\t\t\t--pitch2-secondary-channel: #439143;\n\t\t\t\t--pitch2-primary-channel:   #44ff44;\n\t\t\t\t--pitch2-secondary-note:    #439143;\n\t\t\t\t--pitch2-primary-note:      #44ff44;\n\t\t\t\t--pitch3-secondary-channel: #a1a100;\n\t\t\t\t--pitch3-primary-channel:   #ffff25;\n\t\t\t\t--pitch3-secondary-note:    #a1a100;\n\t\t\t\t--pitch3-primary-note:      #ffff25;\n\t\t\t\t--pitch4-secondary-channel: #c75000;\n\t\t\t\t--pitch4-primary-channel:   #ff9752;\n\t\t\t\t--pitch4-secondary-note:    #c75000;\n\t\t\t\t--pitch4-primary-note:      #ff9752;\n\t\t\t\t--pitch5-secondary-channel: #d020d0;\n\t\t\t\t--pitch5-primary-channel:   #FF90FF;\n\t\t\t\t--pitch5-secondary-note:    #d020d0;\n\t\t\t\t--pitch5-primary-note:      #ff90ff;\n\t\t\t\t--pitch6-secondary-channel: #552377;\n\t\t\t\t--pitch6-primary-channel:   #9f31ea;\n\t\t\t\t--pitch6-secondary-note:    #552377;\n\t\t\t\t--pitch6-primary-note:      #9f31ea;\n\t\t\t\t--pitch7-secondary-channel: #221b89;\n\t\t\t\t--pitch7-primary-channel:   #2b6aff;\n\t\t\t\t--pitch7-secondary-note:    #221b89;\n\t\t\t\t--pitch7-primary-note:      #2b6aff;\n\t\t\t\t--pitch8-secondary-channel: #00995f;\n\t\t\t\t--pitch8-primary-channel:   #00ff9f;\n\t\t\t\t--pitch8-secondary-note:    #00995f;\n\t\t\t\t--pitch8-primary-note:      #00ff9f;\n\t\t\t\t--pitch9-secondary-channel: #d6b03e;\n\t\t\t\t--pitch9-primary-channel:   #ffbf00;\n\t\t\t\t--pitch9-secondary-note:    #d6b03e;\n\t\t\t\t--pitch9-primary-note:      #ffbf00;\n\t\t\t\t--pitch10-secondary-channel:#b25915;\n\t\t\t\t--pitch10-primary-channel:  #d85d00;\n\t\t\t\t--pitch10-secondary-note:   #b25915;\n\t\t\t\t--pitch10-primary-note:     #d85d00;\n\t\t\t\t--pitch11-secondary-channel:#891a60;\n\t\t\t\t--pitch11-primary-channel:  #ff00a1;\n\t\t\t\t--pitch11-secondary-note:   #891a60;\n\t\t\t\t--pitch11-primary-note:     #ff00a1;\n\t\t\t\t--pitch12-secondary-channel:#965cbc;\n\t\t\t\t--pitch12-primary-channel:  #c26afc;\n\t\t\t\t--pitch12-secondary-note:   #965cbc;\n\t\t\t\t--pitch12-primary-note:     #c26afc;\n\t\t\t\t--noise1-secondary-channel: #991010;\n\t\t\t\t--noise1-primary-channel:   #ff1616;\n\t\t\t\t--noise1-secondary-note:    #991010;\n\t\t\t\t--noise1-primary-note:      #ff1616;\n\t\t\t\t--noise2-secondary-channel: #aaaaaa;\n\t\t\t\t--noise2-primary-channel:   #ffffff;\n\t\t\t\t--noise2-secondary-note:    #aaaaaa;\n\t\t\t\t--noise2-primary-note:      #ffffff;\n\t\t\t\t--noise3-secondary-channel: #5869BD;\n\t\t\t\t--noise3-primary-channel:   #768dfc;\n\t\t\t\t--noise3-secondary-note:    #5869BD;\n\t\t\t\t--noise3-primary-note:      #768dfc;\n\t\t\t\t--noise4-secondary-channel: #7c9b42;\n\t\t\t\t--noise4-primary-channel:   #a5ff00;\n\t\t\t\t--noise4-secondary-note:    #7c9b42;\n\t\t\t\t--noise4-primary-note:      #a5ff00;\n\t\t\t}\n\t"},Jt.pageMargin="var(--page-margin, black)",Jt.editorBackground="var(--editor-background, black)",Jt.hoverPreview="var(--hover-preview, white)",Jt.playhead="var(--playhead, white)",Jt.primaryText="var(--primary-text, white)",Jt.secondaryText="var(--secondary-text, #999)",Jt.invertedText="var(--inverted-text, black)",Jt.textSelection="var(--text-selection, rgba(119,68,255,0.99))",Jt.boxSelectionFill="var(--box-selection-fill, rgba(255,255,255,0.2))",Jt.loopAccent="var(--loop-accent, #9900cc)",Jt.linkAccent="var(--link-accent, #98f)",Jt.uiWidgetBackground="var(--ui-widget-background, #444)",Jt.uiWidgetFocus="var(--ui-widget-focus)",Jt.pitchBackground="var(--pitch-background, #444)",Jt.tonic="var(--tonic, #864)",Jt.fifthNote="var(--fifth-note, #468)",Jt.pitch1Background="var(--pitch1-background, var(--pitch-background, #444))",Jt.pitch2Background="var(--pitch2-background, var(--pitch-background, #444))",Jt.pitch3Background="var(--pitch3-background, var(--pitch-background, #444))",Jt.pitch4Background="var(--pitch4-background, var(--pitch-background, #444))",Jt.pitch5Background="var(--pitch5-background, var(--pitch-background, #444))",Jt.pitch6Background="var(--pitch6-background, var(--pitch-background, #444))",Jt.pitch8Background="var(--pitch8-background, var(--pitch-background, #444))",Jt.pitch9Background="var(--pitch9-background, var(--pitch-background, #444))",Jt.pitch10Background="var(--pitch10-background, var(--pitch-background, #444))",Jt.pitch11Background="var(--pitch11-background, var(--pitch-background, #444))",Jt.volumeIcon="var(--volume-icon, #777777)",Jt.octaveScrollbar="var(--octave-scrollbar, #444444)",Jt.scrollbarOctave="var(--scrollbar-octave, #886644)",Jt.channelBox="var(--channel-box, #444444)",Jt.blackPianoKey="var(--black-piano-key, #000)",Jt.whitePianoKey="var(--white-piano-key, #fff)",Jt.pitchChannels=h([{name:"pitch1",secondaryChannel:"var(--pitch1-secondary-channel)",primaryChannel:"var(--pitch1-primary-channel)",secondaryNote:"var(--pitch1-secondary-note)",primaryNote:"var(--pitch1-primary-note)"},{name:"pitch2",secondaryChannel:"var(--pitch2-secondary-channel)",primaryChannel:"var(--pitch2-primary-channel)",secondaryNote:"var(--pitch2-secondary-note)",primaryNote:"var(--pitch2-primary-note)"},{name:"pitch3",secondaryChannel:"var(--pitch3-secondary-channel)",primaryChannel:"var(--pitch3-primary-channel)",secondaryNote:"var(--pitch3-secondary-note)",primaryNote:"var(--pitch3-primary-note)"},{name:"pitch4",secondaryChannel:"var(--pitch4-secondary-channel)",primaryChannel:"var(--pitch4-primary-channel)",secondaryNote:"var(--pitch4-secondary-note)",primaryNote:"var(--pitch4-primary-note)"},{name:"pitch5",secondaryChannel:"var(--pitch5-secondary-channel)",primaryChannel:"var(--pitch5-primary-channel)",secondaryNote:"var(--pitch5-secondary-note)",primaryNote:"var(--pitch5-primary-note)"},{name:"pitch6",secondaryChannel:"var(--pitch6-secondary-channel)",primaryChannel:"var(--pitch6-primary-channel)",secondaryNote:"var(--pitch6-secondary-note)",primaryNote:"var(--pitch6-primary-note)"},{name:"pitch7",secondaryChannel:"var(--pitch7-secondary-channel)",primaryChannel:"var(--pitch7-primary-channel)",secondaryNote:"var(--pitch7-secondary-note)",primaryNote:"var(--pitch7-primary-note)"},{name:"pitch8",secondaryChannel:"var(--pitch8-secondary-channel)",primaryChannel:"var(--pitch8-primary-channel)",secondaryNote:"var(--pitch8-secondary-note)",primaryNote:"var(--pitch8-primary-note)"},{name:"pitch9",secondaryChannel:"var(--pitch9-secondary-channel)",primaryChannel:"var(--pitch9-primary-channel)",secondaryNote:"var(--pitch9-secondary-note)",primaryNote:"var(--pitch9-primary-note)"},{name:"pitch10",secondaryChannel:"var(--pitch10-secondary-channel)",primaryChannel:"var(--pitch10-primary-channel)",secondaryNote:"var(--pitch10-secondary-note)",primaryNote:"var(--pitch10-primary-note)"},{name:"pitch11",secondaryChannel:"var(--pitch11-secondary-channel)",primaryChannel:"var(--pitch11-primary-channel)",secondaryNote:"var(--pitch11-secondary-note)",primaryNote:"var(--pitch11-primary-note)"},{name:"pitch12",secondaryChannel:"var(--pitch12-secondary-channel)",primaryChannel:"var(--pitch12-primary-channel)",secondaryNote:"var(--pitch12-secondary-note)",primaryNote:"var(--pitch12-primary-note)"}]),Jt.noiseChannels=h([{name:"noise1",secondaryChannel:"var(--noise1-secondary-channel)",primaryChannel:"var(--noise1-primary-channel)",secondaryNote:"var(--noise1-secondary-note)",primaryNote:"var(--noise1-primary-note)"},{name:"noise2",secondaryChannel:"var(--noise2-secondary-channel)",primaryChannel:"var(--noise2-primary-channel)",secondaryNote:"var(--noise2-secondary-note)",primaryNote:"var(--noise2-primary-note)"},{name:"noise3",secondaryChannel:"var(--noise3-secondary-channel)",primaryChannel:"var(--noise3-primary-channel)",secondaryNote:"var(--noise3-secondary-note)",primaryNote:"var(--noise3-primary-note)"},{name:"noise4",secondaryChannel:"var(--noise4-secondary-channel)",primaryChannel:"var(--noise4-primary-channel)",secondaryNote:"var(--noise4-secondary-note)",primaryNote:"var(--noise4-primary-note)"}]),Jt.dt=document.head.appendChild(m.style({type:"text/css"}));const{div:Ht}=m;function Qt(t){return t.toFixed(2).replace(/\.?0*$/,"")}class Xt{constructor(){this.valid=!1,this.prevNote=null,this.curNote=null,this.nextNote=null,this.pitch=0,this.pitchIndex=-1,this.curIndex=0,this.start=0,this.end=0,this.part=0,this.notePart=0,this.nearPinIndex=0,this.pins=[]}}class $t{constructor(t){this.Y=t,this.bt=u.pattern({id:"patternEditorNoteBackground",x:"0",y:"0",width:"64",height:"156",patternUnits:"userSpaceOnUse"}),this.ut=u.pattern({id:"patternEditorDrumBackground",x:"0",y:"0",width:"64",height:"40",patternUnits:"userSpaceOnUse"}),this.gt=u.rect({x:"0",y:"0",width:"512",height:"481","pointer-events":"none",fill:"url(#patternEditorNoteBackground)"}),this.wt=u.svg(),this.xt=u.rect({id:"",x:"0",y:"0",width:"4",height:"481",fill:"white","pointer-events":"none"}),this.vt=u.path({fill:"none",stroke:"white","stroke-width":"2","pointer-events":"none"}),this.kt=u.svg({style:"touch-action: none; position: absolute;",width:"100%",height:"100%",viewBox:"0 0 512 481",preserveAspectRatio:"none"},[u.defs(void 0,[this.bt,this.ut]),this.gt,this.wt,this.vt,this.xt]),this.container=Ht({style:"height: 100%; overflow:hidden; position: relative; flex-grow: 1;"},[this.kt]),this.Mt=13,this.Lt=40,this.Ct=[],this.At=u.rect(),this.St=[[A(0,0,3),A(0,2,3)],[A(0,0,3),A(0,2,3)],[A(0,0,3),A(0,2,3)],[A(0,0,3),A(0,2,0)]],this.Bt=481,this.Rt=0,this.Et=0,this.Ft=!1,this.Pt=!1,this.Nt=!1,this.It=!1,this.Dt=!1,this.Tt=[],this.Zt=0,this.jt=0,this.zt=0,this.Ot=0,this.Gt=0,this.Ut=0,this.Vt=0,this.Yt=!1,this.Wt=null,this.Jt=new Xt,this.ft=null,this.Ht=0,this.Qt=0,this.Xt=-1,this.$t=-1,this.Kt=!1,this._t=!1,this.qt=!1,this.tn=!1,this.nn=1,this.en=-1,this.sn=-1,this.hn=-1,this.an=-1,this.resetCopiedPins=()=>{const t=this.rn();this.Tt.length=this.Y.song.getChannelCount();for(let n=0;n<this.Y.song.pitchChannelCount;n++)this.Tt[n]=[A(0,0,3),A(0,t,3)];for(let n=this.Y.song.pitchChannelCount;n<this.Y.song.getChannelCount();n++)this.Tt[n]=[A(0,0,3),A(0,t,0)]},this.cn=t=>{const n=Math.floor(this.Y.synth.playhead);if(this.Y.synth.playing&&(null!=this.ft&&this.Y.song.getPattern(this.Y.channel,Math.floor(this.Y.synth.playhead))==this.ft||Math.floor(this.Y.synth.playhead)==this.Y.bar)){this.xt.setAttribute("visibility","visible");const t=this.Y.synth.playhead-n;Math.abs(t-this.Ht)>.1?this.Ht=t:this.Ht+=.2*(t-this.Ht),this.xt.setAttribute("x",""+Qt(this.Ht*this.ln-2))}else this.xt.setAttribute("visibility","hidden");this.Y.synth.playing&&this.Y.autoFollow&&this.an!=n&&(new K(this.Y,this.Y.channel,n),this.Y.notifier.notifyWatchers()),this.an=n,window.requestAnimationFrame(this.cn)},this.fn=t=>{this.Pt||(this.Pt=!0,this.Dt=!1)},this.pn=t=>{this.Pt&&(this.Pt=!1)},this.dn=t=>{t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=((t.clientX||t.pageX)-n.left)*this.ln/(n.right-n.left),this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Rt)&&(this.Rt=0),isNaN(this.Et)&&(this.Et=0),this.Dt=!1,this.yn()},this.bn=t=>{t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=(t.touches[0].clientX-n.left)*this.ln/(n.right-n.left),this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Rt)&&(this.Rt=0),isNaN(this.Et)&&(this.Et=0),this.Dt=!0,this.yn()},this.mn=t=>{const n=this.kt.getBoundingClientRect();this.Rt=((t.clientX||t.pageX)-n.left)*this.ln/(n.right-n.left),this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Rt)&&(this.Rt=0),isNaN(this.Et)&&(this.Et=0),this.Dt=!1,this.un()},this.gn=t=>{if(!this.Ft)return;t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=(t.touches[0].clientX-n.left)*this.ln/(n.right-n.left),this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Rt)&&(this.Rt=0),isNaN(this.Et)&&(this.Et=0),this.un()},this.wn=t=>{if(!this.Jt.valid)return;const n=this.Y.lastChangeWas(this.Wt);if(this.Nt&&n)null!=this.Wt&&(this.Y.record(this.Wt),this.Wt=null);else if(this.Ft&&n)if(null==this.Jt.curNote){const t=S(this.Jt.pitch,this.Jt.start,this.Jt.end,3,this.Y.song.getChannelIsDrum(this.Y.channel));t.pins=[];for(const n of this.Jt.pins)t.pins.push(A(0,n.time,n.volume));const n=new j;n.append(new Mt(this.Y));const e=this.Y.getCurrentPattern();if(null==e)throw new Error;n.append(new jt(this.Y,e,t,this.Jt.curIndex)),this.Y.record(n)}else{if(null==this.ft)throw new Error;if(-1==this.Jt.pitchIndex){const t=new j;4==this.Jt.curNote.pitches.length&&t.append(new ut(this.Y,this.Jt.curNote,this.Jt.curNote.pitches[0],0,!0)),t.append(new ut(this.Y,this.Jt.curNote,this.Jt.pitch,this.Jt.curNote.pitches.length)),this.Y.record(t),this.xn(this.Jt.curNote)}else 1==this.Jt.curNote.pitches.length?this.Y.record(new jt(this.Y,this.ft,this.Jt.curNote,this.Jt.curIndex,!0)):this.Y.record(new ut(this.Y,this.Jt.curNote,this.Jt.pitch,this.Jt.curNote.pitches.indexOf(this.Jt.pitch),!0))}this.Ft=!1,this.Nt=!1,this.vn(),this.kn()},this.Mn=()=>{this.ln=this.Y.showLetters?this.Y.showScrollBar?460:480:this.Y.showScrollBar?492:512,this.ft=this.Y.getCurrentPattern(),this.Ln=this.ln/(this.Y.song.beatsPerBar*this.Y.song.partsPerBeat),this.Cn=this.Y.song.getChannelIsDrum(this.Y.channel)?this.Lt:this.Mt,this.An=this.Y.song.getChannelIsDrum(this.Y.channel)?s.drumCount:s.pitchCount,this.Qt=12*this.Y.song.channels[this.Y.channel].octave,this.en==this.Y.song.partsPerBeat&&this.sn==this.Y.song.pitchChannelCount&&this.hn==this.Y.song.drumChannelCount||(this.en=this.Y.song.partsPerBeat,this.sn=this.Y.song.pitchChannelCount,this.hn=this.Y.song.drumChannelCount,this.resetCopiedPins()),this.Sn=this.Tt[this.Y.channel],this.Xt!=this.ln&&(this.Xt=this.ln,this.kt.setAttribute("viewBox","0 0 "+this.ln+" 481"),this.gt.setAttribute("width",""+this.ln));const t=this.ln/this.Y.song.beatsPerBar;if(this.$t!=t){this.$t=t,this.bt.setAttribute("width",""+t),this.ut.setAttribute("width",""+t),this.At.setAttribute("width",""+(t-2));for(let n=0;n<12;n++)this.Ct[n].setAttribute("width",""+(t-2))}this.Ft||this.vn(),this.wt=function(t){const n=t.cloneNode(!1);return t.parentNode.replaceChild(n,t),n}(this.wt),this.kn();for(let t=0;t<12;t++)this.Ct[t].style.visibility=s.scaleFlags[this.Y.song.scale][t]?"visible":"hidden";if(this.Y.song.getChannelIsDrum(this.Y.channel)?this.tn||(this.tn=!0,this.gt.setAttribute("fill","url(#patternEditorDrumBackground)"),this.gt.setAttribute("height",""+this.Lt*s.drumCount)):this.tn&&(this.tn=!1,this.gt.setAttribute("fill","url(#patternEditorNoteBackground)"),this.gt.setAttribute("height",""+this.Bt)),this.Y.showChannels)for(let t=this.Y.song.getChannelCount()-1;t>=0;t--){if(t==this.Y.channel)continue;if(this.Y.song.getChannelIsDrum(t)!=this.Y.song.getChannelIsDrum(this.Y.channel))continue;const n=this.Y.song.getPattern(t,this.Y.bar);if(null!=n)for(const e of n.notes)for(const n of e.pitches){const i=u.path();i.setAttribute("fill",Jt.getChannelColor(this.Y.song,t).secondaryNote),i.setAttribute("pointer-events","none"),this.Bn(i,n,e.start,e.pins,.19*this.Cn,!1,12*this.Y.song.channels[t].octave),this.wt.appendChild(i)}}if(null!=this.ft)for(const t of this.ft.notes)for(let n=0;n<t.pitches.length;n++){const e=t.pitches[n];let i=u.path();if(i.setAttribute("fill",Jt.getChannelColor(this.Y.song,this.Y.channel).secondaryChannel),i.setAttribute("pointer-events","none"),this.Bn(i,e,t.start,t.pins,this.Cn/2+1,!1,this.Qt),this.wt.appendChild(i),i=u.path(),i.setAttribute("fill",Jt.getChannelColor(this.Y.song,this.Y.channel).primaryNote),i.setAttribute("pointer-events","none"),this.Bn(i,e,t.start,t.pins,this.Cn/2+1,!0,this.Qt),this.wt.appendChild(i),t.pitches.length>1){let i=u.text();i.setAttribute("x",""+Qt(this.Ln*t.start+2)),i.setAttribute("y",""+Qt(this.Rn(e-this.Qt))),i.setAttribute("width","30"),i.setAttribute("fill","black"),i.setAttribute("text-anchor","start"),i.setAttribute("dominant-baseline","central"),i.setAttribute("pointer-events","none"),i.textContent=""+(n+1),this.wt.appendChild(i)}}};for(let t=0;t<12;t++){const n=(12-t)%12,e=u.rect();e.setAttribute("x","1"),e.setAttribute("y",""+(n*this.Mt+1)),e.setAttribute("height",""+(this.Mt-2)),e.setAttribute("fill",0==t?Jt.tonic:Jt.uiWidgetBackground),this.bt.appendChild(e),this.Ct[t]=e}this.kt.style.backgroundColor=Jt.editorBackground,this.At.setAttribute("x","1"),this.At.setAttribute("y","1"),this.At.setAttribute("height",""+(this.Lt-2)),this.At.setAttribute("fill","#444444"),this.ut.appendChild(this.At),this.Y.notifier.watch(this.Mn),this.Mn(),this.vn(),this.kn(),window.requestAnimationFrame(this.cn),this.kt.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.wn),this.kt.addEventListener("mouseover",this.fn),this.kt.addEventListener("mouseout",this.pn),this.kt.addEventListener("touchstart",this.bn),this.kt.addEventListener("touchmove",this.gn),this.kt.addEventListener("touchend",this.wn),this.kt.addEventListener("touchcancel",this.wn),this.resetCopiedPins()}rn(){return this.Y.song.partsPerBeat%3==0?this.Y.song.partsPerBeat/3:this.Y.song.partsPerBeat%2==0?this.Y.song.partsPerBeat/2:this.Y.song.partsPerBeat}vn(){if(this.Jt=new Xt,this.Rt<0||this.Rt>this.ln||this.Et<0||this.Et>this.Bt)return;if(this.Jt.part=Math.floor(Math.max(0,Math.min(this.Y.song.beatsPerBar*this.Y.song.partsPerBeat-1,this.Rt/this.Ln))),null!=this.ft)for(const t of this.ft.notes)if(t.end<=this.Jt.part)this.Jt.prevNote=t,this.Jt.curIndex++;else if(t.start<=this.Jt.part&&t.end>this.Jt.part)this.Jt.curNote=t;else if(t.start>this.Jt.part){this.Jt.nextNote=t;break}let t=this.En(this.Et);if(null!=this.Jt.curNote){this.Jt.start=this.Jt.curNote.start,this.Jt.end=this.Jt.curNote.end,this.Jt.pins=this.Jt.curNote.pins;let n,e=0,i=0,h=this.Jt.curNote.pins[0];for(let t=1;t<this.Jt.curNote.pins.length;t++){n=h,h=this.Jt.curNote.pins[t];const s=this.Ln*(this.Jt.curNote.start+n.time),a=this.Ln*(this.Jt.curNote.start+h.time);if(this.Rt>a)continue;if(this.Rt<s)throw new Error;const o=(this.Rt-s)/(a-s),r=Math.sqrt(1/Math.sqrt(4)-Math.pow(o-.5,2))-.5,c=Math.abs(h.interval-n.interval);e=n.interval*(1-o)+h.interval*o,i=r*c+1;break}let a=Number.MAX_VALUE,o=-Number.MAX_VALUE,r=Number.MAX_VALUE;for(const t of this.Jt.curNote.pins){a>t.interval&&(a=t.interval),o<t.interval&&(o=t.interval);const n=Math.abs(this.Jt.curNote.start+t.time-this.Rt/this.Ln);r>n&&(r=n,this.Jt.nearPinIndex=this.Jt.curNote.pins.indexOf(t))}if(t-=e,this.Jt.pitch=this.Fn(t,-a,(this.Y.song.getChannelIsDrum(this.Y.channel)?s.drumCount-1:s.maxPitch)-o),3!=this.Y.channel){let n=i;for(let e=0;e<this.Jt.curNote.pitches.length;e++){const i=Math.abs(this.Jt.curNote.pitches[e]-t+.5);i>n||(n=i,this.Jt.pitch=this.Jt.curNote.pitches[e])}}for(let t=0;t<this.Jt.curNote.pitches.length;t++)if(this.Jt.curNote.pitches[t]==this.Jt.pitch){this.Jt.pitchIndex=t;break}}else{this.Jt.pitch=this.Fn(t,0,s.maxPitch);const n=this.Sn[this.Sn.length-1].time,e=Math.floor(this.Jt.part/this.Y.song.partsPerBeat),i=this.rn(),h=this.Jt.part%this.Y.song.partsPerBeat;if(1==n)this.Jt.start=this.Jt.part;else if(n>this.Y.song.partsPerBeat)this.Jt.start=e*this.Y.song.partsPerBeat;else if(n==this.Y.song.partsPerBeat)this.Jt.start=e*this.Y.song.partsPerBeat,i<this.Y.song.partsPerBeat&&h>i&&(this.Jt.start+=Math.floor(h/i)*i);else{this.Jt.start=e*this.Y.song.partsPerBeat;let t=this.Y.song.partsPerBeat%n==0?n:Math.min(n,i);for(;t<i&&this.Y.song.partsPerBeat%t!=0;)t++;this.Jt.start+=Math.floor(h/t)*t}this.Jt.end=this.Jt.start+n;let a=0,o=this.Y.song.beatsPerBar*this.Y.song.partsPerBeat;if(null!=this.Jt.prevNote&&(a=this.Jt.prevNote.end),null!=this.Jt.nextNote&&(o=this.Jt.nextNote.start),this.Jt.start<a?(this.Jt.start=a,this.Jt.end=this.Jt.start+n,this.Jt.end>o&&(this.Jt.end=o)):this.Jt.end>o&&(this.Jt.end=o,this.Jt.start=this.Jt.end-n,this.Jt.start<a&&(this.Jt.start=a)),this.Jt.end-this.Jt.start==n)this.Jt.pins=this.Sn;else{this.Jt.pins=[];for(const t of this.Sn){if(!(t.time<=this.Jt.end-this.Jt.start)){this.Jt.pins.push(A(0,this.Jt.end-this.Jt.start,t.volume));break}if(this.Jt.pins.push(A(0,t.time,t.volume)),t.time==this.Jt.end-this.Jt.start)break}}}this.Jt.valid=!0}En(t){return Math.max(0,Math.min(this.An-1,this.An-t/this.Cn))+this.Qt}Fn(t,n,e){t<n&&(t=n),t>e&&(t=e);const i=s.scaleFlags[this.Y.song.scale];if(i[Math.floor(t)%12]||this.Y.song.getChannelIsDrum(this.Y.channel))return Math.floor(t);{let s=Math.floor(t)+1,h=Math.floor(t)-1;for(;!i[s%12];)s++;for(;!i[h%12];)h--;if(s>e)return h<n?n:h;if(h<n)return s;let a=s,o=h+1;return s%12!=0&&s%12!=7||(a-=.5),h%12!=0&&h%12!=7||(o+=.5),t-o>a-t?s:h}}xn(t){this.Sn=[];for(const n of t.pins)this.Sn.push(A(0,n.time,n.volume));for(let t=1;t<this.Sn.length-1;)this.Sn[t-1].volume==this.Sn[t].volume&&this.Sn[t].volume==this.Sn[t+1].volume?this.Sn.splice(t,1):t++;this.Tt[this.Y.channel]=this.Sn}yn(){this.Ft=!0,this.Zt=this.Rt,this.jt=this.Et,this.zt=this.Rt,this.Ot=this.Et,this.vn(),this.kn(),this.Wt=new j,this.Y.setProspectiveChange(this.Wt)}un(){let t,n;const e=this.Y.lastChangeWas(this.Wt);if(this.Ft&&this.Jt.valid&&e){if(!this.Nt){const t=this.Rt-this.Zt,n=this.Et-this.jt;Math.sqrt(t*t+n*n)>5&&(this.Nt=!0,this.It=Math.abs(t)>=Math.abs(n))}if(this.Nt){null!=this.Wt&&this.Wt.undo();const e=Math.floor(this.Rt/this.Ln),i=new j;if(this.Wt=i,this.Y.setProspectiveChange(this.Wt),null==this.Jt.curNote){let s,h;e<this.Jt.start?(s=!0,h=this.Jt.start-e):(s=!1,h=e-this.Jt.start+1);let a=1;for(let t=0;t<=this.Y.song.beatsPerBar*this.Y.song.partsPerBeat;t++){if(t>=5&&t%this.Y.song.partsPerBeat!=0&&t!=3*this.Y.song.partsPerBeat/2&&t!=4*this.Y.song.partsPerBeat/3&&t!=5*this.Y.song.partsPerBeat/3)continue;const n=t;if(n==h){a=n;break}if(n<h&&(a=n),n>h){a<h-1&&(a=n);break}}if(s?(n=this.Jt.start,t=n-a):(t=this.Jt.start,n=t+a),t<0&&(t=0),n>this.Y.song.beatsPerBar*this.Y.song.partsPerBeat&&(n=this.Y.song.beatsPerBar*this.Y.song.partsPerBeat),t<n){i.append(new Mt(this.Y));const e=this.Y.getCurrentPattern();if(null==e)throw new Error;let h;for(i.append(new Ot(this.Y,e,t,n)),h=0;h<e.notes.length&&!(e.notes[h].start>=n);h++);const a=S(this.Jt.pitch,t,n,3,this.Y.song.getChannelIsDrum(this.Y.channel));i.append(new jt(this.Y,e,a,h)),this.xn(a),this.Gt=s?t:n,this.Ut=this.Jt.pitch,this.Vt=a.pins[s?0:1].volume,this.Yt=!0}this.ft=this.Y.getCurrentPattern()}else if(this.It){const e=Math.round((this.Rt-this.Zt)/this.Ln),s=this.Jt.curNote.pins[this.Jt.nearPinIndex];let h=this.Jt.curNote.start+s.time+e;if(h<0&&(h=0),h>this.Y.song.beatsPerBar*this.Y.song.partsPerBeat&&(h=this.Y.song.beatsPerBar*this.Y.song.partsPerBeat),null==this.ft)throw new Error;if(h<=this.Jt.curNote.start&&this.Jt.nearPinIndex==this.Jt.curNote.pins.length-1||h>=this.Jt.curNote.end&&0==this.Jt.nearPinIndex)i.append(new jt(this.Y,this.ft,this.Jt.curNote,this.Jt.curIndex,!0)),this.Yt=!1;else{if(t=Math.min(this.Jt.curNote.start,h),n=Math.max(this.Jt.curNote.end,h),this.Gt=h,this.Ut=this.Jt.curNote.pitches[-1==this.Jt.pitchIndex?0:this.Jt.pitchIndex]+this.Jt.curNote.pins[this.Jt.nearPinIndex].interval,this.Vt=this.Jt.curNote.pins[this.Jt.nearPinIndex].volume,this.Yt=!0,null==this.ft)throw new Error;i.append(new Ot(this.Y,this.ft,t,n,this.Jt.curNote)),i.append(new Lt(this.Y,this.Jt.curNote,this.Jt.nearPinIndex,h)),this.xn(this.Jt.curNote)}}else if(-1==this.Jt.pitchIndex){const t=Math.round(Math.max(this.Jt.curNote.start,Math.min(this.Jt.curNote.end,this.Rt/this.Ln)))-this.Jt.curNote.start;let n,e=this.Jt.curNote.pins[0],h=0,a=0;for(let i=1;i<this.Jt.curNote.pins.length;i++){if(n=e,e=this.Jt.curNote.pins[i],t>e.time)continue;if(t<n.time)throw new Error;const o=(t-n.time)/(e.time-n.time);h=Math.round(n.volume*(1-o)+e.volume*o+(this.jt-this.Et)/20),h<0&&(h=0),h>3&&(h=3),a=this.Fn(n.interval*(1-o)+e.interval*o+this.Jt.curNote.pitches[0],0,s.maxPitch)-this.Jt.curNote.pitches[0];break}this.Gt=this.Jt.curNote.start+t,this.Ut=this.Jt.curNote.pitches[-1==this.Jt.pitchIndex?0:this.Jt.pitchIndex]+a,this.Vt=h,this.Yt=!0,i.append(new Yt(this.Y,this.Jt.curNote,t,h,a)),this.xn(this.Jt.curNote)}else{if(this.Vt=this.Jt.curNote.pins[this.Jt.nearPinIndex].volume,null==this.ft)throw new Error;let t,n;this.Rt>=this.Zt?(t=this.Jt.part,n=e+1):(t=this.Jt.part+1,n=e),n<0&&(n=0),n>this.Y.song.beatsPerBar*this.Y.song.partsPerBeat&&(n=this.Y.song.beatsPerBar*this.Y.song.partsPerBeat),n>this.Jt.curNote.end&&i.append(new Ot(this.Y,this.ft,this.Jt.curNote.start,n,this.Jt.curNote)),n<this.Jt.curNote.start&&i.append(new Ot(this.Y,this.ft,n,this.Jt.curNote.end,this.Jt.curNote));let h=Number.MAX_VALUE,a=-Number.MAX_VALUE;for(const t of this.Jt.curNote.pitches)h>t&&(h=t),a<t&&(a=t);h-=this.Jt.curNote.pitches[this.Jt.pitchIndex],a-=this.Jt.curNote.pitches[this.Jt.pitchIndex];const o=this.Fn(this.En(this.Et),-h,(this.Y.song.getChannelIsDrum(this.Y.channel)?s.drumCount-1:s.maxPitch)-a);i.append(new Ct(this.Y,this.Jt.curNote,t,n,o,this.Jt.pitchIndex)),this.xn(this.Jt.curNote),this.Gt=n,this.Ut=o,this.Yt=!0}}this.zt=this.Rt,this.Ot=this.Et}else this.vn(),this.kn()}kn(){if(this.Dt)if(this.Ft&&this.Jt.valid&&this.Nt&&this.Yt){this.vt.setAttribute("visibility","visible");const t=this.Ln*this.Gt,n=this.Rn(this.Ut-this.Qt),e=this.Cn/2,i=80,s=60;let h="";h+="M "+Qt(t)+" "+Qt(n-e*(this.Vt/3))+" ",h+="L "+Qt(t)+" "+Qt(n-e*(this.Vt/3)-s)+" ",h+="M "+Qt(t)+" "+Qt(n+e*(this.Vt/3))+" ",h+="L "+Qt(t)+" "+Qt(n+e*(this.Vt/3)+s)+" ",h+="M "+Qt(t)+" "+Qt(n-e*(this.Vt/3))+" ",h+="L "+Qt(t+i)+" "+Qt(n-e*(this.Vt/3))+" ",h+="M "+Qt(t)+" "+Qt(n+e*(this.Vt/3))+" ",h+="L "+Qt(t+i)+" "+Qt(n+e*(this.Vt/3))+" ",h+="M "+Qt(t)+" "+Qt(n-e*(this.Vt/3))+" ",h+="L "+Qt(t-i)+" "+Qt(n-e*(this.Vt/3))+" ",h+="M "+Qt(t)+" "+Qt(n+e*(this.Vt/3))+" ",h+="L "+Qt(t-i)+" "+Qt(n+e*(this.Vt/3))+" ",this.vt.setAttribute("d",h)}else this.vt.setAttribute("visibility","hidden");else this.Pt&&!this.Ft&&this.Jt.valid?(this.vt.setAttribute("visibility","visible"),this.Bn(this.vt,this.Jt.pitch,this.Jt.start,this.Jt.pins,this.Cn/2+1,!0,this.Qt)):this.vt.setAttribute("visibility","hidden")}render(){0==this.Y.showMore?(this.Kt!=this.Y.showFifth&&(this.Kt=this.Y.showFifth,this.Ct[7].setAttribute("fill",this.Y.showFifth?Jt.fifthNote:Jt.pitchBackground)),1==this.qt&&(this.qt=!1),this._t!=this.Y.showMore&&(this.Ct[0].setAttribute("fill",Jt.tonic),this.Ct[1].setAttribute("fill",this.Y.showMore?Jt.pitch1Background:Jt.pitchBackground),this.Ct[2].setAttribute("fill",this.Y.showMore?Jt.pitch2Background:Jt.pitchBackground),this.Ct[3].setAttribute("fill",this.Y.showMore?Jt.pitch3Background:Jt.pitchBackground),this.Ct[4].setAttribute("fill",this.Y.showMore?Jt.pitch4Background:Jt.pitchBackground),this.Ct[5].setAttribute("fill",this.Y.showMore?Jt.pitch5Background:Jt.pitchBackground),this.Ct[6].setAttribute("fill",this.Y.showMore?Jt.pitch6Background:Jt.pitchBackground),this.Ct[7].setAttribute("fill",this.Y.showFifth?Jt.fifthNote:Jt.pitchBackground),this.Ct[8].setAttribute("fill",this.Y.showMore?Jt.pitch8Background:Jt.pitchBackground),this.Ct[9].setAttribute("fill",this.Y.showMore?Jt.pitch9Background:Jt.pitchBackground),this.Ct[10].setAttribute("fill",this.Y.showMore?Jt.pitch10Background:Jt.pitchBackground),this.Ct[11].setAttribute("fill",this.Y.showMore?Jt.pitch11Background:Jt.pitchBackground),this._t=this.Y.showMore,console.log("this._renderedACS (acs disabled): "+this._t)),this.nn=-1):0==Jt.usesPianoScheme?(this._t==this.Y.showMore&&1!=this.qt||(this.Ct[0].setAttribute("fill",(this.Y.showMore,Jt.tonic)),this.Ct[1].setAttribute("fill",this.Y.showMore?Jt.pitch1Background:Jt.pitchBackground),this.Ct[2].setAttribute("fill",this.Y.showMore?Jt.pitch2Background:Jt.pitchBackground),this.Ct[3].setAttribute("fill",this.Y.showMore?Jt.pitch3Background:Jt.pitchBackground),this.Ct[4].setAttribute("fill",this.Y.showMore?Jt.pitch4Background:Jt.pitchBackground),this.Ct[5].setAttribute("fill",this.Y.showMore?Jt.pitch5Background:Jt.pitchBackground),this.Ct[6].setAttribute("fill",this.Y.showMore?Jt.pitch6Background:Jt.pitchBackground),this.Ct[7].setAttribute("fill",this.Y.showFifth?Jt.fifthNote:Jt.pitchBackground),this.Ct[8].setAttribute("fill",this.Y.showMore?Jt.pitch8Background:Jt.pitchBackground),this.Ct[9].setAttribute("fill",this.Y.showMore?Jt.pitch9Background:Jt.pitchBackground),this.Ct[10].setAttribute("fill",this.Y.showMore?Jt.pitch10Background:Jt.pitchBackground),this.Ct[11].setAttribute("fill",this.Y.showMore?Jt.pitch11Background:Jt.pitchBackground),this._t=this.Y.showMore,console.log("this._renderedACS (acs enabled): "+this._t)),1==this.qt&&(this.qt=!1,this.nn=-1,console.log("this._renderedACS (disabiling piano): "+this._t))):this.nn!=this.Y.song.key&&(this.nn=this.Y.song.key,this.qt=!0,console.log("piano key"+this.nn),0==this.nn||2==this.nn||4==this.nn||6==this.nn||7==this.nn||9==this.nn||11==this.nn?this.Ct[0].setAttribute("fill",this.Y.showMore?"var(--white-tonic, var(--pitch-white-key, var(--pitch-background)))":Jt.pitchBackground):this.Ct[0].setAttribute("fill",this.Y.showMore?"var(--black-tonic, var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||1==this.nn||3==this.nn||5==this.nn||7==this.nn||8==this.nn||10==this.nn?this.Ct[1].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[1].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),1==this.nn||2==this.nn||4==this.nn||6==this.nn||8==this.nn||9==this.nn||11==this.nn?this.Ct[2].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[2].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||2==this.nn||3==this.nn||5==this.nn||7==this.nn||9==this.nn||10==this.nn?this.Ct[3].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[3].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),1==this.nn||3==this.nn||4==this.nn||6==this.nn||8==this.nn||10==this.nn||11==this.nn?this.Ct[4].setAttribute("fill",this.Y.showMore?" var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[4].setAttribute("fill",this.Y.showMore?" var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||2==this.nn||4==this.nn||5==this.nn||7==this.nn||9==this.nn||11==this.nn?this.Ct[5].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[5].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||1==this.nn||3==this.nn||5==this.nn||6==this.nn||8==this.nn||10==this.nn?this.Ct[6].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[6].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),1==this.nn||2==this.nn||4==this.nn||6==this.nn||7==this.nn||9==this.nn||11==this.nn?1==this.Y.showFifth?this.Ct[7].setAttribute("fill",this.Y.showMore?"var(--white-fifth-note, var(--pitch-white-key, var(--pitch-background)))":Jt.pitchBackground):this.Ct[7].setAttribute("fill",this.Y.showMore?" var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):1==this.Y.showFifth?this.Ct[7].setAttribute("fill",this.Y.showMore?"var(--black-fifth-note, var(--pitch-black-key, var(--pitch-background)))":Jt.pitchBackground):this.Ct[7].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||2==this.nn||3==this.nn||5==this.nn||7==this.nn||8==this.nn||10==this.nn?this.Ct[8].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[8].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),1==this.nn||3==this.nn||4==this.nn||6==this.nn||8==this.nn||9==this.nn||11==this.nn?this.Ct[9].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[9].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),0==this.nn||2==this.nn||4==this.nn||5==this.nn||7==this.nn||9==this.nn||10==this.nn?this.Ct[10].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[10].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),1==this.nn||3==this.nn||5==this.nn||6==this.nn||8==this.nn||10==this.nn||11==this.nn?this.Ct[11].setAttribute("fill",this.Y.showMore?"var(--pitch-white-key, var(--pitch-background))":Jt.pitchBackground):this.Ct[11].setAttribute("fill",this.Y.showMore?"var(--pitch-black-key, var(--pitch-background))":Jt.pitchBackground),this._t!=this.Y.showMore&&(this._t=this.Y.showMore,console.log("this._renderedACS (in piano): "+this._t)))}Bn(t,n,e,i,s,h,a){let o=i[0],r="M "+Qt(this.Ln*(e+o.time)+1)+" "+Qt(this.Rn(n-a)+s*(h?o.volume/3:1))+" ";for(let t=1;t<i.length;t++){let c=o;o=i[t];let l=this.Ln*(e+c.time)+(1==t?1:0),f=this.Ln*(e+o.time)-(t==i.length-1?1:0),p=this.Rn(n+c.interval-a),d=this.Rn(n+o.interval-a),y=h?c.volume/3:1,b=h?o.volume/3:1;r+="L "+Qt(l)+" "+Qt(p-s*y)+" ",c.interval>o.interval&&(r+="L "+Qt(l+1)+" "+Qt(p-s*y)+" "),c.interval<o.interval&&(r+="L "+Qt(f-1)+" "+Qt(d-s*b)+" "),r+="L "+Qt(f)+" "+Qt(d-s*b)+" "}for(let t=i.length-2;t>=0;t--){let c=o;o=i[t];let l=this.Ln*(e+c.time)-(t==i.length-2?1:0),f=this.Ln*(e+o.time)+(0==t?1:0),p=this.Rn(n+c.interval-a),d=this.Rn(n+o.interval-a),y=h?c.volume/3:1,b=h?o.volume/3:1;r+="L "+Qt(l)+" "+Qt(p+s*y)+" ",c.interval<o.interval&&(r+="L "+Qt(l-1)+" "+Qt(p+s*y)+" "),c.interval>o.interval&&(r+="L "+Qt(f+1)+" "+Qt(d+s*b)+" "),r+="L "+Qt(f)+" "+Qt(d+s*b)+" "}r+="z",t.setAttribute("d",r)}Rn(t){return this.Cn*(this.An-t-.5)}}const{select:Kt,div:_t,option:qt}=m;class tn{constructor(t,n,e,i,s){this.Pn=u.text({x:16,y:23,"font-family":"sans-serif","font-size":20,"text-anchor":"middle","font-weight":"bold",fill:Jt.invertedText},"1"),this.Nn=u.rect({width:30,height:27,x:1,y:1}),this.In=u.rect({width:6,height:3,x:24,y:5}),this.Dn=u.rect({width:6,height:18,x:24,y:5}),this.container=u.svg(this.Nn,this.Dn,this.In,this.Pn),this.Tn=1,this.Zn=!0,this.jn=!1,this.zn="",this.container.setAttribute("x",""+32*n),this.container.setAttribute("y",""+32*e),this.Nn.setAttribute("fill","#444444"),this.In.setAttribute("fill","#444444"),this.Dn.setAttribute("fill","#444444"),this.Pn.setAttribute("fill",i)}setSquashed(t,n){t?(this.container.setAttribute("y",""+27*n),this.Nn.setAttribute("height","25"),this.In.setAttribute("height","2.7"),this.Dn.setAttribute("height","18"),this.Pn.setAttribute("y","21")):(this.container.setAttribute("y",""+32*n),this.Nn.setAttribute("height","30"),this.In.setAttribute("height","3"),this.Dn.setAttribute("height","18"),this.Pn.setAttribute("y","23"))}setIndex(t,n,e,i,s,h,a,o,r){2==r?(this.In.setAttribute("height",""+(18-2*h)),this.In.setAttribute("y",""+(5+2*h))):(this.In.setAttribute("height",""+(18-3.6*h)),this.In.setAttribute("y",""+(5+3.6*h))),this.Tn!=t&&(this.jn||0==t==(0==this.Tn)||(this.Nn.setAttribute("fill",0==t?Jt.editorBackground:Jt.channelBox),this.In.setAttribute("fill",0==t?Jt.editorBackground:Jt.channelBox),this.Dn.setAttribute("fill",0==t?Jt.editorBackground:Jt.channelBox)),this.Tn=t,this.Pn.innerHTML=String(t)),this.Zn==n&&this.zn==s||(this.Zn=n,e?this.Pn.setAttribute("fill",Jt.invertedText):this.Pn.setAttribute("fill",s)),this.jn==e&&this.zn==s||(this.jn=e,e?(this.Nn.setAttribute("fill",s),this.In.setAttribute("fill",s),this.Dn.setAttribute("fill",s),this.Pn.setAttribute("fill",Jt.invertedText)):(this.Nn.setAttribute("fill",0==this.Tn?Jt.editorBackground:Jt.channelBox),this.In.setAttribute("fill",0==this.Tn?Jt.editorBackground:s),this.Dn.setAttribute("fill",0==this.Tn?Jt.editorBackground:a),this.Pn.setAttribute("fill",s))),o?(this.Pn.setAttribute("x","12"),this.In.style.visibility="visible",this.Dn.style.visibility="visible"):(this.Pn.setAttribute("x","16"),this.In.style.visibility="hidden",this.Dn.style.visibility="hidden"),this.zn=s}}class nn{constructor(t){this.Y=t,this.On=32,this.kt=u.svg({style:"position: absolute;",height:128}),this.Gn=Kt({class:"trackSelectBox",style:"width: 32px; height: 32px; background: none; border: none; appearance: none; color: transparent; position: absolute;"}),this.container=_t({style:"height: 128px; position: relative; overflow:hidden;"},[this.kt,this.Gn]),this.Un=u.g(),this.Vn=u.rect({fill:"white",x:0,y:0,width:4,height:128}),this.Yn=u.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:1,y:1,width:30,height:30}),this.Wn=u.path({fill:"black",stroke:"black","stroke-width":1,"pointer-events":"none"}),this.Jn=u.path({fill:"black",stroke:"black","stroke-width":1,"pointer-events":"none"}),this.Hn=[],this.Rt=0,this.Et=0,this.ft=null,this.Pt=!1,this.Qn="",this.Bt=128,this.Xn=32,this.$n=0,this.Kn=0,this._n=0,this.qn=-1,this.te=!1,this.ne=null,this.ee=()=>{this.ie(this.Gn.selectedIndex)},this.cn=t=>{const n=this.On*this.Y.synth.playhead-2;this.qn!=n&&(this.qn=n,this.Vn.setAttribute("x",""+n)),window.requestAnimationFrame(this.cn)},this.fn=t=>{this.Pt||(this.Pt=!0)},this.pn=t=>{this.Pt&&(this.Pt=!1)},this.dn=t=>{t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top;const e=Math.floor(Math.min(this.Y.song.getChannelCount()-1,Math.max(0,this.Et/this.Xn))),i=Math.floor(Math.min(this.Y.song.barCount-1,Math.max(0,this.Rt/this.On)));if(this.Y.channel==e&&this.Y.bar==i){const t=this.Et%this.Xn<this.Xn/2,n=this.Y.song.patternsPerChannel;this.ie((this.Y.song.channels[e].bars[i]+(t?1:n))%(n+1))}else this.se(e,i)},this.mn=t=>{const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top,this.kn()},this.he=t=>{},this.kt.appendChild(this.Un),this.kt.appendChild(this.Yn),this.kt.appendChild(this.Wn),this.kt.appendChild(this.Jn),this.kt.appendChild(this.Vn),this.kt.style.backgroundColor=Jt.editorBackground,window.requestAnimationFrame(this.cn),this.kt.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.he),this.kt.addEventListener("mouseover",this.fn),this.kt.addEventListener("mouseout",this.pn),this.Gn.addEventListener("change",this.ee)}se(t,n){new K(this.Y,t,n),this.Qn="",this.Y.forgetLastChange()}ie(t){const n=this.Y.song.channels[this.Y.channel].bars[this.Y.bar],e=this.Y.lastChangeWas(this.ne),i=e?this.ne.oldValue:n;t!=n&&(this.ne=new U(this.Y,i,t),this.Y.record(this.ne,e))}ae(t){this.Qn+=t;let n=parseInt(this.Qn);n<=this.Y.song.patternsPerChannel?this.ie(n):(this.Qn=t,n=parseInt(this.Qn),n<=this.Y.song.patternsPerChannel?this.ie(n):this.Qn="")}kn(){let t=Math.floor(Math.min(this.Y.song.getChannelCount()-1,Math.max(0,this.Et/this.Xn))),n=Math.floor(Math.min(this.Y.song.barCount-1,Math.max(0,this.Rt/this.On)));const e=window.innerWidth>700;e||(n=this.Y.bar,t=this.Y.channel);const i=n==this.Y.bar&&t==this.Y.channel;if(this.Pt&&!i?(this.Yn.setAttribute("x",""+(1+this.On*n)),this.Yn.setAttribute("y",""+(1+this.Xn*t)),this.Yn.setAttribute("height",""+(this.Xn-2)),this.Yn.style.visibility="visible"):this.Yn.style.visibility="hidden",!this.Pt&&e||!i)this.Wn.style.visibility="hidden",this.Jn.style.visibility="hidden";else{const i=this.Et%this.Xn<this.Xn/2,s=this.On*(n+.8),h=this.Xn*(t+.5),a=.1*this.Xn,o=.4*this.Xn,r=.175*this.Xn;this.Wn.setAttribute("fill",i&&e?"#fff":"#000"),this.Jn.setAttribute("fill",!i&&e?"#fff":"#000"),this.Wn.setAttribute("d",`M ${s} ${h-o} L ${s+r} ${h-a} L ${s-r} ${h-a} z`),this.Jn.setAttribute("d",`M ${s} ${h+o} L ${s+r} ${h+a} L ${s-r} ${h+a} z`),this.Wn.style.visibility="visible",this.Jn.style.visibility="visible"}this.Gn.style.left=this.On*this.Y.bar+"px",this.Gn.style.top=this.Xn*this.Y.channel+"px",this.Gn.style.height=this.Xn+"px";const s=this.Y.song.patternsPerChannel;for(let t=this._n;t<s;t++)this.Gn.appendChild(qt({value:t},t));for(let t=s;t<this._n;t++)this.Gn.removeChild(this.Gn.lastChild);this._n=s;const h=this.Y.song.channels[this.Y.channel].bars[this.Y.bar];this.Gn.selectedIndex!=h&&(this.Gn.selectedIndex=h)}render(){this.ft=this.Y.getCurrentPattern();const t=!(window.innerWidth>700)||this.Y.song.getChannelCount()>5||this.Y.song.barCount>this.Y.trackVisibleBars&&this.Y.song.getChannelCount()>3;if(this.Xn=t?27:32,this.$n!=this.Y.song.getChannelCount()){for(let n=this.$n;n<this.Y.song.getChannelCount();n++){this.Hn[n]=[];for(let e=0;e<this.Kn;e++){const i=new tn(n,e,n,Jt.getChannelColor(this.Y.song,n).secondaryChannel,this.Y.showVolumeBar);i.setSquashed(t,n),this.Un.appendChild(i.container),this.Hn[n][e]=i}}for(let t=this.Y.song.getChannelCount();t<this.$n;t++)for(let n=0;n<this.Kn;n++)this.Un.removeChild(this.Hn[t][n].container);this.Hn.length=this.Y.song.getChannelCount()}if(this.Kn<this.Y.song.barCount){for(let n=0;n<this.Y.song.getChannelCount();n++){for(let e=this.Kn;e<this.Y.song.barCount;e++){const i=new tn(n,e,n,Jt.getChannelColor(this.Y.song,n).secondaryChannel,this.Y.showVolumeBar);i.setSquashed(t,n),this.Un.appendChild(i.container),this.Hn[n][e]=i}for(let t=this.Y.song.barCount;t<this.Kn;t++)this.Un.removeChild(this.Hn[n][t].container);this.Hn[n].length=this.Y.song.barCount}this.Kn=this.Y.song.barCount;const n=32*this.Y.song.barCount;this.container.style.width=n+"px",this.kt.setAttribute("width",n+"")}if(this.te!=t)for(let n=0;n<this.Y.song.getChannelCount();n++)for(let e=0;e<this.Kn;e++)this.Hn[n][e].setSquashed(t,n);this.te==t&&this.$n==this.Y.song.getChannelCount()||(this.te=t,this.$n=this.Y.song.getChannelCount(),this.Bt=this.Y.song.getChannelCount()*this.Xn,this.kt.setAttribute("height",""+this.Bt),this.Vn.setAttribute("height",""+this.Bt),this.container.style.height=this.Bt+"px");for(let t=0;t<this.Y.song.getChannelCount();t++)for(let n=0;n<this.Kn;n++){const e=this.Y.song.getPattern(t,n),i=this.Y.song.getPatternInstrumentMute(t,n),s=this.Y.song.getPatternInstrumentVolume(t,n),h=n==this.Y.bar&&t==this.Y.channel,a=null==e||0==e.notes.length,o=1==i,r=s,c=this.Hn[t][n];n<this.Y.song.barCount?(c.setIndex(this.Y.song.channels[t].bars[n],a,h,t,!a||h||o?o&&!h?"#161616":Jt.getChannelColor(this.Y.song,t).primaryChannel:Jt.getChannelColor(this.Y.song,t).secondaryChannel,r,(!a||h||o)&&o&&!h?"#9b9b9b":Jt.getChannelColor(this.Y.song,t).secondaryChannel,this.Y.showVolumeBar,this.Y.song.mix),c.container.style.visibility="visible"):c.container.style.visibility="hidden"}this.kn()}}const{div:en}=m;class sn{constructor(t){this.Y=t,this.On=32,this.Bt=20,this.oe=0,this.re=1,this.ce=2,this.le=u.path({fill:"none",stroke:Jt.loopAccent,"stroke-width":4}),this.fe=u.path({fill:"white","pointer-events":"none"}),this.kt=u.svg({style:"touch-action: pan-y; position: absolute;",height:this.Bt},[this.le,this.fe]),this.container=en({style:"height: 20px; position: relative; margin: 5px 0;"},[this.kt]),this.pe=null,this.Jt={startBar:-1,mode:-1},this.Rt=0,this.Et=0,this.de=0,this.ye=0,this.be=!1,this.me=!1,this.Ft=!1,this.Pt=!1,this.ue=-1,this.ge=-1,this.Kn=0,this.fn=t=>{this.Pt||(this.Pt=!0,this.kn())},this.pn=t=>{this.Pt&&(this.Pt=!1,this.kn())},this.dn=t=>{t.preventDefault(),this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top,this.vn(),this.kn(),this.mn(t)},this.bn=t=>{this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=t.touches[0].clientY-n.top,this.vn(),this.kn(),this.de=t.touches[0].clientX,this.ye=t.touches[0].clientY,this.me=!1,this.be=!1},this.mn=t=>{const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top,this.un()},this.gn=t=>{if(!this.Ft)return;const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=t.touches[0].clientY-n.top,this.me||this.be||(Math.abs(t.touches[0].clientY-this.ye)>10?this.be=!0:Math.abs(t.touches[0].clientX-this.de)>10&&(this.me=!0)),this.me&&(this.un(),t.preventDefault())},this.we=t=>{t.preventDefault(),this.be||(this.un(),this.Pt=!1,this.wn(t),this.kn())},this.wn=t=>{null!=this.pe&&this.Y.record(this.pe),this.pe=null,this.Ft=!1,this.vn(),this.xe()},this.Mn=()=>{this.xe()},this.vn(),this.xe(),this.Y.notifier.watch(this.Mn),this.kt.style.backgroundColor=Jt.editorBackground,this.container.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.wn),this.container.addEventListener("mouseover",this.fn),this.container.addEventListener("mouseout",this.pn),this.container.addEventListener("touchstart",this.bn),this.container.addEventListener("touchmove",this.gn),this.container.addEventListener("touchend",this.we),this.container.addEventListener("touchcancel",this.we)}vn(){const t=this.Rt/this.On;this.Jt.startBar=t,t>this.Y.song.loopStart-.25&&t<this.Y.song.loopStart+this.Y.song.loopLength+.25?t-this.Y.song.loopStart<.5*this.Y.song.loopLength?this.Jt.mode=this.oe:this.Jt.mode=this.re:this.Jt.mode=this.ce}ve(t){let n=Math.round(t-this.Y.song.loopLength/2),e=n+this.Y.song.loopLength;return n<0&&(e-=n,n=0),e>this.Y.song.barCount&&(n-=e-this.Y.song.barCount,e=this.Y.song.barCount),{start:n,length:e-n}}un(){if(this.Ft){let t=this.Y.song.loopStart,n=this.Y.song.loopStart+this.Y.song.loopLength;null!=this.pe&&this.Y.lastChangeWas(this.pe)&&(t=this.pe.oldStart,n=t+this.pe.oldLength);const e=this.Rt/this.On;let i,s,h;if(this.Jt.mode==this.oe)i=t+Math.round(e-this.Jt.startBar),s=n,i<0&&(i=0),i>=this.Y.song.barCount&&(i=this.Y.song.barCount),i==s?i=s-1:i>s&&(h=i,i=s,s=h),this.pe=new mt(this.Y,t,n-t,i,s-i);else if(this.Jt.mode==this.re)i=t,s=n+Math.round(e-this.Jt.startBar),s<0&&(s=0),s>=this.Y.song.barCount&&(s=this.Y.song.barCount),s==i?s=i+1:s<i&&(h=i,i=s,s=h),this.pe=new mt(this.Y,t,n-t,i,s-i);else if(this.Jt.mode==this.ce){const i=this.ve(e);this.pe=new mt(this.Y,t,n-t,i.start,i.length)}this.Y.setProspectiveChange(this.pe)}else this.vn(),this.kn()}kn(){const t=this.Pt&&!this.Ft;if(this.fe.style.visibility=t?"visible":"hidden",t){const t=this.Bt/2;let n=this.Y.song.loopStart*this.On,e=(this.Y.song.loopStart+this.Y.song.loopLength)*this.On;if(this.Jt.mode==this.oe)e=this.Y.song.loopStart*this.On+2*t;else if(this.Jt.mode==this.re)n=(this.Y.song.loopStart+this.Y.song.loopLength)*this.On-2*t;else{const t=this.ve(this.Jt.startBar);n=t.start*this.On,e=(t.start+t.length)*this.On}this.fe.setAttribute("d",`M ${n+t} 4 L ${e-t} 4 A ${t-4} ${t-4} 0 0 1 ${e-t} ${this.Bt-4} L ${n+t} ${this.Bt-4} A ${t-4} ${t-4} 0 0 1 ${n+t} 4 z`)}}xe(){const t=this.Bt/2,n=this.Y.song.loopStart*this.On,e=(this.Y.song.loopStart+this.Y.song.loopLength)*this.On;if(this.Kn!=this.Y.song.barCount){this.Kn=this.Y.song.barCount;const t=32*this.Y.song.barCount;this.container.style.width=t+"px",this.kt.setAttribute("width",t+"")}this.ue==n&&this.ge==e||(this.ue=n,this.ge=e,this.le.setAttribute("d",`M ${n+t} 2 L ${e-t} 2 A ${t-2} ${t-2} 0 0 1 ${e-t} ${this.Bt-2} L ${n+t} ${this.Bt-2} A ${t-2} ${t-2} 0 0 1 ${n+t} 2 z`)),this.kn()}}const{div:hn}=m;class an{constructor(t,n){this.Y=t,this.ke=n,this.ln=512,this.Bt=20,this.Me=u.svg({"pointer-events":"none"}),this.Le=u.rect({fill:"#444444",x:0,y:2,width:10,height:this.Bt-4}),this.Ce=u.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:0,y:1,width:10,height:this.Bt-2}),this.Ae=u.path({fill:"white","pointer-events":"none"}),this.Se=u.path({fill:"white","pointer-events":"none"}),this.kt=u.svg({style:"background-color: #000000; touch-action: pan-y; position: absolute;",width:this.ln,height:this.Bt},[this.Me,this.Le,this.Ce,this.Ae,this.Se]),this.container=hn({class:"barScrollBar",style:"width: 512px; height: 20px; overflow: hidden; position: relative;"},[this.kt]),this.Rt=0,this.Et=0,this.Ft=!1,this.Pt=!1,this.Be=!1,this.Re=-1,this.Ee=-1,this.Fe=t=>{this.Y.barScrollPos=this.ke.scrollLeft/32},this.fn=t=>{this.Pt||(this.Pt=!0,this.kn())},this.pn=t=>{this.Pt&&(this.Pt=!1,this.kn())},this.dn=t=>{t.preventDefault(),this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top,this.kn(),this.Rt>=this.Y.barScrollPos*this.On&&this.Rt<=(this.Y.barScrollPos+this.Y.trackVisibleBars)*this.On&&(this.Be=!0,this.Pe=this.Rt)},this.bn=t=>{t.preventDefault(),this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=t.touches[0].clientY-n.top,this.kn(),this.Rt>=this.Y.barScrollPos*this.On&&this.Rt<=(this.Y.barScrollPos+this.Y.trackVisibleBars)*this.On&&(this.Be=!0,this.Pe=this.Rt)},this.mn=t=>{const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=(t.clientY||t.pageY)-n.top,this.un()},this.gn=t=>{if(!this.Ft)return;t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=t.touches[0].clientY-n.top,this.un()},this.wn=t=>{!this.Be&&this.Ft&&(this.Rt<(this.Y.barScrollPos+8)*this.On?(this.Y.barScrollPos>0&&this.Y.barScrollPos--,this.Y.notifier.changed()):(this.Y.barScrollPos<this.Y.song.barCount-this.Y.trackVisibleBars&&this.Y.barScrollPos++,this.Y.notifier.changed())),this.Ft=!1,this.Be=!1,this.kn()};const e=.5*this.Bt;this.Ae.setAttribute("d",`M 9 ${e} L 20 ${e+6} L 20 ${e-6} z`),this.Se.setAttribute("d",`M ${this.ln-9} ${e} L ${this.ln-20} ${e+6} L ${this.ln-20} ${e-6} z`),this.container.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.wn),this.container.addEventListener("mouseover",this.fn),this.container.addEventListener("mouseout",this.pn),this.container.addEventListener("touchstart",this.bn),this.container.addEventListener("touchmove",this.gn),this.container.addEventListener("touchend",this.wn),this.container.addEventListener("touchcancel",this.wn),this.ke.addEventListener("scroll",this.Fe,{capture:!1,passive:!0})}un(){if(this.Be){for(;this.Rt-this.Pe<.5*-this.On&&this.Y.barScrollPos>0;)this.Y.barScrollPos--,this.Pe-=this.On,this.Y.notifier.changed();for(;this.Rt-this.Pe>.5*this.On&&this.Y.barScrollPos<this.Y.song.barCount-this.Y.trackVisibleBars;)this.Y.barScrollPos++,this.Pe+=this.On,this.Y.notifier.changed()}this.Pt&&this.kn()}kn(){let t=!1,n=!1,e=!1;this.Pt&&!this.Ft&&(this.Rt<this.Y.barScrollPos*this.On?t=!0:this.Rt>(this.Y.barScrollPos+this.Y.trackVisibleBars)*this.On?n=!0:e=!0),this.Ae.style.visibility=t?"visible":"hidden",this.Se.style.visibility=n?"visible":"hidden",this.Ce.style.visibility=e?"visible":"hidden"}render(){this.On=(this.ln-1)/Math.max(this.Y.trackVisibleBars,this.Y.song.barCount);const t=this.Re!=this.Y.song.barCount;if(t){for(this.Re=this.Y.song.barCount;this.Me.firstChild;)this.Me.removeChild(this.Me.firstChild);for(let t=0;t<=this.Y.song.barCount;t++){const n=t%16==0?0:t%4==0?this.Bt/8:this.Bt/3;this.Me.appendChild(u.rect({fill:"#444444",x:t*this.On-1,y:n,width:2,height:this.Bt-2*n}))}}(t||this.Ee!=this.Y.barScrollPos)&&(this.Ee=this.Y.barScrollPos,this.Le.setAttribute("x",""+this.On*this.Y.barScrollPos),this.Le.setAttribute("width",""+this.On*this.Y.trackVisibleBars),this.Ce.setAttribute("x",""+this.On*this.Y.barScrollPos),this.Ce.setAttribute("width",""+this.On*this.Y.trackVisibleBars)),this.kn(),this.ke.scrollLeft=32*this.Y.barScrollPos}}const{div:on}=m;class rn{constructor(t){this.Y=t,this.ln=20,this.Bt=481,this.Ne=4,this.Ie=7,this.De=(this.Bt-this.Ne)/this.Ie,this.Te=3*this.De+this.Ne,this.Le=u.rect({fill:Jt.octaveScrollbar,x:2,y:0,width:this.ln-4,height:this.Te}),this.Ce=u.rect({fill:"none",stroke:"white","stroke-width":2,"pointer-events":"none",x:1,y:0,width:this.ln-2,height:this.Te}),this.Wn=u.path({fill:"white","pointer-events":"none"}),this.Jn=u.path({fill:"white","pointer-events":"none"}),this.kt=u.svg({style:"touch-action: pan-x; position: absolute;",width:this.ln,height:"100%",viewBox:"0 0 20 481",preserveAspectRatio:"none"}),this.container=on({id:"octaveScrollBarContainer",style:"width: 20px; height: 100%; overflow: hidden; position: relative; flex-shrink: 0;"},[this.kt]),this.Rt=0,this.Et=0,this.Ft=!1,this.Pt=!1,this.Be=!1,this.Ze=-1,this.pe=null,this.fn=t=>{this.Pt||(this.Pt=!0,this.kn())},this.pn=t=>{this.Pt&&(this.Pt=!1,this.kn())},this.dn=t=>{t.preventDefault(),this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.Y.song.getChannelIsDrum(this.Y.channel)||(this.kn(),this.Et>=this.je-this.Te&&this.Et<=this.je&&(this.Be=!0,this.pe=null,this.Pe=this.Et))},this.bn=t=>{t.preventDefault(),this.Ft=!0;const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.Y.song.getChannelIsDrum(this.Y.channel)||(this.kn(),this.Et>=this.je-this.Te&&this.Et<=this.je&&(this.Be=!0,this.pe=null,this.Pe=this.Et))},this.mn=t=>{const n=this.kt.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.un()},this.gn=t=>{if(!this.Ft)return;t.preventDefault();const n=this.kt.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.un()},this.wn=t=>{if(!this.Y.song.getChannelIsDrum(this.Y.channel)&&this.Ft)if(this.Be)null!=this.pe&&this.Y.record(this.pe);else{const t=this.Y.lastChangeWas(this.pe),n=t?this.pe.oldValue:this.Y.song.channels[this.Y.channel].octave,e=this.Y.song.channels[this.Y.channel].octave;this.Et<this.je-.5*this.Te?e<4&&(this.pe=new gt(this.Y,n,e+1),this.Y.record(this.pe,t)):e>0&&(this.pe=new gt(this.Y,n,e-1),this.Y.record(this.pe,t))}this.Ft=!1,this.Be=!1,this.kn()},this.Mn=()=>{this.je=this.Bt-this.De*this.Y.song.channels[this.Y.channel].octave,this.xe()},this.Y.notifier.watch(this.Mn),this.Mn(),this.kt.appendChild(this.Le);for(let t=0;t<=this.Ie;t++)this.kt.appendChild(u.rect({fill:Jt.scrollbarOctave,x:0,y:t*this.De,width:this.ln,height:this.Ne}));this.kt.appendChild(this.Ce),this.kt.appendChild(this.Wn),this.kt.appendChild(this.Jn),this.kt.style.backgroundColor=Jt.editorBackground;const n=.5*this.ln;this.Wn.setAttribute("d",`M ${n} 9 L ${n+6} 20 L ${n-6} 20 z`),this.Jn.setAttribute("d",`M ${n} ${this.Bt-9} L ${n+6} ${this.Bt-20} L ${n-6} ${this.Bt-20} z`),this.container.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.wn),this.container.addEventListener("mouseover",this.fn),this.container.addEventListener("mouseout",this.pn),this.container.addEventListener("touchstart",this.bn),this.container.addEventListener("touchmove",this.gn),this.container.addEventListener("touchend",this.wn),this.container.addEventListener("touchcancel",this.wn)}un(){if(!this.Y.song.getChannelIsDrum(this.Y.channel)){if(this.Be){const t=this.Y.song.channels[this.Y.channel].octave,n=this.Y.lastChangeWas(this.pe)?this.pe.oldValue:t;let e=t;for(;this.Et-this.Pe<.5*-this.De&&e<4;)e++,this.Pe-=this.De;for(;this.Et-this.Pe>.5*this.De&&e>0;)e--,this.Pe+=this.De;this.pe=new gt(this.Y,n,e),this.Y.setProspectiveChange(this.pe)}this.Pt&&this.kn()}}kn(){let t=!1,n=!1,e=!1;this.Pt&&!this.Ft&&(this.Et<this.je-this.Te?t=!0:this.Et>this.je?n=!0:e=!0),this.Wn.style.visibility=t?"inherit":"hidden",this.Jn.style.visibility=n?"inherit":"hidden",this.Ce.style.visibility=e?"inherit":"hidden"}xe(){this.kt.style.visibility=this.Y.song.getChannelIsDrum(this.Y.channel)?"hidden":"visible",this.Ze!=this.je&&(this.Ze=this.je,this.Le.setAttribute("y",""+(this.je-this.Te)),this.Ce.setAttribute("y",""+(this.je-this.Te))),this.kn()}}const{canvas:cn,div:ln}=m;let fn=!1;function pn(){fn=!0}const dn=document.createElement("img");dn.onload=pn,dn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAANCAIAAABHKvtLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NEU3RTM2RTg0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NEU3RTM2RTk0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozMzYxN0U3RDQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozMzYxN0U3RTQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PomGIaQAAABgSURBVHjaYpSWlmZhYWFmZgaSTExMQAYTGGAyIICRkRFIMhANWISFhdlggAUHANrBysoKNBfuCGKMvnjx4r59+xhp5wOg6UCSBM+SB0YtGLVgCFgAzDeMeOSGgAUAAQYAGgwJrOg8pdQAAAAASUVORK5CYII=";const yn=document.createElement("img");yn.onload=pn,yn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAANCAIAAABHKvtLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NEU3RTM2RUM0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NEU3RTM2RUQ0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0RTdFMzZFQTQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0RTdFMzZFQjQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhURscAAAAB1SURBVHja7NPBCoAgDAZgnaMX8Oj7P2KKldXPhiR4CwwCv4PInPvxoA0hMLNzDisRYUPCCiMucVallJzzJnaBih5pp2mw936puKEZ2qQ3MeUQmLiKGGNKCZ1IQr2fDnb0C8gMNgNmwA8Cnt/0Tv91vw64BRgALUuP70jrlrwAAAAASUVORK5CYII=";const bn=document.createElement("img");bn.onload=pn,bn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAANCAIAAABHKvtLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzM2MTdFNzc0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzM2MTdFNzg0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozMzYxN0U3NTQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozMzYxN0U3NjQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgBmMXoAAACTSURBVHja7JQ7CgMhGIT3920M2Hko7+RJPYWViE0myi5sEXAhKQL7FcP8PmawkWKMjx2llNb60MNIKY0xnPPphRDbMsJ7/xw458wAodZa6PRQ5GIF0RjlYCU655xSEqWU3ntrrdb63RcgHcq2H3MX3AV/UEAhBL7DBkTEzmAFuzSY44UC/BDHtU+8z539esFLgAEAkZ4XCDjZXPEAAAAASUVORK5CYII=";const mn=document.createElement("img");mn.onload=pn,mn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAANCAIAAABHKvtLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzM2MTdFN0I0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzM2MTdFN0M0NzBEMTFFMTgyMjBBREEyQTVGRDY5MjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozMzYxN0U3OTQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozMzYxN0U3QTQ3MEQxMUUxODIyMEFEQTJBNUZENjkyMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlZjoH4AAADHSURBVHja7JTNDoMgEIRBGq21iTcfyvd/DeNvJBYBp7uFEE+99NDE70AMMDPLYZRt2z4CeZ4XRcFrRkgphRD7vnvvX8RGdF03DEPf99M0LcuitcamMcZa6wkRuNV1/SSqqroTcC/LEu5KKQ6AEhq21oRzDl5bAME8DUjd3wHjOELPyu9fgNnneV7XNQ6OyNPsTCZ+zBVwBfxBgGyaRgViuWIt+ZIPuAAaZwh00BKxaKeuSfwhUsfI55g+WOMT2DEl3jm94BBgAAtY6T6d3wTNAAAAAElFTkSuQmCC";const un=document.createElement("img");un.onload=pn,un.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAArCAIAAACW3x1gAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMTgwMTE3NDA3MjA2ODExOUJCOEEzOUJCMkI3MTdFNCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NzVEOTA1QzQ5MjMxMUUxOTM3RDhDNEI4QkIxQkFCNSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NzVEOTA1QjQ5MjMxMUUxOTM3RDhDNEI4QkIxQkFCNSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAxODAxMTc0MDcyMDY4MTE5QkI4QTM5QkIyQjcxN0U0IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAxODAxMTc0MDcyMDY4MTE5QkI4QTM5QkIyQjcxN0U0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+dtFK5QAACbRJREFUeNrcV0lsG9cZnnmzcJdIcRHFRZtly5IVSVYSOcriNY7jqHHTBE2bJkCRNijQQ9re2kOBAj30kByKAm1PvQVF0RYIkLRpkiZuLMqyLVm7bGvlIpKiuHOGyww52+ubIbXYCYLk2P4ccobz3nzf+9f3D4b9rwv+5cOXL5x48crDT54b8Pr6jOZWQJoxKIi13WJ+Oziz+Z/r6x9N3AvMhb42gcWkf/P1Mz/40fkWz2iuAAsFrljkOK5crVYwTNTrcaMRNDURNhtl1Slrn9x55x+zf/5ooVIVvhLBq1ce+eXPLpt6RnZ22EIBmk1Oi8VuMFoMBgNF6RUMF2tcrVqscPlSKcGV4zaC85qNd25u/PHdm/+8tf5lBBRJ/Oan49/98cVEDmcYg9PZ09LSrjcYSRzHcAAxDGBQQfMgJiuyAiFUFMSUT23mtu9YxYxVgX/6YPa3796QZGUfk9i/Mhvo3//8W99443wwKtB0T1fXqM3m0en0iJUgSIIkKYoiKBL9A4QqAEcCSFJnbnI3uboqIpHP7D7T73WYDbfW4+IexwHB22+OX3zpsfAu5nI96vUM0gY9wqN0JEJG2AAATFs7hlABrhKgk3qJQwwCgrY4/ZiuaSceO+VvslkM11Yi9xG8+dLj33/tdDgLPB1POB09JE0RAOESFEEiVOWQaIZBPxCtX2MBUKVRMAXTWZyk2RaPRp440lIV5PngboPgZE/br16/kBJwR9dTTtdxQkejBzUOoHxO4P2CCAgcV+8iDSHUWWyA0ieDa4N++1J4N8VUVMVfvTCEm/S0vc/Z1g9IoKIjU6PHkCBvyrJ63hMJffZ+tQkyDnDVPThR18beM6zvHmky0i8/OYDAwTGvfXz0WKoCXL5BFVv1p0qgmULRMJTD0HVKWdqj1EZVS2meV+MNU1zHTmZE6tLJ7qOeFvLMQ504TRkt3SarC00j1aOBrhmksUxFu4PuNxytAqHAhZj2Bw2h6Kprgym40d5m9PXqmbXTA53gzIA/V+KaXZ3aTBSCuKrpniDMOo+yv/bGr3qCyv46VE8jDVCmIBT0t7mtK1fkn+rzgpPdrWy5arS2qloCXHMWdp8flYatZGVPm7rd7nc6psUV0BgQgsnhYbnacGcr8DltXE3UGZsxFNA4JAgcUzU/RHDoWsOFh2Pp8ES0OnX9anWAtNnK1wSf00paTIZG0UAhV19+4/uAHNCqc2Hj3n2CDCxDWRvU1FCLJuB43qijahyLiFG2wEZ5wr+gLOKac7USUX/+gVlQ1pahsdZKjEFHcxwPWIZpNus5JgUhPICqY+1B4XvAQItHrUjsDR6aiRRT9gAq2USzUccyLNhNpe0WI5uOYFrEoAPDDqHvoSJMcJ8Q+7f3J6rxIGP1hbKJsN1iQOAgtJNutZu5bKjEpmU1HNXQeABcKzsNIfeKqVbv8H0OLbCgamQIuXySS6y7rOZQIgO2M2WsxrealHRsSdEiW5Kkfez6uV47Dyg0+ANzgUbqIAfXDZBZn3eSoiJUorkyoMzW9bW1Tk+LkFtNJ1YQPApESZFAAxqAQ9jEYZK6aKPItJJaPdRPdmupGlnocDWvra4hcHCi7/jdxXtihe3yWFKx2+lsUJZESVKLxAH2F1A0wNEAsrooC5Ko5ggb38wsBbps+mqZXVxZHeg7Dvq7vYlo+c78vN9t7fSARPxmMrmuCKIgSfUqRnwxeEOQZQRBRnpDWcxur6QWPm3XcT67eX5uLrHD93V5SSOsWk2ttwMLNp9rePwiyZbC0Vs8X/R5T+gNFog41F2SOEjdevRrXhVFUS2sklTjSsmt21xw7ogZ8za3XEcyvdzS3KOXeeInlx9iC3IikqkKCZ2ROjr6kKXJVCjsRqMx9CRBGpHBkWXrW1g9nRG0pNpRRGav8Gw6thy995mhuHW81eSxmK4HpiYnrzNFU9+xXp/XQLz8aIel2RqeTZZrNVHYJYDi7u7s6OqkaaJQSEajYYbJ8xwvSgJaLDI3YuW5EsNkc7lIYmchEbtJC9tHHFS/z6GUuclrE4GJwG6BBpJ1bKy3WGXJ5WDs+WfOOX0t+UgmaqieOM1uXP2Xb/iUv+Nhv7+DYYRstlIoZLYj259rvMg2D+mwuq2ohjL81vTC8tQ0hyk7eRpyTd52W09P6/uBKXLmXuSlK7D3VM+tSAZugv7Lb3349otCOe3OxW3+oWb7gNXqwDAdhqHdX0I1BsNQ+8ZjWBXDOHQh88XY3EpoZml1ZjGdLP/ivX9cffcVtKcPDXdStHJ7bZtcjGS2Ntb7xwbDs2F2K4UX37rzMcOOQoN5RSpuNbnnjPYjlMkP6DaIm1AfpDZdQqlWSVVyMSYeTm5sJtZCHMOHd2q7O2T449+hXdPvd5wc7tpYX12OZslIEd6YWe4a7h+8PHT9D5/GVxhXEiTey2eC1aOnnINnUUuUx2vLtIGUqlKVq/FlgWf5ClstM1yF4Zk0F4zUIiGhkiLNgNxeLaDUfvzxXkAIgfmV7TJGcBJGSJUeFz36wllBlP/+6+suknQSlCGthGfyK7PpWKhcydckUYtRHBN5KZ/m4qHS+jK7OFNYmC6mNyRzlTIRSDlseT537uzApUvDk4HAX29s3C2olsUWk9K/r06jPBj94WmlJu68v4RuNpGEkzLCNJbbza98mL4qiowsj35vOLZVWL8VpnFcDwA6/AQt62FVwQSo7iVjj/WOP/fwzVs3PpicvVuAjcarJKhrawM5i8My+NoFqSxVtlKEApE1DQA4KKqd1nXrdb1Gw/jf/jL2/KPyO5+00bSVotCoorkexS9OkWPnB158eWxpbnYiEPgsrmyyh1rHGCOhztkF07SJOHrlrMnTVo3nFKaCdmgSRxs56kXU3a79lZ3NTz/JLORFXkG4yGwSVNFt7Y6nvzM2dubo7NTUxLVrEzH5Zgo+2PyGswJqarwUq0gV92ivf/wSbbFIGRayZVSP1WqM47pHbKH5TC3MCRW5TmBpt498e/TZN85RRHn6s4mF2flAVJ5Mavb6/K6K2pZvPuZ45ZK364jTfXzE2j5EQn95LsyvbJXWQ+VofDIci4vC00d9lMdlOuZ2DHndI242EgqjPJheiCdLE1vVqYSswC99wznVZ33hvOfKxQ5Ts6HJ3X0oD8xaHlQVoVCrJCq5OLMTSm5sJO4FObY6tVqcCnJrWfkrvaPpaXBxzP3sOd9zT3fYXSa9kab0lFhFVRPlAepAahUWJUEV5UE2XZ5azE6vl+YivCDDr/2WOdzfcmqkdWTINXDC4XXpzTqiWq7F42wwyKxuFO5sMneDxc0Ej/0/y38FGACBHjS0mkQ17AAAAABJRU5ErkJggg==";class gn{constructor(t){this.Y=t,this.ze=cn({width:"32",height:"481",style:"width: 100%; height: 100%;"}),this.Oe=cn({width:"32",height:"40"}),this.container=ln({style:"width: 32px; height: 100%; overflow:hidden; position: relative; flex-shrink: 0; touch-action: none;"},[this.ze,this.Oe]),this.Ge=this.ze.getContext("2d"),this.Ue=this.Oe.getContext("2d"),this.ln=32,this.Bt=481,this.Rt=0,this.Et=0,this.Ft=!1,this.Pt=!1,this.Ve=-1,this.tn=!1,this.Ye=-1,this.fn=t=>{this.Pt||(this.Pt=!0,this.kn())},this.pn=t=>{this.Pt&&(this.Pt=!1,this.kn())},this.dn=t=>{t.preventDefault(),this.Ft=!0;const n=this.ze.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.Y.synth.pianoPressed=!0,this.kn()},this.mn=t=>{const n=this.ze.getBoundingClientRect();this.Rt=(t.clientX||t.pageX)-n.left,this.Et=((t.clientY||t.pageY)-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.We(),this.Y.synth.pianoPitch[0]=this.Je+12*this.Y.song.channels[this.Y.channel].octave,this.kn()},this.he=t=>{this.Ft=!1,this.Y.synth.pianoPressed=!1,this.kn()},this.bn=t=>{t.preventDefault(),this.Ft=!0;const n=this.ze.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.We(),this.Y.synth.pianoPressed=!0,this.Y.synth.pianoPitch[0]=this.Je+12*this.Y.song.channels[this.Y.channel].octave},this.gn=t=>{t.preventDefault();const n=this.ze.getBoundingClientRect();this.Rt=t.touches[0].clientX-n.left,this.Et=(t.touches[0].clientY-n.top)*this.Bt/(n.bottom-n.top),isNaN(this.Et)&&(this.Et=0),this.We(),this.Y.synth.pianoPitch[0]=this.Je+12*this.Y.song.channels[this.Y.channel].octave},this.we=t=>{t.preventDefault(),this.Y.synth.pianoPressed=!1},this.Mn=()=>{const t=this.Y.song.getChannelIsDrum(this.Y.channel);this.Cn=t?40:13,this.An=t?s.drumCount:s.pitchCount,this.We(),this.Y.synth.pianoPitch[0]=this.Je+12*this.Y.song.channels[this.Y.channel].octave,this.Y.synth.pianoChannel=this.Y.channel,this.xe()},this.xe=()=>{if(!fn)return void window.requestAnimationFrame(this.xe);if(!this.Y.showLetters)return;const t=this.Y.song.getChannelIsDrum(this.Y.channel);if(this.Ve==this.Y.song.scale&&this.Ye==this.Y.song.key&&this.tn==t)return;let n;this.Ve=this.Y.song.scale,this.Ye=this.Y.song.key,this.tn=t,this.Ge.clearRect(0,0,this.ln,this.Bt);for(let e=0;e<this.An;e++){const i=(e+s.keyTransposes[this.Y.song.key])%12;if(t){n=un;const t=1-e/this.An*.35,i=.5*(1-t),s=n.width*i,h=n.height*i+this.Cn*(this.An-e-1),a=n.width*t,o=n.height*t;this.Ge.drawImage(n,s,h,a,o);const r=1+(e-this.An/2)/this.An*.5,c=this.Ge.getImageData(s,h,a,o),l=c.data;for(let t=0;t<l.length;t+=4)l[t+0]*=r,l[t+1]*=r,l[t+2]*=r;this.Ge.putImageData(c,s,h)}else if(s.scaleFlags[this.Y.song.scale][e%12]){let t=s.pitchNames[i];if(null==t){const n=s.blackKeyNameParents[e%12];t=s.pitchNames[(i+12+n)%12],1==n?t+="♭":-1==n&&(t+="♯")}const h=s.pianoScaleFlags[i]?"#000":"#fff";n=s.pianoScaleFlags[i]?bn:dn,this.Ge.drawImage(n,0,this.Cn*(this.An-e-1)),this.Ge.font="bold 11px sans-serif",this.Ge.fillStyle=h,this.Ge.fillText(t,15,this.Cn*(this.An-e)-3)}else n=s.pianoScaleFlags[i]?mn:yn,this.Ge.drawImage(n,0,this.Cn*(this.An-e-1))}this.kn()},this.Y.notifier.watch(this.Mn),this.Mn(),this.container.addEventListener("mousedown",this.dn),document.addEventListener("mousemove",this.mn),document.addEventListener("mouseup",this.he),this.container.addEventListener("mouseover",this.fn),this.container.addEventListener("mouseout",this.pn),this.container.addEventListener("touchstart",this.bn),this.container.addEventListener("touchmove",this.gn),this.container.addEventListener("touchend",this.we),this.container.addEventListener("touchcancel",this.we)}We(){const t=s.scaleFlags[this.Y.song.scale],n=Math.max(0,Math.min(this.An-1,this.An-this.Et/this.Cn));if(t[Math.floor(n)%12]||this.Y.song.getChannelIsDrum(this.Y.channel))this.Je=Math.floor(n);else{let e=Math.floor(n)+1,i=Math.floor(n)-1;for(;!t[e%12];)e++;for(;!t[i%12];)i--;let s=e,h=i+1;e%12!=0&&e%12!=7||(s-=.5),i%12!=0&&i%12!=7||(h+=.5),this.Je=n-h>s-n?e:i}}kn(){this.Oe.style.visibility=!this.Pt||this.Ft?"hidden":"visible",this.Pt&&!this.Ft&&(this.Ue.clearRect(0,0,32,40),this.Oe.style.left="0px",this.Oe.style.top=this.Cn*(this.An-this.Je-1)+"px",this.Ue.lineWidth=2,this.Ue.strokeStyle="#ff7200",this.Ue.strokeRect(1,1,this.ln-2,this.Cn-2))}}const{button:wn,div:xn}=m;class vn{constructor(t){this.Y=t,this.He=wn({},[xn("Close")]),this.container=xn({class:"prompt",style:"width: 300px;"},[xn({style:"font-size: 2em"},[xn("Mixing Styles")]),xn({style:"text-align: left; margin: 0.5em 0;"},[xn("Mixing styles are a way how changing how loud or soft different sounds are and can change the way different sounds blend and mix together. Using different mixing styles can drastically change your song.")]),xn({style:"text-align: left; margin: 0.5em 0;"},[xn("Type A Mixing is akin to mixing in vanilla Beepbox, Sandbox, and most other beepbox mods. In this mixing type, the drums are about twice as loud as in Type B mixing and the sound is generally a bit sharper and blends together differently.")]),xn({style:"text-align: left; margin: 0.5em 0;"},[xn("Type B Mixing is regular Modbox mixing.")]),xn({style:"text-align: left; margin: 0.5em 0;"},[xn("Type C Mixing is like Type B, save for a few upgrades. There are more volume options in Type C mixing, certain waves (acoustic bass, lyre, ramp pulse, and piccolo) are a bit quieter, the flatline wave is a bit louder, and blending works slightly differently.")]),xn({style:"text-align: left; margin: 0.5em 0;"},[xn("Type D Mixing includes slightly quieter drums from Type B, but also includes sharper sounds for regular notes in pitch channels.")]),this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.He.removeEventListener("click",this.Qe)},this.He.addEventListener("click",this.Qe)}}const{button:kn,div:Mn}=m;class Ln{constructor(t){this.Y=t,this.He=kn({},[Mn("Close")]),this.container=Mn({class:"prompt",style:"width: 250px;"},[Mn({style:"font-size: 2em"},[Mn("Custom Harmony")]),Mn({style:"text-align: left;"},[Mn('BeepBox "chip" instruments play two waves at once, each with their own pitch.')]),Mn({style:"text-align: left;"},[Mn('By placing two notes one above another it will play two indivdual sounds. This replaces the "arpeggio/trill" effect, and gives you greater control over your harmony. ')]),Mn({style:"text-align: left;"},[Mn("In older versions of Modbox, union would not allow notes to harmonize properly and needed a special harmonic chorus in order to work. This has been patched in Modbox 3.1.0. ")]),this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.He.removeEventListener("click",this.Qe)},this.He.addEventListener("click",this.Qe)}}const{button:Cn,div:An,input:Sn}=m;function Bn(t,n){if(navigator.msSaveOrOpenBlob)return void navigator.msSaveOrOpenBlob(t,n);const e=document.createElement("a");if(null!=e.download){const i=URL.createObjectURL(t);setTimeout((function(){URL.revokeObjectURL(i)}),6e4),e.href=i,e.download=n,setTimeout((function(){e.dispatchEvent(new MouseEvent("click"))}),0)}else{const n=URL.createObjectURL(t);setTimeout((function(){URL.revokeObjectURL(n)}),6e4),window.open(n,"_blank")||(window.location.href=n)}}class Rn{constructor(t){this.Y=t,this.Xe=Sn({type:"text",style:"width: 10em;",value:"Modbox-Song",maxlength:250}),this.$e=Sn({type:"checkbox"}),this.Ke=Sn({style:"width: 2em;",type:"number",min:"1",max:"4",step:"1"}),this._e=Sn({type:"checkbox"}),this.qe=Cn({},[An("Export to .wav file")]),this.ti=Cn({},[An("Export to .json file")]),this.He=Cn({},[An("Cancel")]),this.container=An({class:"prompt",style:"width: 200px;"},[An({style:"font-size: 2em"},[An("Export Options")]),An({style:"display: flex; flex-direction: row; align-items: center; justify-content: space-between;"},[An("File name:"),this.Xe]),An({style:"display: table; width: 100%;"},[An({style:"display: table-row;"},[An({style:"display: table-cell;"},[An("Intro:")]),An({style:"display: table-cell;"},[An("Loop Count:")]),An({style:"display: table-cell;"},[An("Outro:")])]),An({style:"display: table-row;"},[An({style:"display: table-cell; vertical-align: middle;"},[this.$e]),An({style:"display: table-cell; vertical-align: middle;"},[this.Ke]),An({style:"display: table-cell; vertical-align: middle;"},[this._e])])]),this.qe,this.ti,this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.Xe.removeEventListener("input",Rn.ni),this.Ke.removeEventListener("blur",Rn.ei),this.qe.removeEventListener("click",this.ii),this.ti.removeEventListener("click",this.si),this.He.removeEventListener("click",this.Qe)},this.ii=()=>{const t=new I(this.Y.song);if(t.enableIntro=this.$e.checked,t.enableOutro=this._e.checked,t.loopCount=Number(this.Ke.value),!t.enableIntro)for(let n=0;n<this.Y.song.loopStart;n++)t.nextBar();const n=t.totalSamples,e=new Float32Array(n),i=new Float32Array(n);t.synthesize(e,i,n);const s=t.samplesPerSecond,h=2*n;let a=0;const o=new ArrayBuffer(44+2*h),r=new DataView(o);let c,l,f,p;r.setUint32(a,1380533830,!1),a+=4,r.setUint32(a,36+2*h,!0),a+=4,r.setUint32(a,1463899717,!1),a+=4,r.setUint32(a,1718449184,!1),a+=4,r.setUint32(a,16,!0),a+=4,r.setUint16(a,1,!0),a+=2,r.setUint16(a,2,!0),a+=2,r.setUint32(a,s,!0),a+=4,r.setUint32(a,2*s*2,!0),a+=4,r.setUint16(a,2,!0),a+=2,r.setUint16(a,16,!0),a+=2,r.setUint32(a,1684108385,!1),a+=4,r.setUint32(a,2*h,!0),a+=4,c=1,l=1;for(let t=0;t<n;t++){f=Math.floor(32767*e[1*t]),p=Math.floor(32767*i[1*t]);for(let t=0;t<1;t++)r.setInt16(a,f,!0),a+=2,r.setInt16(a,p,!0),a+=2}Bn(new Blob([o],{type:"audio/wav"}),this.Xe.value.trim()+".wav"),this.Qe()},this.si=()=>{const t=this.Y.song.toJsonObject(this.$e.checked,Number(this.Ke.value),this._e.checked),n=JSON.stringify(t,null,"\t");Bn(new Blob([n],{type:"application/json"}),this.Xe.value.trim()+".json"),this.Qe()},this.Ke.value="1",0==this.Y.song.loopStart?(this.$e.checked=!1,this.$e.disabled=!0):(this.$e.checked=!0,this.$e.disabled=!1),this.Y.song.loopStart+this.Y.song.loopLength==this.Y.song.barCount?(this._e.checked=!1,this._e.disabled=!0):(this._e.checked=!0,this._e.disabled=!1),this.Xe.addEventListener("input",Rn.ni),this.Ke.addEventListener("blur",Rn.ei),this.qe.addEventListener("click",this.ii),this.ti.addEventListener("click",this.si),this.He.addEventListener("click",this.Qe)}static ni(t){const n=t.target,e=/[\+\*\$\?\|\{\}\\\/<>#%!`&'"=:@]/gi;if(e.test(n.value)){let t=n.selectionStart;n.value=n.value.replace(e,""),t--,n.setSelectionRange(t,t)}}static ei(t){const n=t.target;n.value=Math.floor(Math.max(Number(n.min),Math.min(Number(n.max),Number(n.value))))+""}}const{button:En,div:Fn,input:Pn}=m;class Nn{constructor(t){this.Y=t,this.hi=Pn({type:"file",accept:".json,application/json"}),this.He=En({},[Fn("Cancel")]),this.container=Fn({class:"prompt",style:"width: 200px;"},[Fn({style:"font-size: 2em"},[Fn("Import")]),Fn({style:"text-align: left;"},[Fn("BeepBox songs can be exported and re-imported as .json files. You could also use other means to make .json files for BeepBox as long as they follow the same structure.")]),this.hi,this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.hi.removeEventListener("change",this.ai),this.He.removeEventListener("click",this.Qe)},this.ai=()=>{const t=this.hi.files[0];if(!t)return;const n=new FileReader;n.addEventListener("load",(t=>{this.Y.prompt=null,this.Y.record(new Ft(this.Y,n.result),!0)})),n.readAsText(t)},this.hi.addEventListener("change",this.ai),this.He.addEventListener("click",this.Qe)}}const{button:In,div:Dn,a:Tn}=m;class Zn{constructor(t){this.Y=t,this.He=In({},Dn("No thanks!")),this.container=Dn({class:"prompt",style:"width: 250px;"},Dn({style:"font-size: 2em"},Dn("Archives")),Dn({style:"text-align: center;"},Dn("These are the Archives. Below are previous versions of Modded Beepbox/Sandbox that you are able to play around with, changelog included. Go nuts!")),Dn({style:"text-align: center;"},Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.3.0.htm"},Dn("MB 1.3.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.6.0.htm"},Dn("MB 1.6.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/1.9.1.htm"},Dn("MB 1.9.1")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.0.0.htm"},Dn("MB v2.0.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.3.0.htm"},Dn("MB v2.2.2")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/2.3.html"},Dn("MB v2.3.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/mb-archives/3.0.html"},Dn("MB v3.0.3")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.2.1.htm"},Dn("SB v1.2.1")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.3.0.htm"},Dn("SB v1.3.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/1.4.0.htm"},Dn("SB v1.4.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/2.0.6.1.htm"},Dn("SB v2.0.6.1")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/2.1.3.htm"},Dn("SB v2.1.3")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/sb-archives/3.0.0.htm"},Dn("SB v3.0.0")),Dn(" | "),Tn({target:"_blank",href:"https://moddedbeepbox.github.io/beta/changelogs/mbchangelog.html"},Dn("Changelog"))),this.He),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.He.removeEventListener("click",this.Qe)},this.He.addEventListener("click",this.Qe)}}const{button:jn,div:zn}=m;class On{constructor(t,n,e){this.Y=t,this.oi=n,this.ri=e,this.He=jn({},[zn("Close")]),this.ci=jn({},[zn("Refresh")]),this.container=zn({class:"prompt",style:"width: 200px;"},[zn({style:"font-size: 1em"},[zn("Refresh?")]),zn({style:"text-align: left; margin: 0.5em 0;"},[zn("In order for the theme to change the song must refresh. If you refresh on your own after canceling your theme will not update.")]),zn({style:"text-align: left; margin: 0.5em 0;"},[zn("If you use a browser that does not support automatic refreshing, like Microsoft Edge, you will have to refresh manually.")]),zn({style:"text-align: left; margin: 0.5em 0;"},[zn("Would you like to refresh now?")]),this.ci,this.He]),this.li=()=>{this.Y.prompt=null,this.Y.record(new bt(this.Y,this.ri),!0)},this.fi=()=>{this.li(),this.oi.refreshNow()},this.cleanUp=()=>{this.He.removeEventListener("click",this.li),this.ci.removeEventListener("click",this.fi)},this.He.addEventListener("click",this.li),this.ci.addEventListener("click",this.fi)}}const{button:Gn,div:Un}=m;class Vn{constructor(t){this.Y=t,this.He=Gn({},[Un("Close")]),this.container=Un({class:"prompt",style:"width: 250px;"},[Un({style:"font-size: 2em"},[Un("Song Data")]),Un({style:"text-align: left;"},[Un("You are on update Modbox 3.3.0-B_1.")]),Un({style:"text-align: left;"},[Un("Your song is "+this.Y.synth.totalSeconds+" seconds long.")]),Un({style:"text-align: left;"},[Un("Your song runs at "+this.Y.song.getBeatsPerMinute()+" beats per minute.")]),Un({style:"text-align: left;"},[Un("There are currently "+this.Y.song.getChannelUnusedCount()+" unused channels in your song out of 16.")]),Un({style:"text-align: left;"},[Un("Your are using the "+this.Y.song.getThemeName()+" theme.")]),Un({style:"text-align: left;"},[Un("Your time signuature is "+this.Y.song.getTimeSig())]),Un({style:"text-align: left;"},[Un("Your scale is "+this.Y.song.getScaleNKey()+".")]),this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.He.removeEventListener("click",this.Qe)},this.He.addEventListener("click",this.Qe)}}const{button:Yn,div:Wn}=m;class Jn{constructor(t,n,e){this.Y=t,this.oi=n,this.pi=e,this.ci=Yn({},[Wn("Refresh")]),this.container=Wn({class:"prompt",style:"width: 200px;"},[Wn({style:"font-size: 1em"},[Wn("Refresh")]),Wn({style:"text-align: left; margin: 0.5em 0;"},[Wn("Due to you using the Piano theme, you will need to refresh to display the change in key colors.")]),Wn({style:"text-align: left; margin: 0.5em 0;"},[Wn("You must refresh to continue.")]),this.ci]),this.fi=()=>{this.Y.prompt=null,this.Y.record(new yt(this.Y,this.pi)),this.oi.refreshNow()},this.cleanUp=()=>{this.ci.addEventListener("click",this.fi)},this.ci.addEventListener("click",this.fi)}}const{button:Hn,div:Qn,input:Xn,span:$n}=m;class Kn{constructor(t){this.Y=t,this.di=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.yi=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.bi=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.mi=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.ui=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.gi=Xn({style:"width: 3em; margin-left: 1em;",type:"number",step:"1"}),this.wi=Hn({style:"width:45%;"},[Qn("Okay")]),this.He=Hn({style:"width:45%;"},[Qn("Cancel")]),this.container=Qn({class:"prompt",style:"width: 250px;"},[Qn({style:"font-size: 2em"},[Qn("Custom Song Size")]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn({style:"text-align: right;"},[Qn("Beats per bar:"),$n({style:"font-size: smaller; color: #888888;"},[Qn("(Multiples of 3 or 4 are recommended)")])]),this.di]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn({style:"display: inline-block; text-align: right;"},[Qn("Bars per song:"),$n({style:"font-size: smaller; color: #888888;"},[Qn("(Multiples of 2 or 4 are recommended)")])]),this.yi]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn("Patterns per channel:"),this.bi]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn("Instruments per channel:"),this.mi]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn("Number of pitch channels:"),this.ui]),Qn({style:"display: flex; flex-direction: row; align-items: center; height: 2em; justify-content: flex-end;"},[Qn("Number of drum channels:"),this.gi]),Qn({style:"display: flex; flex-direction: row; justify-content: space-between;"},[this.wi,this.He])]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.wi.removeEventListener("click",this.li),this.He.removeEventListener("click",this.Qe),this.di.removeEventListener("keypress",Kn.xi),this.yi.removeEventListener("keypress",Kn.xi),this.bi.removeEventListener("keypress",Kn.xi),this.mi.removeEventListener("keypress",Kn.xi),this.ui.removeEventListener("keypress",Kn.xi),this.gi.removeEventListener("keypress",Kn.xi),this.di.removeEventListener("blur",Kn.ei),this.yi.removeEventListener("blur",Kn.ei),this.bi.removeEventListener("blur",Kn.ei),this.mi.removeEventListener("blur",Kn.ei),this.ui.removeEventListener("blur",Kn.ei),this.gi.removeEventListener("blur",Kn.ei)},this.li=()=>{const t=new Z;t.append(new H(this.Y,Kn.ki(this.di))),t.append(new V(this.Y,Kn.ki(this.yi))),t.append(new kt(this.Y,Kn.ki(this.bi))),t.append(new dt(this.Y,Kn.ki(this.mi))),t.append(new J(this.Y,Kn.ki(this.ui),Kn.ki(this.gi))),this.Y.prompt=null,this.Y.record(t,!0)},this.di.value=this.Y.song.beatsPerBar+"",this.di.min=s.beatsPerBarMin+"",this.di.max=s.beatsPerBarMax+"",this.yi.value=this.Y.song.barCount+"",this.yi.min=s.barCountMin+"",this.yi.max=s.barCountMax+"",this.bi.value=this.Y.song.patternsPerChannel+"",this.bi.min=s.patternsPerChannelMin+"",this.bi.max=s.patternsPerChannelMax+"",this.mi.value=this.Y.song.instrumentsPerChannel+"",this.mi.min=s.instrumentsPerChannelMin+"",this.mi.max=s.instrumentsPerChannelMax+"",this.ui.value=this.Y.song.pitchChannelCount+"",this.ui.min=s.pitchChannelCountMin+"",this.ui.max=s.pitchChannelCountMax+"",this.gi.value=this.Y.song.drumChannelCount+"",this.gi.min=s.drumChannelCountMin+"",this.gi.max=s.drumChannelCountMax+"",this.wi.addEventListener("click",this.li),this.He.addEventListener("click",this.Qe),this.di.addEventListener("keypress",Kn.xi),this.yi.addEventListener("keypress",Kn.xi),this.bi.addEventListener("keypress",Kn.xi),this.mi.addEventListener("keypress",Kn.xi),this.ui.addEventListener("keypress",Kn.xi),this.gi.addEventListener("keypress",Kn.xi),this.di.addEventListener("blur",Kn.ei),this.yi.addEventListener("blur",Kn.ei),this.bi.addEventListener("blur",Kn.ei),this.mi.addEventListener("blur",Kn.ei),this.ui.addEventListener("blur",Kn.ei),this.gi.addEventListener("blur",Kn.ei)}static xi(t){const n=t.which?t.which:t.keyCode;return 46!=n&&n>31&&(n<48||n>57)&&(t.preventDefault(),!0)}static ei(t){const n=t.target;n.value=Math.floor(Math.max(Number(n.min),Math.min(Number(n.max),Number(n.value))))+""}static ki(t){return Math.floor(Number(t.value))}}const{button:_n,div:qn,a:te}=m;class ne{constructor(t){this.Y=t,this.He=_n({},[qn("Close")]),this.container=qn({class:"prompt",style:"width: 300px;"},[qn({style:"font-size: 2em"},[qn("FM Synthesis")]),qn({style:"text-align: left; margin: 0.5em 0;"},[qn("Popularized by the Sega Genesis and Yamaha keyboards, FM Synthesis is a mysterious but powerful technique for crafting sounds. It may seem confusing, but just play around with the options until you get a feel for it, check out some examples in "),te({target:"_blank",href:"#6n10s0kbl00e07t5m0a7g07j7i7r1o2T1d2c0A0F1B0V1Q0200Pff00E0411T1d1c0A0F0B0V1Q2800Pf700E0711T1d2c0A0F1B4VaQ0200Pfb00E0911T1d1c2A0F9B3V1Q1000Pfbc0E0191T1d2c0AcF8B5V1Q0259PffffE0000T1d3c1AcF4B5V4Q2600Pff00E0011T1d1c0AbF0B0V1Q2580PfffaE2226T1d1c0A1F0B0V1Q520dPff4dEd41eb4zhmu0p21h5dfxd7ij7XrjfiAjPudUTtUSRsTzudTudJvdUTztTzrpPudUTtUSSYTzudTudJTdUTztTzrvPudUTtUSQ"},[qn("this demo")]),qn(", or find some instruments to use in the Beepbox Discord's FM sheet "),te({target:"_blank",href:"https://docs.google.com/spreadsheets/d/1ddbXnrP7yvv5X4oUur9boi3AxcI-Xxz1XIHIAo-wi0s/edit#gid=230623845"},[qn("right here")]),qn(".")]),qn({style:"text-align: left; margin: 0.5em 0;"},[qn("This FM instrument uses up to four waves, numbered 1, 2, 3, and 4. Each wave may have its own frequency, volume, and volume envelope to control its effect over time. ")]),qn({style:"text-align: left; margin: 0.5em 0;"},[qn('There are two kinds of waves: "carrier" waves play a tone out loud, but "modulator" waves distort other waves instead. Wave 1 is always a carrier and plays a tone, but other waves may distort it. The "Algorithm" setting determines which waves are modulators, and which other waves those modulators distort. ')]),qn({style:"text-align: left; margin: 0.5em 0;"},[qn('Modulators distort in one direction (like 1←2), but you can also use "Feedback" to make any wave distort in the opposite direction (1→2), in both directions (1🗘2), or even itself (1⟲). ')]),qn({style:"text-align: left; margin: 0.5em 0;"},[qn("You can set the pitch of each wave independently by adding simultaneous notes, one above another. This often sounds harsh or dissonant, but can make cool sound effects! ")]),this.He]),this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.He.removeEventListener("click",this.Qe)},this.He.addEventListener("click",this.Qe)}}const{button:ee,div:ie,p:se,a:he}=m;class ae{constructor(t){this.Y=t,this.Mi=ee({style:"flex: 1; width: 0;"},"Next"),this.Li=ee({style:"flex: 1; width: 0;"},"Close"),this.page=0,this.introContainer=ie({style:"display:flex; flex-direction: column; gap: 16px; text-align: left; font-size: 16px; overflow-y: scroll;"},ie({style:"font-size: 1.5em"},ie("Introduction")),ie({},"BeepBox is an online tool for sketching and sharing chiptune melodies. ModBox expands the world of BeepBox into a whole new realm! We are on the frontier of exploaration with this beta!"),ie({},"This is a specialized manual explaining the basics of using ModBox"),ie({},"All song data is packaged into the URL at the top of your browser. When you make changes to the song, the URL is updated ","to reflect your changes. When you are satisfied with your song, just copy and paste the URL to save and share your song!")),this.instructionsContainer=ie({style:"display:none;  flex-direction: column; gap: 16px; text-align: left; font-size: 16px; overflow-y: scroll;"},ie({style:"font-size: 1.5em"},ie("Instructions")),ie({},se({}," You can add or remove notes by clicking on the gray rows at the top. BeepBox automatically plays the notes out loud for you. Try it!"),se({},"Notes go into patterns, and you can edit one pattern at a time. Those numbered boxes at the bottom of the editor are the different patterns you can edit. Click the other boxes to move to a different part of the song, or click the arrows on the currently selected box to swap which pattern is played during that part of the song."),se({},"There are four rows of patterns that BeepBox can play simultaneously, and each row has its own set of patterns. The first three rows can play melodies and the bottom row is for drums."),se({},"The purple loop underneath the numbered boxes controls which part of the song is currently repeating. Move the loop to listen to a different part of the song, or drag the ends to expand the loop to include the whole song.")),ie({},se({},"When BeepBox has focus (click on its interface above), you can use these keyboard shortcuts:"),se({},"Spacebar: Pause or Resume"),se({},"Z: Undo"),se({},"Y or Shift Z: Redo"),se({},"C: Copy the current pattern"),se({},"V: Paste the current pattern"),se({},"Q: Go to Custom Song Settings"),se({},"[ ]: Move the playhead backward and forward"),se({},"Arrow Keys: Change which bar is selected"),se({},"1-8: Reassign a pattern to the currently selected bar"),se({},"In the pattern editor, you can click and drag horizontally on a note to adjust its duration. You can also click above or below an existing note to enable a rapid arpeggio/trill effect, oscillating between two or more simultaneous notes."),se({},"AVDANCED: Drag vertically from an existing note to bend its pitch, or drag vertically from above or below the note to adjust its volume."),se({},"ModBox has many more features. Enabling Advanced Settings via the Prefernces Menu unlocks much more of Modbox's features! "),se({},"to reflect your changes. When you are satisfied with your song, just copy and paste the URL to save and share your song!"))),this.aboutContainer=ie({style:"display:none;  flex-direction: column; gap: 16px; text-align: left; font-size: 16px; overflow-y: scroll;"},ie({style:"font-size: 1.5em"},ie("About")),ie({},se({},"BeepBox is developed by John Nesky, also known as shaktool. Modded Beepbox is developed by Quirby64, Theepicosity, Fillygroove, and DARE. ")),ie({},se({},"BeepBox and Modded Beepbox do not claim ownership over songs created with it, so original songs belong to their authors. ")),ie({},se({},"Neither John Nesky, BeepBox, nor the Modded BeepBox Dev Team assume responsibility for any copyrighted material played on BeepBox. No songs are ever received, recorded, or distributed by BeepBox or Moded Beepbox's servers. The Modbox Dev Team is not liable for any problems that may occur when your song gets updated in this beta and this beta alone. All song data is contained in the URL after the hash (#) mark, and BeepBox running inside your browser converts that data into sound waves. "),se({},"You can download and use the",he({href:"https://github.com/ModdedBeepbox/beta"},"source code"),"under the MIT license."))),this.container=ie({class:"prompt",style:"width: 400px; max-height: 600px;"},[ie({style:"font-size: 2em"},ie("Manual")),this.introContainer,this.instructionsContainer,this.aboutContainer,ie({style:"display:flex; flex-direction:row; justify-content:space-between; width:100%; gap: 16px;"},this.Li,this.Mi)]),this.Ci=()=>{this.page>0?(this.page--,this.Ai()):(this.Qe(),this.cleanUp())},this.Si=()=>{this.page<2&&(this.page++,this.Ai())},this.Ai=()=>{0==this.page&&(this.introContainer.style.display="flex",this.instructionsContainer.style.display="none",this.aboutContainer.style.display="none",this.Li.innerHTML="Close"),1==this.page&&(this.introContainer.style.display="none",this.instructionsContainer.style.display="flex",this.aboutContainer.style.display="none",this.Li.innerHTML="Back",this.Mi.style.display=""),2==this.page&&(this.introContainer.style.display="none",this.instructionsContainer.style.display="none",this.aboutContainer.style.display="flex",this.Mi.style.display="none")},this.Qe=()=>{this.Y.undo()},this.cleanUp=()=>{this.Li.removeEventListener("click",this.Ci),this.Mi.removeEventListener("click",this.Si)},this.Li.addEventListener("click",this.Ci),this.Mi.addEventListener("click",this.Si)}}const{button:oe,div:re,form:ce,label:le,input:fe}=m;class pe{constructor(t){this.Y=t,this.hasChanged=!1,this.Bi=oe({style:"flex: 1; width: 0;"},"Close"),this.Ri=oe({style:"flex: 1; width: 0;"},"Preview"),this.Ei=re({style:"opacity: 0; position:absolute; left: 8px; top: 24px; font-size: 32px; font-weight:bold;"},"Previewing..."),this.previewExit=re({style:"width: 100vw; height: 100vh; position: fixed; left: 0; top: -2vh; display: flex; pointer-events: none;"},this.Ei),this.Fi=ce({style:"display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; max-height:265px; overflow-y: scroll; overflow-x: hidden;"},le({title:"Default",class:"theme-option"},fe({type:"radio",name:"theme",value:"default",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #606060; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Default"))),le({title:"NepBox",class:"theme-option"},fe({type:"radio",name:"theme",value:"nepbox",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #9150ff; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"NepBox"))),le({title:"ModBox 2.0",class:"theme-option"},fe({type:"radio",name:"theme",value:"modbox2",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #c4ffa3; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"ModBox 2.0"))),le({title:"Artic",class:"theme-option"},fe({type:"radio",name:"theme",value:"artic",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #a5eeff; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Artic"))),le({title:"Cinnamon Roll [!]",class:"theme-option"},fe({type:"radio",name:"theme",value:"Cinnamon Roll",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #f5bb00; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"CinnaBun [!]"))),le({title:"Ocean",class:"theme-option"},fe({type:"radio",name:"theme",value:"Ocean",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #4449a3; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Ocean"))),le({title:"Rainbow [!]",class:"theme-option"},fe({type:"radio",name:"theme",value:"rainbow",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #faa, #ffceaa, #ffdfaa, #fff5aa, #e8ffaa, #bfffb2, #b2ffc8, #b2ffe4, #b2b3ff, #e0b2ff, #ffafe9); border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Rainbow [!]"))),le({title:"Float",class:"theme-option"},fe({type:"radio",name:"theme",value:"float",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: linear-gradient(140deg, #fff, #282828); border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Float [!]"))),le({title:"Windows",class:"theme-option"},fe({type:"radio",name:"theme",value:"windows",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #295294; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Windows"))),le({title:"Grassland",class:"theme-option"},fe({type:"radio",name:"theme",value:"grassland",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #74bc21; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Grassland"))),le({title:"Dessert",class:"theme-option"},fe({type:"radio",name:"theme",value:"dessert",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #fffc5b; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Dessert"))),le({title:"Kahootiest",class:"theme-option"},fe({type:"radio",name:"theme",value:"kahootiest",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #864cbf; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Kahoot"))),le({title:"Beam to the Bit [!]",class:"theme-option"},fe({type:"radio",name:"theme",value:"beambit",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #fa0103; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Beambit [!]"))),le({title:"Pretty Egg",class:"theme-option"},fe({type:"radio",name:"theme",value:"egg",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #ffb1f4; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Pretty Egg"))),le({title:"Poniryoshka",class:"theme-option"},fe({type:"radio",name:"theme",value:"Poniryoshka",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #dabbe6; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Poni"))),le({title:"Gameboy [!]",class:"theme-option"},fe({type:"radio",name:"theme",value:"gameboy",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #306230; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Gameboy [!]"))),le({title:"Woodkid",class:"theme-option"},fe({type:"radio",name:"theme",value:"woodkid",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #41323b; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Woodkid"))),le({title:"Midnight",class:"theme-option"},fe({type:"radio",name:"theme",value:"midnight",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #445566; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Midnight"))),le({title:"Snedbox",class:"theme-option"},fe({type:"radio",name:"theme",value:"snedbox",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #10997e; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Snedbox"))),le({title:"unnamed",class:"theme-option"},fe({type:"radio",name:"theme",value:"unnamed",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #ffffa0; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"unnamed"))),le({title:"Piano",class:"theme-option"},fe({type:"radio",name:"theme",value:"piano",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #bfbfbf; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Piano [!]"))),le({title:"Halloween",class:"theme-option"},fe({type:"radio",name:"theme",value:"halloween",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #914300; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Halloween"))),le({title:"FrozenOver❄️",class:"theme-option"},fe({type:"radio",name:"theme",value:"frozen",style:"display:none;"}),re({style:"display: flex; flex-direction: column; gap: 3px; align-items: center;"},re({style:"background: black; width: 64px; height: 64px; border-radius: 35px; border: solid; border-color:currentColor; display: flex; align-items: center; justify-content: center;"},re({style:"width: 58px; height: 58px; background: #99c8ef; border-radius: 35px;"})),re({style:"text-wrap:wrap; max-width: 64px; color:currentColor;"},"Frozen")))),this.themeContainer=re({class:"prompt",style:"width: 330px; max-height: 600px;"},re({style:"font-size: 2em"},re("Themes")),this.Fi,re({style:"display:flex; flex-direction:row; width:100%; gap: 16px;"},this.Ri,this.Bi)),this.container=re({},this.themeContainer,this.previewExit),this.Qe=()=>{0==this.hasChanged?(window.localStorage.getItem("modboxTheme")?Jt.setTheme(String(window.localStorage.getItem("modboxTheme"))):Jt.setTheme("default"),this.Y.prompt=null,this.Y.undo()):(window.localStorage.setItem("modboxTheme",this.Fi.elements.theme.value),this.Y.prompt=null,this.Y.undo())},this.Pi=()=>{Jt.setTheme(this.Fi.elements.theme.value),this.Fi.elements.theme.value!=window.localStorage.getItem("modboxTheme")?(this.hasChanged=!0,this.Bi.innerHTML="Save"):(this.hasChanged=!1,this.Bi.innerHTML="Cancel")},this.Ni=()=>{this.themeContainer.style.opacity="0",this.previewExit.style.pointerEvents="",this.Ei.style.opacity="1"},this.Ii=()=>{this.themeContainer.style.opacity="1",this.previewExit.style.pointerEvents="none",this.Ei.style.opacity="0"},this.cleanUp=()=>{this.Bi.removeEventListener("click",this.Qe)},this.Bi.addEventListener("click",this.Qe),this.Ri.addEventListener("click",this.Ni),this.previewExit.addEventListener("click",this.Ii),this.Fi.addEventListener("change",this.Pi),null!=window.localStorage.getItem("modboxTheme")&&(this.Fi.elements.theme.value=window.localStorage.getItem("modboxTheme"))}}const{button:de,div:ye,span:be,select:me,option:ue,input:ge,a:we}=m,xe=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);function ve(t,n){for(let e=0;e<n.length;e++)t.appendChild(ue({value:e},n[e]));return t}function ke(t,n){t.selectedIndex!=n&&(t.selectedIndex=n)}class Me{constructor(t,n,e){this.input=t,this.Y=n,this.Di=e,this.pe=null,this.Ti=0,this.Zi=0,this.ji=()=>{this.Y.lastChangeWas(this.pe)||(this.Zi=this.Ti),this.pe=this.Di(this.Zi,parseInt(this.input.value)),this.Y.setProspectiveChange(this.pe)},this.zi=()=>{this.Y.record(this.pe),this.pe=null},t.addEventListener("input",this.ji),t.addEventListener("change",this.zi)}updateValue(t){this.Ti=t,this.input.value=String(t)}}class Le{constructor(t){this.Y=t,this.prompt=null,this.Oi=new $t(this.Y),this.Gi=new nn(this.Y),this.Ui=new sn(this.Y),this.ke=ye({class:"trackContainer"},this.Gi.container,this.Ui.container),this.Vi=new an(this.Y,this.ke),this.Yi=new rn(this.Y),this.Wi=new gn(this.Y),this.Ji=ye({},ye({class:"editorBox",style:"height: 481px; display: flex; flex-direction: row; margin-bottom: 6px;"},this.Wi.container,this.Oi.container,this.Yi.container),this.ke,this.Vi.container),this.Hi=de({style:"width:0; flex:2;",type:"button"}),this.Qi=de({class:"prevBarButton",style:"width: 0; margin: 0px; flex:1; margin-left: 0px;",type:"button",title:"Prev Bar (left bracket)"}),this.Xi=de({class:"nextBarButton",style:"width: 0; margin: 0px; flex:1; margin-left: 0px;",type:"button",title:"Next Bar (right bracket)"}),this.$i=ge({title:"main volume",style:"flex:1; margin: 0px;",type:"range",min:"0",max:"100",value:"50",step:"1"}),this.Ki=me({style:"width: 100%;"},ue({selected:!0,disabled:!0,hidden:!1},"File Menu"),ue({value:"cleanS"},"New Song"),ue({value:"import"},"Import JSON"),ue({value:"export"},"Export Song"),ue({value:"songdata"},"Song Data"),ue({value:"manual"},"Open Manual")),this._i=me({style:"width: 100%;"},ue({selected:!0,disabled:!0,hidden:!1},"Edit Menu"),ue({value:"undo"},"Undo (Z)"),ue({value:"redo"},"Redo (Y)"),ue({value:"copy"},"Copy Pattern (C)"),ue({value:"cut"},"Cut Pattern (X)"),ue({value:"paste"},"Paste Pattern (V)"),ue({value:"transposeUp"},"Shift Notes Up (+)"),ue({value:"transposeDown"},"Shift Notes Down (-)"),ue({value:"duration"},"Custom Song Size (Q)")),this.qi=me({style:"width: 100%;"},ue({selected:!0,disabled:!0,hidden:!1},"Preferences Menu"),ue({value:"autoPlay"},"Auto Play On Load"),ue({value:"autoFollow"},"Auto Follow Track"),ue({value:"showLetters"},"Show Piano"),ue({value:"showFifth"},"Highlight 'Fifth' Notes"),ue({value:"showMore"},"Advanced Color Scheme"),ue({value:"showChannels"},"Show All Channels"),ue({value:"showScrollBar"},"Octave Scroll Bar"),ue({value:"showVolumeBar"},"Show Channel Volume"),ue({value:"advancedSettings"},"Enable Advanced Settings"),ue({value:"themes"},"Set Theme...")),this.ts=de({type:"button"},ye({},"New"),be({class:"fullWidthOnly"},ye({}," Song")),u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},u.path({d:"M 2 0 L 2 -16 L 10 -16 L 14 -12 L 14 0 z M 3 -1 L 13 -1 L 13 -11 L 9 -11 L 9 -15 L 3 -15 z",fill:"currentColor"}))),this.ns=de({type:"button"},ye({},"Song Data"),u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},u.path({d:"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z",fill:"currentColor"}))),this.es=de({type:"button"},be({class:"center"},ye({},"Custom Song Size")),u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},u.path({d:"M -8 2 L -2 2 L -2 8 L 2 8 L 2 2 L 8 2 L 8 -2 L 2 -2 L 2 -8 L -2 -8 L -2 -2 L -8 -2 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z M -8 -8 L 8 -8 L 8 -9 L -8 -9 L -8 -8 z",fill:"currentColor"}))),this.ss=de({type:"button"},be({class:"center"},ye({},"Load Mods...")),u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},u.path({d:"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z",fill:"currentColor"}))),this.hs=de({type:"button",style:"width: 45%; margin: 0px; margin-top: -2px;"},ye({},"Undo")),this.os=de({type:"button",style:"width: 45%; margin: 0px; margin-top: -2px;"},ye({},"Redo")),this.rs=de({type:"button"},ye({},"Export"),u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},u.path({d:"M -8 3 L -8 8 L 8 8 L 8 3 L 6 3 L 6 6 L -6 6 L -6 3 z M 0 2 L -4 -2 L -1 -2 L -1 -8 L 1 -8 L 1 -2 L 4 -2 z",fill:"currentColor"}))),this.cs=ve(me({}),s.scaleNames),this.ls=ve(me({}),s.mixNames),this.fs=ve(me({}),s.sampleRateNames),this.ps=we({class:"hintButton"},ye({},"?")),this.ds=we({class:"hintButton"},ye({},"?")),this.ys=ye({class:"selectRow"},this.ps,this.ls),this.bs=we({class:"hintButton"},ye({},"?")),this.us=ve(me({}),s.keyNames),this.gs=ve(me({}),s.themeNames),this.ws=new Me(ge({style:"margin: 0px;",type:"range",min:"0",max:s.tempoSteps-1,value:"7",step:"1"}),this.Y,((t,n)=>new Pt(this.Y,t,n))),this.xs=new Me(ge({style:"margin: 0px;",type:"range",min:"0",max:s.reverbRange-1,value:"0",step:"1"}),this.Y,((t,n)=>new Nt(this.Y,t,n))),this.vs=new Me(ge({style:"width: 9em; margin: 0px;",type:"range",min:"0",max:s.blendRange-1,value:"0",step:"1"}),this.Y,((t,n)=>new It(this.Y,t,n))),this.ks=new Me(ge({style:"width: 9em; margin: 0px;",type:"range",min:"0",max:s.riffRange-1,value:"0",step:"1"}),this.Y,((t,n)=>new Dt(this.Y,t,n))),this.Ms=new Me(ge({style:"width: 9em; margin: 0px;",type:"range",min:"0",max:s.detuneRange-1,value:"0",step:"1"}),this.Y,((t,n)=>new Tt(this.Y,t,n))),this.Ls=new Me(ge({style:"width: 9em; margin: 0px;",type:"range",min:"0",max:s.muffRange-1,value:"0",step:"1"}),this.Y,((t,n)=>new Zt(this.Y,t,n))),this.Cs=de({style:"width: 27px;",type:"button"}),this.As=de({style:"width: 27px;",type:"button"}),this.Ss=ve(me({}),s.partNames),this.Bs=function(t,n,e){if(n.length!=e.length)throw new Error("items and values don't have the same length");for(let i=0;i<n.length;i++){const s=n[i],h=e[i];t.appendChild(ue({value:h},s))}return t}(me({}),s.pitchChannelTypeNames,s.pitchChannelTypeValues),this.Rs=ye({class:"selectRow"},be({},ye({},"Type: ")),this.bs,ye({class:"selectContainer"},this.Bs)),this.Es=ve(me({}),s.operatorAlgorithmNames),this.Fs=ye({class:"selectRow"},be({},ye({},"Algorithm: ")),ye({class:"selectContainer"},this.Es)),this.Ps=me({}),this.Ns=ye({class:"selectRow",style:"display: none;"},be({},ye({},"Instrument: ")),ye({class:"selectContainer"},this.Ps)),this.Is=new Me(ge({style:"margin: 8px; width: 60px;",type:"range",min:"-9",max:"0",value:"0",step:"1"}),this.Y,((t,n)=>new Vt(this.Y,t,-n))),this.Ds=new Me(ge({style:"margin: 8px; width: 60px;",type:"range",min:"-5",max:"0",value:"0",step:"1"}),this.Y,((t,n)=>new Vt(this.Y,t,-n))),this.Ts=ye({class:"selectRow"},be({},ye({},"Volume: ")),this.Is.input,this.Cs),this.Zs=ye({class:"selectRow"},be({},ye({},"Volume: ")),this.Ds.input,this.As),this.js=ye({style:"margin: 3px 0; text-align: center;"},ye({},"Instrument Settings")),this.zs=ye({style:"margin: 3px 0; text-align: center;"},ye({},"Advanced Instrument Settings")),this.Os=ve(me({}),s.waveNames),this.Gs=ve(me({}),s.drumNames),this.Us=ve(me({}),s.pwmwaveNames),this.Vs=ye({class:"selectRow"},be({},ye({},"Wave: ")),ye({class:"selectContainer"},this.Os,this.Us,this.Gs)),this.Ys=ve(me({}),s.transitionNames),this.Ws=ve(me({}),s.filterNames),this.Js=ye({class:"selectRow"},be({},ye({},"Filter: ")),ye({class:"selectContainer"},this.Ws)),this.Hs=ve(me({}),s.chorusNames),this.Qs=we({class:"hintButton"},ye({},"?")),this.Xs=ye({class:"selectRow"},be({},ye({},"Chorus: ")),ye({class:"selectContainer"},this.Hs)),this.$s=ve(me({}),s.effectNames),this.Ks=ye({class:"selectRow"},be({},ye({},"Effect: ")),ye({class:"selectContainer"},this.$s)),this._s=ve(me({}),s.harmDisplay),this.qs=ye({class:"selectRow"},be({},ye({},"Chord: ")),this.Qs,ye({class:"selectContainer"},this._s)),this.th=ve(me({}),s.octoffNames),this.nh=ye({class:"selectRow"},be({},ye({},"Octave Offset: ")),ye({class:"selectContainer"},this.th)),this.eh=ve(me({}),s.fmChorusDisplay),this.ih=ye({class:"selectRow"},be({},ye({},"FM Chorus: ")),ye({class:"selectContainer"},this.eh)),this.sh=new Me(ge({style:"margin: 8px; width: 100px;",type:"range",min:"-8",max:"0",value:"0",step:"1"}),this.Y,((t,n)=>new st(this.Y,t,-n))),this.hh=ye({class:"selectRow"},be({},ye({},"Panning: ")),be({},ye({},"L")),this.sh.input,be({},ye({},"R"))),this.ah=ye({style:"display: flex; flex-direction: column; display: none;"}),this.oh=ve(me({}),s.operatorFeedbackNames),this.rh=ye({class:"selectRow"},be({},ye({},"Feedback:")),ye({class:"selectContainer"},this.oh)),this.fh=new Me(ge({style:"margin: 0px; width: 4em;",type:"range",min:"0",max:s.operatorAmplitudeMax,value:"0",step:"1",title:"Feedback Amplitude"}),this.Y,((t,n)=>new pt(this.Y,t,n))),this.ph=ve(me({style:"width: 100%;",title:"Feedback Envelope"}),s.operatorEnvelopeNames),this.dh=ye({class:"operatorRow"},ye({style:"margin-right: .1em; visibility: hidden;"},ye({},"1.")),ye({style:"width: 3em; margin-right: .3em;"}),this.fh.input,ye({class:"selectContainer",style:"width: 5em; margin-left: .3em;"},this.ph)),this.yh=ye({},this.js,this.Ns,this.Rs,this.Zs,this.Ts,this.Vs,ye({class:"selectRow"},be({},ye({},"Transitions: ")),ye({class:"selectContainer"},this.Ys)),this.Js,this.Xs,this.Ks,this.Fs,this.ah,this.rh,this.dh),this.bh=ye({},this.zs,this.hh,this.qs,this.nh,this.ih),this.mh=ye({class:"promptContainer",id:"promptContainer",style:"display: none;"}),this.uh=ye({class:"editor-song-settings",style:"margin: 0px 5px;"},ye({style:"margin: 3px 0; text-align: center;"},ye({},"Advanced Song Settings")),ye({class:"selectRow"},be({},ye({},"Mix: ")),ye({class:"selectContainer"},this.ys)),ye({class:"selectRow"},be({},ye({},"Sample Rate: ")),ye({class:"selectContainer"},this.fs)),ye({class:"selectRow"},be({},ye({},"Blending: ")),this.vs.input),ye({class:"selectRow"},be({},ye({},"Riff: ")),this.ks.input),ye({class:"selectRow"},be({},ye({},"Detune: ")),this.Ms.input),ye({class:"selectRow"},be({},ye({},"Muff: ")),this.Ls.input)),this.gh=ye({class:"editor-right-widget-column",style:"margin: 0px 5px;"},ye({class:"editor-widgets"},ye({style:"text-align: center;"},ye({},"Advanced Settings")),ye({style:"margin: 2px 0; display: flex; flex-direction: row; align-items: center;"}),ye({class:"editor-menus"},ye({style:"margin: 5px 0; display: flex; flex-direction: row; justify-content: space-between;"},this.Qi,this.hs,this.os,this.Xi)),ye({class:"editor-settings"},this.uh,ye({class:"editor-instrument-settings"},this.bh)))),this.mainLayer=ye({class:"beepboxEditor",tabIndex:"0"},this.Ji,ye({class:"editor-widget-column"},ye({style:"align-items: center; display: flex; justify-content: center;"},ye({},"NepBox 2.0"),this.ds),ye({style:"margin: 5px 0; gap: 3px; display: flex; flex-direction: column; align-items: center;"},ye({style:"display:flex; flex-direction:row;"},u.svg({width:"2em",height:"2em",viewBox:"0 0 26 26"},u.path({d:"M 4 17 L 4 9 L 8 9 L 12 5 L 12 21 L 8 17 z",fill:Jt.volumeIcon}),u.path({d:"M 15 11 L 16 10 A 7.2 7.2 0 0 1 16 16 L 15 15 A 5.8 5.8 0 0 0 15 12 z",fill:Jt.volumeIcon}),u.path({d:"M 18 8 L 19 7 A 11.5 11.5 0 0 1 19 19 L 18 18 A 10.1 10.1 0 0 0 18 8 z",fill:Jt.volumeIcon})),this.$i),ye({style:"display: flex; flex-direction: row; align-items: center; width:100%; gap: 3px;"},this.Hi,this.Qi,this.Xi)),ye({class:"editor-widgets"},ye({class:"editor-menus"},ye({class:"selectContainer menu"},this.Ki,u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},u.path({d:"M 0 0 L 16 0 L 16 -13 L 10 -13 L 8 -16 L 0 -16 L 0 -13 z",fill:"currentColor"}))),ye({class:"selectContainer menu"},this._i,u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-5 -21 26 26"},u.path({d:"M 0 0 L 1 -4 L 4 -1 z M 2 -5 L 10 -13 L 13 -10 L 5 -2 zM 11 -14 L 13 -16 L 14 -16 L 16 -14 L 16 -13 L 14 -11 z",fill:"currentColor"}))),ye({class:"selectContainer menu"},this.qi,u.svg({style:"flex-shrink: 0; position: absolute; left: 0; top: 50%; margin-top: -1em; pointer-events: none;",width:"2em",height:"2em",viewBox:"-13 -13 26 26"},u.path({d:"M 5.78 -1.6 L 7.93 -0.94 L 7.93 0.94 L 5.78 1.6 L 4.85 3.53 L 5.68 5.61 L 4.21 6.78 L 2.36 5.52 L 0.27 5.99 L -0.85 7.94 L -2.68 7.52 L -2.84 5.28 L -4.52 3.95 L -6.73 4.28 L -7.55 2.59 L -5.9 1.07 L -5.9 -1.07 L -7.55 -2.59 L -6.73 -4.28 L -4.52 -3.95 L -2.84 -5.28 L -2.68 -7.52 L -0.85 -7.94 L 0.27 -5.99 L 2.36 -5.52 L 4.21 -6.78 L 5.68 -5.61 L 4.85 -3.53 M 2.92 0.67 L 2.92 -0.67 L 2.35 -1.87 L 1.3 -2.7 L 0 -3 L -1.3 -2.7 L -2.35 -1.87 L -2.92 -0.67 L -2.92 0.67 L -2.35 1.87 L -1.3 2.7 L -0 3 L 1.3 2.7 L 2.35 1.87 z",fill:"currentColor"})))),ye({class:"editor-settings"},ye({class:"editor-song-settings"},ye({style:"margin: 3px 0; text-align: center; color: #999;"},ye({},"Song Settings")),ye({class:"selectRow"},be({},ye({},"Scale: ")),ye({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.cs)),ye({class:"selectRow"},be({},ye({},"Key: ")),ye({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.us)),ye({class:"selectRow"},be({},ye({},"Tempo: ")),this.ws.input),ye({class:"selectRow"},be({},ye({},"Reverb: ")),this.xs.input),ye({class:"selectRow"},be({},ye({},"Rhythm: ")),ye({class:"selectContainer",style:"margin: 3px 0; text-align: center; color: #ccc;"},this.Ss))),ye({class:"editor-instrument-settings"},this.yh)))),this.gh,this.mh),this.wh=null,this.xh=[],this.kh=[],this.Mh=[],this.Lh=[],this.Ch=()=>{this.mainLayer.focus()},this.whenUpdated=()=>{const t=this.ke.getBoundingClientRect();this.Y.trackVisibleBars=Math.floor((t.right-t.left)/32),this.Vi.render(),this.Gi.render(),this.Oi.render();const n=[(this.Y.autoPlay?"✓ ":"✗ ")+"Auto Play On Load",(this.Y.autoFollow?"✓ ":"✗ ")+"Auto Follow Track",(this.Y.showLetters?"✓ ":"✗ ")+"Show Piano",(this.Y.showFifth?"✓ ":"✗ ")+"Highlight 'Fifth' Notes",(this.Y.showMore?"✓ ":"✗ ")+"Advanced Color Scheme",(this.Y.showChannels?"✓ ":"✗ ")+"Show All Channels",(this.Y.showScrollBar?"✓ ":"✗ ")+"Octave Scroll Bar",(this.Y.showVolumeBar?"✓ ":"✗ ")+"Show Channel Volume",(this.Y.advancedSettings?"✓ ":"✗ ")+"Enable Advanced Settings","  Set Theme..."];for(let t=0;t<n.length;t++){const e=this.qi.children[t+1];e.innerText!=n[t]&&(e.innerText=n[t])}const e=this.Y.song.channels[this.Y.channel],i=this.Y.getCurrentPattern(),h=this.Y.getCurrentInstrument(),a=e.instruments[h],o=this.mainLayer.contains(document.activeElement);let r=(document.activeElement,document.activeElement);if(ke(this.gs,this.Y.song.theme),ke(this.cs,this.Y.song.scale),ke(this.ls,this.Y.song.mix),ke(this.fs,this.Y.song.sampleRate),ke(this.us,this.Y.song.key),this.ws.updateValue(this.Y.song.tempo),this.ws.input.title=this.Y.song.getBeatsPerMinute()+" beats per minute",this.xs.updateValue(this.Y.song.reverb),this.gh.style.display=this.Y.advancedSettings?"":"none",this.vs.updateValue(this.Y.song.blend),this.ks.updateValue(this.Y.song.riff),this.Ms.updateValue(this.Y.song.detune),this.Ls.updateValue(this.Y.song.muff),ke(this.Ss,s.partCounts.indexOf(this.Y.song.partsPerBeat)),this.Y.song.getChannelIsDrum(this.Y.channel)?(2==this.Y.song.mix?(this.Ts.style.display="",this.Zs.style.display="none"):(this.Ts.style.display="none",this.Zs.style.display=""),this.Gs.style.display="",this.Vs.style.display="",this.Rs.style.display="none",this.Bs.style.display="none",this.Fs.style.display="none",this.ah.style.display="none",this.rh.style.display="none",this.dh.style.display="none",this.Os.style.display="none",this.Us.style.display="none",this.Js.style.display="none",this.Xs.style.display="none",this.Ks.style.display="none",this.hh.style.display="",this.qs.style.display="",this.nh.style.display="",this.ih.style.display="none"):(this.Rs.style.display="",this.Bs.style.display="",this.Ks.style.display="",2==this.Y.song.mix?(this.Ts.style.display="",this.Zs.style.display="none"):(this.Ts.style.display="none",this.Zs.style.display=""),this.Gs.style.display="none",0==a.type?(this.Os.style.display="",this.Us.style.display="none",this.Vs.style.display="",this.Js.style.display="",this.Xs.style.display="",this.qs.style.display="",this.Fs.style.display="none",this.ah.style.display="none",this.rh.style.display="none",this.dh.style.display="none",this.hh.style.display="",this.nh.style.display="",this.ih.style.display="none"):3==a.type?(this.Os.style.display="none",this.Us.style.display="",this.Vs.style.display="",this.Js.style.display="none",this.Xs.style.display="none",this.qs.style.display="none",this.Fs.style.display="none",this.ah.style.display="none",this.rh.style.display="none",this.dh.style.display="none",this.hh.style.display="",this.nh.style.display="",this.ih.style.display="none"):(this.Fs.style.display="",this.ah.style.display="",this.rh.style.display="",this.dh.style.display="",this.qs.style.display="none",this.Vs.style.display="none",this.Js.style.display="none",this.Xs.style.display="none",this.hh.style.display="",this.nh.style.display="",this.ih.style.display="")),this.Bs.value=a.type+"",ke(this.Es,a.algorithm),this.Ns.style.display=this.Y.song.instrumentsPerChannel>1?"":"none",this.Ns.style.visibility=null==i?"hidden":"",this.Ps.children.length!=this.Y.song.instrumentsPerChannel){for(;this.Ps.firstChild;)this.Ps.removeChild(this.Ps.firstChild);const t=[];for(let n=0;n<this.Y.song.instrumentsPerChannel;n++)t.push(n+1);ve(this.Ps,t)}0==a.imute?(this.yh.style.color=this.Y.song.getNoteColorBright(this.Y.channel),this.bh.style.color=this.Y.song.getNoteColorDim(this.Y.channel),this.uh.style.color="#aaaaaa",this.Cs.innerText="◉",this.As.innerText="◉"):(this.yh.style.color="#cccccc",this.bh.style.color="#aaaaaa",this.uh.style.color="#aaaaaa",this.Cs.innerText="◎",this.As.innerText="◎"),ke(this.Os,a.wave),ke(this.Gs,a.wave),ke(this.Us,a.wave),ke(this.Ws,a.filter),ke(this.Ys,a.transition),ke(this.$s,a.effect),ke(this.Hs,a.chorus),ke(this._s,a.harm),ke(this.th,a.octoff),ke(this.eh,a.fmChorus),ke(this.oh,a.feedbackType),this.fh.updateValue(a.feedbackAmplitude),ke(this.ph,a.feedbackEnvelope),this.ph.parentElement.style.color=a.feedbackAmplitude>0?"":"#999",this.Is.updateValue(-a.volume),this.Ds.updateValue(-a.volume),this.sh.updateValue(-a.ipan),ke(this.Ps,h);for(let t=0;t<s.operatorCount;t++){const n=t<s.operatorCarrierCounts[a.algorithm];this.xh[t].style.color=n?"white":"",ke(this.Lh[t],a.operators[t].frequency),this.kh[t].updateValue(a.operators[t].amplitude),ke(this.Mh[t],a.operators[t].envelope);const e=(n?"Voice ":"Modulator ")+(t+1);this.Lh[t].title=e+" Frequency",this.kh[t].input.title=e+(n?" Volume":" Amplitude"),this.Mh[t].title=e+" Envelope",this.Mh[t].parentElement.style.color=a.operators[t].amplitude>0?"":"#999"}this.Wi.container.style.display=this.Y.showLetters?"":"none",this.Yi.container.style.display=this.Y.showScrollBar?"":"none",this.Vi.container.style.display=this.Y.song.barCount>this.Y.trackVisibleBars?"":"none",this.bs.style.display=1==a.type?"":"none",this.ps.style.display=1!=this.Y.song.mix?"":"none",this.Qs.style.display=s.harmNames[a.harm]?"":"none";let c=512;this.Y.showLetters&&(c-=32),this.Y.showScrollBar&&(c-=20),this.Oi.container.style.width=String(c)+"px",this.$i.value=String(this.Y.volume),o&&0==r.clientWidth&&this.Ch(),this.Ah(this.Y.prompt),this.Y.autoFollow&&!this.Y.synth.playing&&this.Y.synth.snapToBar(this.Y.bar)},this.Sh=()=>{const t=this.Y.song.channels[this.Y.channel],n=this.Y.getCurrentInstrument(),e=t.instruments[n],i=1==e.imute?0:1;this.Y.record(new it(this.Y,i)),0==e.imute?(this.yh.style.color=this.Y.song.getNoteColorBright(this.Y.channel),this.bh.style.color=this.Y.song.getNoteColorDim(this.Y.channel),this.uh.style.color="#aaaaaa",this.Cs.innerText="◉",this.As.innerText="◉"):(this.yh.style.color="#cccccc",this.bh.style.color="#aaaaaa",this.uh.style.color="#aaaaaa",this.Cs.innerText="◎",this.As.innerText="◎"),this.whenUpdated()},this.Bh=t=>{if(this.prompt)27==t.keyCode&&window.history.back();else switch(t.keyCode){case 8:t.ctrlKey?this.Y.record(new $(this.Y,this.Y.channel,this.Y.channel)):this.Y.record(new W(this.Y,this.Y.bar,1)),t.preventDefault();break;case 13:t.ctrlKey?(this.Y.record(new X(this.Y,this.Y.channel+1,this.Y.song.getChannelIsDrum(this.Y.channel))),this.Y.channel=this.Y.channel+1):this.Y.record(new Y(this.Y,this.Y.bar+1,1)),t.preventDefault();break;case 38:this.Gi.se((this.Y.channel-1+this.Y.song.getChannelCount())%this.Y.song.getChannelCount(),this.Y.bar),t.preventDefault();break;case 40:this.Gi.se((this.Y.channel+1)%this.Y.song.getChannelCount(),this.Y.bar),t.preventDefault();break;case 37:this.Gi.se(this.Y.channel,(this.Y.bar+this.Y.song.barCount-1)%this.Y.song.barCount),t.preventDefault();break;case 39:this.Gi.se(this.Y.channel,(this.Y.bar+1)%this.Y.song.barCount),t.preventDefault();break;case 48:this.Gi.ae("0"),t.preventDefault();break;case 49:this.Gi.ae("1"),t.preventDefault();break;case 50:this.Gi.ae("2"),t.preventDefault();break;case 51:this.Gi.ae("3"),t.preventDefault();break;case 52:this.Gi.ae("4"),t.preventDefault();break;case 53:this.Gi.ae("5"),t.preventDefault();break;case 54:this.Gi.ae("6"),t.preventDefault();break;case 55:this.Gi.ae("7"),t.preventDefault();break;case 56:this.Gi.ae("8"),t.preventDefault();break;case 57:this.Gi.ae("9"),t.preventDefault();break;default:this.Gi.Qn="";break;case 77:this.Sh(),t.preventDefault();break;case 32:this.Rh(),t.preventDefault();break;case 90:t.shiftKey?this.Y.redo():this.Y.undo(),t.preventDefault();break;case 89:this.Y.redo(),t.preventDefault();break;case 88:this.Eh(),t.preventDefault();break;case 67:this.Fh(),t.preventDefault();break;case 70:t.shiftKey?this.Y.synth.snapToBar(this.Y.song.loopStart):this.Y.synth.snapToStart(),t.preventDefault();break;case 86:this.Ph(),t.preventDefault();break;case 219:this.Y.synth.prevBar(),this.Y.autoFollow&&new K(this.Y,this.Y.channel,Math.floor(this.Y.synth.playhead)),t.preventDefault();break;case 221:this.Y.synth.nextBar(),this.Y.autoFollow&&new K(this.Y,this.Y.channel,Math.floor(this.Y.synth.playhead)),t.preventDefault();break;case 189:case 173:this.Nh(!1),t.preventDefault();break;case 187:case 61:this.Nh(!0),t.preventDefault();break;case 81:this.Ih("duration"),t.preventDefault()}},this.Dh=()=>{this.Y.synth.prevBar()},this.Th=()=>{this.Y.synth.nextBar()},this.Rh=()=>{this.Y.synth.playing?this.Zh():this.jh()},this.zh=()=>{this.Y.setVolume(Number(this.$i.value)),this.Gi.render()},this.Oh=()=>{this.Y.record(new Ft(this.Y,"")),this.Oi.resetCopiedPins()},this.Gh=()=>{this.Ih("duration")},this.Uh=()=>{this.Y.undo()},this.Vh=()=>{this.Y.redo()},this.Yh=()=>{this.Ih("export")},this.Wh=()=>{this.Ih("songdata")},this.Jh=()=>{this.Ih("instrumentType")},this.Hh=()=>{this.Ih("mix")},this.Qh=()=>{this.Ih("chorus")},this.Xh=()=>{this.Ih("archive")},this.refreshNow=()=>{setTimeout((()=>{location.reload()}),500)},this.$h=()=>{this.Ih("refresh")},this.Kh=()=>{this.Y.record(new Bt(this.Y,this.cs.selectedIndex))},this._h=()=>{this.Y.record(new Rt(this.Y,this.ls.selectedIndex))},this.qh=()=>{this.Y.record(new Et(this.Y,this.fs.selectedIndex))},this.ta=()=>{19==this.Y.song.theme?this.Ih("refresh key"):this.Y.record(new yt(this.Y,this.us.selectedIndex))},this.na=()=>{this.Y.record(new wt(this.Y,s.partCounts[this.Ss.selectedIndex]))},this.ea=()=>{this.Y.record(new O(this.Y,+this.Bs.value))},this.ia=()=>{this.Y.record(new ot(this.Y,this.oh.selectedIndex))},this.sa=()=>{this.Y.record(new rt(this.Y,this.ph.selectedIndex))},this.ha=()=>{this.Y.record(new at(this.Y,this.Es.selectedIndex))},this.aa=()=>{const t=this.Y.getCurrentPattern();null!=t&&this.Y.record(new vt(this.Y,this.Ps.selectedIndex,t))},this.oa=()=>{this.Y.record(new Wt(this.Y,this.Os.selectedIndex))},this.ra=()=>{this.Y.record(new Wt(this.Y,this.Gs.selectedIndex))},this.ca=()=>{this.Y.record(new Wt(this.Y,this.Us.selectedIndex))},this.la=()=>{this.Y.record(new ht(this.Y,this.Ws.selectedIndex))},this.fa=()=>{this.Y.record(new G(this.Y,this.Ys.selectedIndex))},this.pa=()=>{this.Y.record(new q(this.Y,this.$s.selectedIndex))},this.da=()=>{this.Y.record(new tt(this.Y,this._s.selectedIndex))},this.ya=()=>{this.Y.record(new nt(this.Y,this.eh.selectedIndex))},this.ba=()=>{this.Y.record(new et(this.Y,this.th.selectedIndex))},this.ma=()=>{this.Y.record(new _(this.Y,this.Hs.selectedIndex))},this.ua=t=>{switch(this.Ki.value){case"import":this.Ih("import");break;case"export":this.Ih("export");break;case"cleanS":this.Oh();break;case"songdata":this.Ih("songdata");break;case"manual":this.Ih("manual")}this.Ki.selectedIndex=0},this.ga=t=>{switch(this._i.value){case"undo":this.Y.undo();break;case"redo":this.Y.redo();break;case"cut":this.Eh();break;case"copy":this.Fh();break;case"paste":this.Ph();break;case"transposeUp":this.Nh(!0);break;case"transposeDown":this.Nh(!1);break;case"duration":this.Ih("duration");break;case"archive":this.Ih("archive")}this._i.selectedIndex=0},this.wa=t=>{switch(this.qi.value){case"autoPlay":this.Y.autoPlay=!this.Y.autoPlay;break;case"autoFollow":this.Y.autoFollow=!this.Y.autoFollow;break;case"showLetters":this.Y.showLetters=!this.Y.showLetters;break;case"showFifth":this.Y.showFifth=!this.Y.showFifth;break;case"showMore":this.Y.showMore=!this.Y.showMore;break;case"showChannels":this.Y.showChannels=!this.Y.showChannels;break;case"showScrollBar":this.Y.showScrollBar=!this.Y.showScrollBar;break;case"showVolumeBar":this.Y.showVolumeBar=!this.Y.showVolumeBar;break;case"advancedSettings":this.Y.advancedSettings=!this.Y.advancedSettings;break;case"themes":this.Ih("themes")}this.qi.selectedIndex=0,this.Y.notifier.changed(),this.Y.savePreferences()},this.Y.notifier.watch(this.whenUpdated),this.ah.appendChild(ye({class:"operatorRow",style:"height: 1em; margin-top: 0.5em;"},ye({style:"margin-right: .1em; visibility: hidden;"},ye({},"1.")),ye({style:"width: 3em; margin-right: .3em;"},ye({},"Freq:")),ye({style:"width: 4em; margin: 0;"},ye({},"Volume:")),ye({style:"width: 5em; margin-left: .3em;"},ye({},"Envelope:"))));for(let t=0;t<s.operatorCount;t++){const n=t,e=ye({style:"margin-right: .1em; color: #999;"},ye({},t+1+".")),i=ve(me({style:"width: 100%;",title:"Frequency"}),s.operatorFrequencyNames),h=new Me(ge({style:"margin: 0; width: 4em;",type:"range",min:"0",max:s.operatorAmplitudeMax,value:"0",step:"1",title:"Volume"}),this.Y,((t,e)=>new ft(this.Y,n,t,e))),a=ve(me({style:"width: 100%;",title:"Envelope"}),s.operatorEnvelopeNames),o=ye({class:"operatorRow"},e,ye({class:"selectContainer",style:"width: 3em; margin-right: .3em;"},i),h.input,ye({class:"selectContainer",style:"width: 5em; margin-left: .3em;"},a));this.ah.appendChild(o),this.xh[t]=o,this.kh[t]=h,this.Mh[t]=a,this.Lh[t]=i,a.addEventListener("change",(()=>{this.Y.record(new ct(this.Y,n,a.selectedIndex))})),i.addEventListener("change",(()=>{this.Y.record(new lt(this.Y,n,i.selectedIndex))}))}this.Ki.addEventListener("change",this.ua),this._i.addEventListener("change",this.ga),this.qi.addEventListener("change",this.wa),this.gs.addEventListener("change",this.$h),this.cs.addEventListener("change",this.Kh),this.ls.addEventListener("change",this._h),this.fs.addEventListener("change",this.qh),this.us.addEventListener("change",this.ta),this.Ss.addEventListener("change",this.na),this.Bs.addEventListener("change",this.ea),this.Es.addEventListener("change",this.ha),this.Ps.addEventListener("change",this.aa),this.oh.addEventListener("change",this.ia),this.ph.addEventListener("change",this.sa),this.Os.addEventListener("change",this.oa),this.Gs.addEventListener("change",this.ra),this.Us.addEventListener("change",this.ca),this.Ys.addEventListener("change",this.fa),this.Ws.addEventListener("change",this.la),this.Hs.addEventListener("change",this.ma),this.$s.addEventListener("change",this.pa),this._s.addEventListener("change",this.da),this.th.addEventListener("change",this.ba),this.eh.addEventListener("change",this.ya),this.Cs.addEventListener("click",this.Sh),this.As.addEventListener("click",this.Sh),this.Hi.addEventListener("click",this.Rh),this.Qi.addEventListener("click",this.Dh),this.Xi.addEventListener("click",this.Th),this.ts.addEventListener("click",this.Oh),this.ns.addEventListener("click",this.Wh),this.es.addEventListener("click",this.Gh),this.hs.addEventListener("click",this.Uh),this.os.addEventListener("click",this.Vh),this.rs.addEventListener("click",this.Yh),this.ss.addEventListener("click",this.Xh),this.$i.addEventListener("input",this.zh),this.bs.addEventListener("click",this.Jh),this.ps.addEventListener("click",this.Hh),this.Qs.addEventListener("click",this.Qh),this.ds.addEventListener("click",this.Xh),this.Ji.addEventListener("mousedown",this.Ch),this.mainLayer.addEventListener("keydown",this.Bh),xe&&(this.qi.children[1].disabled=!0)}Ih(t){this.Y.openPrompt(t),this.Ah(t)}Ah(t){if(this.prompt&&(this.xa&&this.jh(),this.xa=!1,this.mh.style.display="none",this.mh.removeChild(this.prompt.container),this.prompt.cleanUp(),this.prompt=null,this.mainLayer.focus()),t){switch(t){case"export":this.prompt=new Rn(this.Y);break;case"import":this.prompt=new Nn(this.Y);break;case"duration":this.prompt=new Kn(this.Y);break;case"archive":case"archive":this.prompt=new Zn(this.Y);break;case"instrumentType":this.prompt=new ne(this.Y);break;case"mix":this.prompt=new vn(this.Y);break;case"chorus":this.prompt=new Ln(this.Y);break;case"songdata":this.prompt=new Vn(this.Y);break;case"refresh":this.prompt=new On(this.Y,this,this.gs.selectedIndex);break;case"refresh key":this.prompt=new Jn(this.Y,this,this.us.selectedIndex);break;case"manual":this.prompt=new ae(this.Y);break;case"themes":this.prompt=new pe(this.Y);break;default:throw new Error("Unrecognized prompt type.")}this.prompt&&(this.xa=this.Y.synth.playing,this.Zh(),this.mh.style.display="",this.mh.appendChild(this.prompt.container))}}updatePlayButton(){this.Y.synth.playing?(this.Hi.classList.remove("playButton"),this.Hi.classList.add("pauseButton"),this.Hi.title="Pause (Space)",this.Hi.innerText="Pause"):(this.Hi.classList.remove("pauseButton"),this.Hi.classList.add("playButton"),this.Hi.title="Play (Space)",this.Hi.innerText="Play")}jh(){this.Y.synth.play(),this.updatePlayButton()}Zh(){this.Y.synth.pause(),this.Y.autoFollow?this.Y.synth.snapToBar(this.Y.bar):this.Y.synth.snapToBar(),this.updatePlayButton()}Eh(){const t=this.Y.getCurrentPattern();null!=t&&(window.localStorage.setItem("patternCopy",JSON.stringify({notes:t.notes,beatsPerBar:this.Y.song.beatsPerBar,partsPerBeat:this.Y.song.partsPerBeat,drums:this.Y.song.getChannelIsDrum(this.Y.channel)})),this.Y.record(new xt(this.Y,t,[],this.Y.song.beatsPerBar,this.Y.song.partsPerBeat)))}Fh(){const t=this.Y.getCurrentPattern();let n=[];null!=t&&(n=t.notes);const e={notes:n,beatsPerBar:this.Y.song.beatsPerBar,partsPerBeat:this.Y.song.partsPerBeat,drums:this.Y.song.getChannelIsDrum(this.Y.channel)};window.localStorage.setItem("patternCopy",JSON.stringify(e))}Ph(){const t=JSON.parse(String(window.localStorage.getItem("patternCopy")));if(null!=t&&t.drums==this.Y.song.getChannelIsDrum(this.Y.channel)){new Mt(this.Y);const n=this.Y.getCurrentPattern();if(null==n)throw new Error;this.Y.record(new xt(this.Y,n,t.notes,t.beatsPerBar,t.partsPerBeat))}}Nh(t){const n=this.Y.getCurrentPattern();if(null==n)return;const e=this.Y.lastChangeWas(this.wh);this.wh=new Ut(this.Y,n,t),this.Y.record(this.wh,e)}}class Ce{constructor(){this.va=[],this.ka=!1}watch(t){-1==this.va.indexOf(t)&&this.va.push(t)}unwatch(t){const n=this.va.indexOf(t);-1!=n&&this.va.splice(n,1)}changed(){this.ka=!0}notifyWatchers(){if(this.ka){this.ka=!1;for(const t of this.va.concat())t()}}}class Ae{constructor(t){this.notifier=new Ce,this.channel=0,this.bar=0,this.volume=75,this.trackVisibleBars=16,this.barScrollPos=0,this.prompt=null,this.Ma=null,this.La=0,this.Ca=0,this.Aa=0,this.Sa=!1,this.Ba=!1,this.Ra=()=>{let t=window.history.state;t&&t.sequenceNumber==this.La||(null==t?(this.La++,t={canUndo:!0,sequenceNumber:this.La,bar:this.bar,channel:this.channel,prompt:this.prompt},new Ft(this,location.hash),window.history.replaceState(t,"","#"+this.song.toBase64String())):(t.sequenceNumber==this.La-1?(this.bar=this.Ca,this.channel=this.Aa):t.sequenceNumber!=this.La&&(this.bar=t.bar,this.channel=t.channel),this.La=t.sequenceNumber,this.prompt=t.prompt,new Ft(this,location.hash)),this.Ca=t.bar,this.Aa=t.channel,this.forgetLastChange(),this.notifier.notifyWatchers())},this.Ea=()=>{this.notifier.notifyWatchers()},this.Fa=()=>{this.Ba=!1;const t="#"+this.song.toBase64String();let n;this.Sa?(this.La++,n={canUndo:!0,sequenceNumber:this.La,bar:this.bar,channel:this.channel,prompt:this.prompt},window.history.pushState(n,"",t)):(n={canUndo:!0,sequenceNumber:this.La,bar:this.bar,channel:this.channel,prompt:this.prompt},window.history.replaceState(n,"",t)),this.Ca=n.bar,this.Aa=n.channel,this.Sa=!1},this.song=new P(t),this.synth=new I(this.song),this.autoPlay="true"==localStorage.getItem("autoPlay"),this.autoFollow="true"==localStorage.getItem("autoFollow"),this.showFifth="true"==localStorage.getItem("showFifth"),this.showMore="true"==localStorage.getItem("showMore"),this.showLetters="true"==localStorage.getItem("showLetters"),this.showChannels="true"==localStorage.getItem("showChannels"),this.showScrollBar="true"==localStorage.getItem("showScrollBar"),this.showVolumeBar="true"==localStorage.getItem("showVolumeBar"),this.advancedSettings="false"!=localStorage.getItem("advancedSettings"),null!=localStorage.getItem("volume")&&(this.volume=Number(localStorage.getItem("volume"))),this.synth.volume=this.Pa(),null!=window.localStorage.getItem("modboxTheme")?Jt.setTheme(String(window.localStorage.getItem("modboxTheme"))):(window.localStorage.setItem("modboxTheme","default"),Jt.setTheme("default"));let n=window.history.state;null==n&&(n={canUndo:!1,sequenceNumber:0,bar:0,channel:0,prompt:null},window.history.replaceState(n,"","#"+this.song.toBase64String())),window.addEventListener("hashchange",this.Ra),window.addEventListener("popstate",this.Ra),this.bar=n.bar,this.channel=n.channel,this.Ca=n.bar,this.Aa=n.channel,this.barScrollPos=Math.max(0,this.bar-(this.trackVisibleBars-6)),this.prompt=n.prompt;for(const t of["input","change","click","keyup","keydown","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel"])window.addEventListener(t,this.Ea)}record(t,n=!1){t.isNoop()?(this.Ma=null,n&&window.history.back()):(this.Ma=t,n||(this.Sa=!0),this.Ba||(window.requestAnimationFrame(this.Fa),this.Ba=!0))}openPrompt(t){this.prompt=t;const n="#"+this.song.toBase64String();this.La++;const e={canUndo:!0,sequenceNumber:this.La,bar:this.bar,channel:this.channel,prompt:this.prompt};window.history.pushState(e,"",n)}undo(){window.history.state.canUndo&&window.history.back()}redo(){window.history.forward()}setProspectiveChange(t){this.Ma=t}forgetLastChange(){this.Ma=null}lastChangeWas(t){return null!=t&&t==this.Ma}savePreferences(){localStorage.setItem("autoPlay",this.autoPlay?"true":"false"),localStorage.setItem("autoFollow",this.autoFollow?"true":"false"),localStorage.setItem("showFifth",this.showFifth?"true":"false"),localStorage.setItem("showMore",this.showMore?"true":"false"),localStorage.setItem("showLetters",this.showLetters?"true":"false"),localStorage.setItem("showChannels",this.showChannels?"true":"false"),localStorage.setItem("showScrollBar",this.showScrollBar?"true":"false"),localStorage.setItem("showVolumeBar",this.showVolumeBar?"true":"false"),localStorage.setItem("advancedSettings",this.advancedSettings?"true":"false"),localStorage.setItem("volume",String(this.volume))}setVolume(t){this.volume=t,this.savePreferences(),this.synth.volume=this.Pa()}Pa(){return Math.min(1,Math.pow(this.volume/50,.5))*Math.pow(2,(this.volume-75)/25)}getCurrentPattern(){return this.song.getPattern(this.channel,this.bar)}getCurrentInstrument(){const t=this.getCurrentPattern();return null==t?0:t.instrument}}Ae.M=2,document.head.appendChild(m.style({type:"text/css"},`\nhtml {\nbackground: ${Jt.pageMargin};\n}\n\n.beepboxEditor {\n\tdisplay: flex;\n\t-webkit-touch-callout: none;\n\t-webkit-user-select: none;\n\t-khtml-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n\tposition: relative;\n\ttouch-action: manipulation;\n\tcursor: default;\n\tfont-size: small;\n\tbackground: ${Jt.editorBackground};\n}\n\n.beepboxEditor .theme-option input:checked ~ * {\n\tcolor: #fff;\n}\n\n.beepboxEditor .theme-option {\n\tcolor: #999;\n}\n\n\n.hintButton {\n\twidth: 0.5em; \n\tdisplay: flex; \n\talign-items: center;\n}\n\n.beepboxEditor div {\n\tmargin: 0;\n\tpadding: 0;\n}\n\n.beepboxEditor .promptContainer {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\t/*background: rgba(0,0,0,0.5);*/\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.beepboxEditor .prompt {\n\tmargin: auto;\n\ttext-align: center;\n\tbackground: ${Jt.editorBackground};\n\tborder-radius: 15px;\n\tborder: 4px solid #444;\n\tcolor: #fff;\n\tpadding: 20px;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .prompt > *:not(:first-child) {\n\tmargin-top: 1.5em;\n}\n\n/* Use psuedo-elements to add cross-browser up & down arrows to select elements: */\n.beepboxEditor .selectContainer {\n\tposition: relative;\n}\n.beepboxEditor .selectContainer:not(.menu)::before {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.3em;\n\ttop: 0.4em;\n\tborder-bottom: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor .selectContainer:not(.menu)::after {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.3em;\n\tbottom: 0.4em;\n\tborder-top: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor .selectContainer.menu::after {\n\tcontent: "";\n\tposition: absolute;\n\tright: 0.7em;\n\tmargin: auto;\n\ttop: 0;\n\tbottom: 0;\n\theight: 0;\n\tborder-top: 0.4em solid currentColor;\n\tborder-left: 0.3em solid transparent;\n\tborder-right: 0.3em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor select {\n\tmargin: 0;\n\tpadding: 0 0.3em;\n\tdisplay: block;\n\theight: 2em;\n\tborder: none;\n\tborder-radius: 0.4em;\n\tbackground: ${Jt.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tcursor: pointer;\n\tfont-family: inherit;\n\n\t-webkit-appearance:none;\n\t-moz-appearance: none;\n\tappearance: none;\n}\n.beepboxEditor .menu select {\n\tpadding: 0 2em;\n}\n.beepboxEditor select:focus {\n\tbackground: ${Jt.uiWidgetFocus};\n\toutline: none;\n}\n.beepboxEditor .menu select {\n\ttext-align: center;\n\ttext-align-last: center;\n}\n\n/* This makes it look better in firefox on my computer... What about others?\n@-moz-document url-prefix() {\n\t.beepboxEditor select { padding: 0 2px; }\n}\n*/\n.beepboxEditor button {\n\tmargin: 0;\n\tposition: relative;\n\theight: 2em;\n\tborder: none;\n\tborder-radius: 0.4em;\n\tbackground: ${Jt.uiWidgetBackground};\n\tcolor: inherit;\n\tfont-size: inherit;\n\tfont-family: inherit;\n\tcursor: pointer;\n}\n.beepboxEditor button:focus {\n\tbackground: ${Jt.uiWidgetFocus};\n\toutline: none;\n}\n.beepboxEditor button.playButton, .beepboxEditor button.pauseButton {\n\tpadding-left: 2em;\n}\n.beepboxEditor button.playButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 0.7em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\tborder-left: 1em solid currentColor;\n\tborder-top: 0.65em solid transparent;\n\tborder-bottom: 0.65em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor button.pauseButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 0.7em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\twidth: 0.3em;\n\theight: 1.3em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n.beepboxEditor button.pauseButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 1.4em;\n\ttop: 50%;\n\tmargin-top: -0.65em;\n\twidth: 0.3em;\n\theight: 1.3em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n\n.beepboxEditor button.prevBarButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.5em;\n\tmargin-top: -0.5em;\n\twidth: 0.2em;\n\theight: 1em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n.beepboxEditor button.prevBarButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.3em;\n\tmargin-top: -0.5em;\n\tborder-right: 0.8em solid currentColor;\n\tborder-top: 0.5em solid transparent;\n\tborder-bottom: 0.5em solid transparent;\n\tpointer-events: none;\n}\n\n.beepboxEditor button.nextBarButton::before {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: -0.5em;\n\tmargin-top: -0.5em;\n\tborder-left: 0.8em solid currentColor;\n\tborder-top: 0.5em solid transparent;\n\tborder-bottom: 0.5em solid transparent;\n\tpointer-events: none;\n}\n.beepboxEditor button.nextBarButton::after {\n\tcontent: "";\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tmargin-left: 0.3em;\n\tmargin-top: -0.5em;\n\twidth: 0.2em;\n\theight: 1em;\n\tbackground: currentColor;\n\tpointer-events: none;\n}\n\n.beepboxEditor canvas {\n\toverflow: hidden;\n\tposition: absolute;\n\tdisplay: block;\n}\n\n.beepboxEditor .trackContainer {\n\toverflow-x: hidden;\n}\n\n.beepboxEditor .selectRow {\n\tmargin: 0;\n\theight: 2.5em;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.beepboxEditor .selectRow > span {\n\tcolor: ${Jt.secondaryText};\n}\n\n.beepboxEditor .operatorRow {\n\tmargin: 0;\n\theight: 2.5em;\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: center;\n}\n\n.beepboxEditor .operatorRow > * {\n\tflex-grow: 1;\n\tflex-shrink: 1;\n}\n\n.beepboxEditor .editor-widget-column {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-widgets {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-menus {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-song-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-instrument-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.beepboxEditor .editor-right-widget-column {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-menus {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-song-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-instrument-settings {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.beepboxEditor .editor-right-side-top > *, .beepboxEditor .editor-right-side-bottom > * {\n\tflex-shrink: 0;\n}\n\n.beepboxEditor input[type=text], .beepboxEditor input[type=number] {\n\tfont-size: inherit;\n\tbackground: transparent;\n\tborder: 1px solid #777;\n\tcolor: white;\n}\n\n.beepboxEditor input[type=checkbox] {\n  transform: scale(1.5);\n}\n\n.beepboxEditor input[type=range] {\n\t-webkit-appearance: none;\n\tcolor: inherit;\n\twidth: 100%;\n\theight: 2em;\n\tfont-size: inherit;\n\tmargin: 0;\n\tcursor: pointer;\n\tbackground-color: ${Jt.editorBackground};\n\ttouch-action: pan-y;\n}\n.beepboxEditor input[type=range]:focus {\n\toutline: none;\n}\n.beepboxEditor input[type=range]::-webkit-slider-runnable-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Jt.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]::-webkit-slider-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tbackground: currentColor;\n\tcursor: pointer;\n\t-webkit-appearance: none;\n\tmargin-top: -0.75em;\n}\n.beepboxEditor input[type=range]:focus::-webkit-slider-runnable-track {\n\tbackground: ${Jt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Jt.uiWidgetBackground};\n}\n.beepboxEditor input[type=range]:focus::-moz-range-track {\n\tbackground: ${Jt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-moz-range-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tborder: none;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n.beepboxEditor input[type=range]::-ms-track {\n\twidth: 100%;\n\theight: 0.5em;\n\tcursor: pointer;\n\tbackground: ${Jt.uiWidgetBackground};\n\tborder-color: transparent;\n}\n.beepboxEditor input[type=range]:focus::-ms-track {\n\tbackground: ${Jt.uiWidgetFocus};\n}\n.beepboxEditor input[type=range]::-ms-thumb {\n\theight: 2em;\n\twidth: 0.5em;\n\tborder-radius: 0.25em;\n\tbackground: currentColor;\n\tcursor: pointer;\n}\n.beepboxEditor .hintButton {\n\tborder: 1px solid currentColor;\n\tborder-radius: 50%;\n\ttext-decoration: none;\n\theight: 1em;\n\ttext-align: center;\n\tmargin-right: .4em;\n\tcursor: pointer;\n}\n\n/* wide screen */\n@media (min-width: 501px) {\n\t#beepboxEditorContainer {\n\t\tdisplay: table;\n\t}\n\t.beepboxEditor {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: 3px solid #555;\n\t}\n\t.beepboxEditor .trackContainer {\n\t\twidth: 512px;\n\t}\n\t.beepboxEditor .trackSelectBox {\n\t\tdisplay: none;\n\t}\n\t.beepboxEditor .playback-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t\talign-items: center;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin-left: 10px;\n\t}\n\t.beepboxEditor .editor-widget-column {\n\t\tmargin-left: 6px;\n\t\twidth: 14em;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .editor-right-widget-column {\n\t\tmargin-left: 6px;\n\t\twidth: 14em;\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor .editor-widgets {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .editor-right-widgets {\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .editor-settings input, .beepboxEditor .editor-settings select {\n\t\twidth: 8.6em;\n\t}\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings select {\n\t\twidth: 8.6em;\n\t}\n\t.beepboxEditor .editor-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .editor-right-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .editor-menus > button {\n\t\tpadding: 0 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .editor-right-menus > button {\n\t\tpadding: 0 2em;\n\t\twhite-space: nowrap;\n\t}\n}\n\n/* narrow screen */\n@media (max-width: 500px) {\n\t.beepboxEditor {\n\t\tflex-direction: column;\n\t}\n\t.beepboxEditor:focus-within {\n\t\toutline: none;\n\t}\n\t.beepboxEditor .editorBox {\n\t\tmax-height: 75vh;\n\t}\n\t.beepboxEditor .editor-menus {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .editor-right-menus {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .editor-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .10em;\n\t}\n\t.beepboxEditor .editor-right-menus > * {\n\t\tflex-grow: 1;\n\t\tmargin: .2em;\n\t}\n\t.beepboxEditor .editor-menus > button {\n\t\tpadding-left: 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .editor-right-menus > button {\n\t\tpadding-left: 2em;\n\t\twhite-space: nowrap;\n\t}\n\t.beepboxEditor .trackContainer {\n\t\toverflow-x: auto;\n\t}\n\t.beepboxEditor .barScrollBar {\n\t\tdisplay: none;\n\t}\n\t.beepboxEditor .playback-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tmargin: .2em 0;\n\t}\n\t.beepboxEditor .playback-bar-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-grow: 1;\n\t}\n\t.beepboxEditor .playback-volume-controls {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\talign-items: center;\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-widget-column {\n\t\tflex-direction: column-reverse;\n\t}\n\t.beepboxEditor .editor-settings {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .editor-right-widget-column {\n\t\tflex-direction: column-reverse;\n\t}\n\t.beepboxEditor .editor-right-settings {\n\t\tflex-direction: row;\n\t}\n\t.beepboxEditor .pauseButton, .beepboxEditor .playButton,\n\t.beepboxEditor .nextBarButton, .beepboxEditor .prevBarButton {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-song-settings, .beepboxEditor .editor-instrument-settings {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-right-song-settings, .beepboxEditor .editor-right-instrument-settings {\n\t\tflex-grow: 1;\n\t\tmargin: 0 .2em;\n\t}\n\t.beepboxEditor .editor-settings input, .beepboxEditor .editor-settings .selectContainer {\n\t\twidth: 60%;\n\t}\n\t.beepboxEditor .editor-right-settings input, .beepboxEditor .editor-right-settings .selectContainer {\n\t\twidth: 60%;\n\t}\n\t.beepboxEditor .editor-settings select {\n\t\twidth: 100%;\n\t}\n\t.beepboxEditor .editor-right-settings select {\n\t\twidth: 100%;\n\t}\n\t.fullWidthOnly {\n\t\tdisplay: none;\n\t}\n\tp {\n\t\tmargin: 1em 0.5em;\n\t}\n}\n`));const Se=new Ae(location.hash),Be=new Le(Se);if(document.getElementById("beepboxEditorContainer").appendChild(Be.mainLayer),Be.whenUpdated(),Be.mainLayer.focus(),!xe&&Se.autoPlay){function Fe(){document.hidden||(Se.synth.play(),Be.updatePlayButton(),window.removeEventListener("visibilitychange",Fe))}document.hidden?window.addEventListener("visibilitychange",Fe):Fe()}return"scrollRestoration"in history&&(history.scrollRestoration="manual"),Be.updatePlayButton(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/service_worker.js",{updateViaCache:"all",scope:"/"}).catch((()=>{})),t.Channel=F,t.Config=s,t.ExportPrompt=Rn,t.Instrument=E,t.Pattern=B,t.Song=P,t.SongDocument=Ae,t.SongEditor=Le,t.Synth=I,Object.defineProperty(t,"Na",{value:!0}),t}({});
//# sourceMappingURL=beepbox_editor.min.js.map
	</script>
</body></html>
